$(function(){var a=new ReturnEntity();a.init();});function ReturnEntity(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;this.returnEntityBase=new ReturnEntityBase();
this.returnEntityComfirm=new ReturnEntityComfirm();this.returnEntityReceive=new ReturnEntityReceive();this.returnEntityRefund=new ReturnEntityRefund();
this.returnEntityRefunding=new ReturnEntityRefunding();this.returnEntityComplete=new ReturnEntityComplete();this.returnEntityReject=new ReturnEntityReject();
this.returnEntityNotReceive=new ReturnEntityNotReceive();this.returnLog=new ReturnLog();}ReturnEntity._CONS_={EDIT_URL:ctx+"/ec/ret/returnEntity/edit.htm",DETAIL_URL:ctx+"/ec/ret/returnEntity/detail.htm",DELETE_URL:ctx+"/ec/ret/returnEntity/delete.htm",SAVE_ADD_URL:ctx+"/ec/ret/returnEntity/saveAdd.htm",SAVE_EDIT_URL:ctx+"/ec/ret/returnEntity/saveEdit.htm",LIST_DATA_URL:ctx+"/ec/ret/returnEntity/listData.htm",GRID:"#returnEntityGrid",PAGER:"#returnEntityPager"};
ReturnEntity.prototype={init:function(a){if(!this.hadInit){retWidth=$(".wait_submit_wrapper").width();this.hadInit=true;this._hideNotGrantBtn();this._bindFormValidation();
this._bindEventHander();this._initInputAndOption();this.returnEntityComfirm.init();this.returnEntityReceive.init();this.returnEntityRefund.init();this.returnEntityRefunding.init();
this.returnEntityComplete.init();this.returnEntityReject.init();this.returnEntityNotReceive.init();this.returnEntityBase.countAllStatus();if("index"==fromType){this._initTabForReceive();
}}},_hideNotGrantBtn:function(){if(!ResUtils.canShow("returnEntity.button.comfirm")){$(".returnEntityComfirm").hide();}if(!ResUtils.canShow("returnEntity.button.comfirmEdit")){$(".comfirmEdit").hide();
}if(!ResUtils.canShow("returnEntity.button.comfirmDetail")){$(".comfirmDetail").hide();}if(!ResUtils.canShow("returnEntity.button.receive")){$(".returnEntityReceive").hide();
}if(!ResUtils.canShow("returnEntity.button.receiveEdit")){$(".receiveEdit").hide();}if(!ResUtils.canShow("returnEntity.button.receiveDetail")){$(".receiveDetail").hide();
}if(!ResUtils.canShow("returnEntity.button.refund")){$(".returnEntityRefund").hide();}if(!ResUtils.canShow("returnEntity.button.refundEdit")){$(".refundEdit").hide();
}if(!ResUtils.canShow("returnEntity.button.refundDetail")){$(".refundDetail").hide();}if(!ResUtils.canShow("returnEntity.button.refundingDetail")){$(".refundingDetail").hide();
}if(!ResUtils.canShow("returnEntity.button.completeDetail")){$(".completeDetail").hide();}if(!ResUtils.canShow("returnEntity.button.rejectDetail")){$(".rejectDetail").hide();
}if(!ResUtils.canShow("returnEntity.button.notReceiveDetail")){$(".notReceiveDetail").hide();}},_bindEventHander:function(){var a=this;$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).on("change","input",function(){if(a.isEdit){a.isFormDataChange=true;
}});$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).on("change","select",function(){if(a.isEdit){a.isFormDataChange=true;}});$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).on("change","textarea",function(){if(a.isEdit){a.isFormDataChange=true;
}});$("#prevBtn").on("click",function(){a.initForm(true);});$("#save").on("click",function(){a.returnEntityBase._save("",function(){a.initForm(false);});
});$("#comfirm").on("click",function(){var b=$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[name=needReturn]").val();if(b=="N"){DialogUtils.error(msgCode.FAIL_MSG,"请确认等待退货跟是否需要回寄一致");
return;}a.returnEntityBase._save("comfirm",function(){a.initForm(false);});});$("#comfirm_direct").on("click",function(){var b=$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[name=needReturn]").val();
if(b=="Y"){DialogUtils.error(msgCode.FAIL_MSG,"请确认无需退货跟是否需要回寄一致");return;}a.returnEntityBase._save("comfirm_direct",function(){a.initForm(false);});});
$("#reject").on("click",function(){a.returnEntityBase._save("reject",function(){a.initForm(false);});});$("#receive").on("click",function(){a.returnEntityBase._save("receive",function(){a.initForm(false);
});});$("#not_receive").on("click",function(){a.returnEntityBase._save("not_receive",function(){a.initForm(false);});});$("#refund").on("click",function(){FormUtils.enableForm("refundAddForm");
$("#refundAddForm").find("[id=billStatusDiv]").hide();a.returnEntityBase.openEditDialog(true,function(){a.returnEntityBase._save("refund",function(){a.initForm(false);
},ReturnEntityRefund._CONS_.SAVE_ADD_URL);});});$("#viewBill").on("click",function(){FormUtils.disableForm("refundAddForm");$("#refundAddForm").find("[id=billStatusDiv]").show();
a.returnEntityBase.openEditDialog(false,null);});$("body").on("click",".returnEntityComfirm",function(){a.isEdit=true;var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityComfirm._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);
return;}}b=b[0];}a._initComfirmBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);});$("body").on("click",".comfirmEdit",function(){a.isEdit=true;var b=$(this).attr("idVal");
if(!b){b=$(ReturnEntityComfirm._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);
return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);return;}}b=b[0];}a._initEditBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);
});$("body").on("click",".comfirmDetail",function(){a.isEdit=true;var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityComfirm._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);
return;}}b=b[0];}a._initDetailBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);});$("body").on("click",".returnEntityReceive",function(){a.isEdit=true;
var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityReceive._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);
return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);return;}}b=b[0];}a._initReceiveBtn();a.returnLog.init(b);
a.returnEntityBase._edit(b);});$("body").on("click",".receiveEdit",function(){a.isEdit=true;var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityReceive._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);
return;}}b=b[0];}a._initEditBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);});$("body").on("click",".receiveDetail",function(){a.isEdit=true;var b=$(this).attr("idVal");
if(!b){b=$(ReturnEntityReceive._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);
return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);return;}}b=b[0];}a._initDetailBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);
});$("body").on("click",".returnEntityRefund",function(){a.isEdit=true;var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityRefund._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);
return;}}b=b[0];}a._initRefundBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);});$("body").on("click",".refundEdit",function(){a.isEdit=true;var b=$(this).attr("idVal");
if(!b){b=$(ReturnEntityRefund._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);
return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);return;}}b=b[0];}a._initEditBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);
});$("body").on("click",".refundDetail",function(){a.isEdit=true;var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityRefund._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);
return;}}b=b[0];}a._initDetailBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);});$("body").on("click",".refundingDetail",function(){a.isEdit=true;
var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityRefunding._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);
return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);return;}}b=b[0];}a._initDetailBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);
});$("body").on("click",".completeDetail",function(){a.isEdit=true;var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityComplete._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);
return;}}b=b[0];}a._initDetailBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);});$("body").on("click",".rejectDetail",function(){a.isEdit=true;var b=$(this).attr("idVal");
if(!b){b=$(ReturnEntityReject._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);
return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);return;}}b=b[0];}a._initDetailBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);
});$("body").on("click",".notReceiveDetail",function(){a.isEdit=true;var b=$(this).attr("idVal");if(!b){b=$(ReturnEntityNotReceive._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);
return;}}b=b[0];}a._initDetailBtn();a.returnLog.init(b);a.returnEntityBase._edit(b);});$(".list_wrapper").on("click",".listTabli",function(){var c=$(this).attr("attr-type");
var b=a._getActiveTab();if(c==b){return;}if("comfirm"==c){a.returnEntityComfirm.init();}if("receive"==c){a.returnEntityReceive.init();}if("refund"==c){a.returnEntityRefund.init();
}if("refunding"==c){a.returnEntityRefunding.init();}if("complete"==c){a.returnEntityComplete.init();}if("reject"==c){a.returnEntityReject.init();}if("notReceive"==c){a.returnEntityNotReceive.init();
}});$(document).on("click",".returnEntitySearch",function(){var c=$(this).closest("form").serialize();var b=a._getActiveTab();a.reloadJqgrid(b,c);});$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[name=needReturn]").on("click",function(){if($(this).val()=="N"){a.returnEntityBase.hideReturnInfo();
}else{a.returnEntityBase.showReturnInfo();}});},_bindFormValidation:function(){var a={rules:{skuCount:{required:true,number:true,min:1},shipAmount:{number:true,min:0},trackingNo:{maxlength:["128"]},reasonName:{required:true,maxlength:["1024"]},returnAddr:{maxlength:["512"]},comment:{maxlength:["1024"]}},messages:{}};
FormUtils.bindFormValidation(ReturnEntityBase._CONS_.APPLY_FORM_ID,a);},_getActiveTab:function(){var b=this;var a=$(".listTabli");var c="";$.each(a,function(d,e){if($(this).hasClass("active")){c=$(this).attr("attr-type");
}});return c;},_initComfirmBtn:function(){$("#saveDiv").hide();$("#comfirmDiv").show();$("#receiveDiv").hide();$("#refundDiv").hide();$("#viewBillDiv").hide();
ButtonUtils.enableBtn("comfirm");ButtonUtils.enableBtn("comfirm_direct");ButtonUtils.enableBtn("reject");ButtonUtils.enableBtn("prevBtn");$("#commentDiv").show();
},_initReceiveBtn:function(){$("#saveDiv").hide();$("#comfirmDiv").hide();$("#receiveDiv").show();$("#refundDiv").hide();$("#viewBillDiv").hide();ButtonUtils.enableBtn("receive");
ButtonUtils.enableBtn("not_receive");ButtonUtils.enableBtn("prevBtn");$("#commentDiv").show();},_initRefundBtn:function(){$("#saveDiv").hide();$("#comfirmDiv").hide();
$("#receiveDiv").hide();$("#refundDiv").show();$("#viewBillDiv").hide();$("#refundAddForm").find("[id=pointTip]").show();ButtonUtils.enableBtn("refund");
ButtonUtils.enableBtn("prevBtn");$("#commentDiv").show();},_initEditBtn:function(){$("#saveDiv").show();$("#comfirmDiv").hide();$("#receiveDiv").hide();
$("#refundDiv").hide();$("#viewBillDiv").hide();ButtonUtils.enableBtn("save");ButtonUtils.enableBtn("prevBtn");$("#commentDiv").show();},_initDetailBtn:function(){$("#saveDiv").hide();
$("#comfirmDiv").hide();$("#receiveDiv").hide();$("#refundDiv").hide();$("#commentDiv").hide();ButtonUtils.enableBtn("prevBtn");FormUtils.disableForm(ReturnEntityBase._CONS_.APPLY_FORM_ID);
$(".selectImageBtn").hide();},initForm:function(b){var a=this;if(!b){$(".returnEntitySearch").trigger("click");a.returnEntityBase.countAllStatus();}a.returnEntityBase.isFormDataChange=a.isFormDataChange;
a.returnEntityBase.clear(b);a.isFormDataChange=false;},reloadJqgrid:function(b,c){var a=this;if("comfirm"==b){a.returnEntityComfirm.init(c);}if("receive"==b){a.returnEntityReceive.init(c);
}if("refund"==b){a.returnEntityRefund.init(c);}if("refunding"==b){a.returnEntityRefunding.init(c);}if("complete"==b){a.returnEntityComplete.init(c);}if("reject"==b){a.returnEntityReject.init(c);
}if("notReceive"==b){a.returnEntityNotReceive.init(c);}},_initTabForReceive:function(){$("#comfirmTabLi").removeClass("active");$("#comfirmTab").removeClass("active");
$("#receiveTabLi").trigger("click").addClass("active");$("#receiveTab").addClass("active");},_initInputAndOption:function(){CateUtils.getOptions({typeKey:"system",pKey:"shipCode",container:"shipCompany"});
}};function ReturnEntityBase(){this.hadInit=false;this.isFormDataChange=false;this.soItemList=new SoItemList();}ReturnEntityBase._CONS_={EDIT_URL:ctx+"/ec/ret/returnEntity/edit.htm",DETAIL_URL:ctx+"/ec/ret/returnEntity/detail.htm",DELETE_URL:ctx+"/ec/ret/returnEntity/delete.htm",SAVE_ADD_URL:ctx+"/ec/ret/returnEntity/saveAdd.htm",SAVE_EDIT_URL:ctx+"/ec/ret/returnEntity/saveEdit.htm",LIST_DATA_URL:ctx+"/ec/ret/returnEntity/listData.htm",COUNT_STATUS_URL:ctx+"/ec/ret/returnEntity/countAllStatus.htm",CS_EDIT_URL:ctx+"/crm/cs/csEntity/edit.htm",APPLY_FORM_ID:"returnApplyForm",COMFIRM_TAB_TYPE:"comfirm",RECEIVE_TAB_TYPE:"receive",REFUND_TAB_TYPE:"refund",REFUNDING_TAB_TYPE:"refunding",COMPLETE_TAB_TYPE:"complete",REJECT_TAB_TYPE:"reject",NOT_RECEIVE_TAB_TYPE:"notReceive",SHIP_INFO_QRY_URL:ctx+"/ec/ret/returnEntity/renewShipInfo.htm",SO_DETAIL_URL:ctx+"/ec/salesorder/soEntity/detail.htm",RETURN_DETAIL_PAGE_URL:ctx+"/ec/ret/returnEntity/detail.htm",FIND_BY_RNO_URL:ctx+"/ec/ret/returnEntity/findCsByRno.htm",};
ReturnEntityBase.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindEventHander();}this.listDataUrl=ReturnEntityBase._CONS_.LIST_DATA_URL;
if(a!=null&&typeof a!=undefined){if(a.listParams!=undefined){this.listDataUrl=this.listDataUrl+"?"+a.listParams;}if(a.grid!=undefined){this.grid=a.grid;
}if(a.pager!=undefined){this.pager=a.pager;}if(a.getManagerBtns!=undefined){this.getManagerBtns=a.getManagerBtns;}if(a.widthElement!=undefined){this.widthElement=a.widthElement;
}if(a.gridRecordsSpan!=undefined){this.gridRecordsSpan=a.gridRecordsSpan;}if(a.type!=undefined){this.type=a.type;}if(a.onSelectRow!=undefined){this.onSelectRow=a.onSelectRow;
}}this._initJqgrid(null);},loadData:function(c,b){var a=this;FormUtils.loadData(ReturnEntityBase._CONS_.EDIT_URL+"?id="+c+"&canShowScTrankNo="+(ResUtils.canShow("returnEntity.button.showScTrackNo")?"can":"canot"),function(e){var d=$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID);
var f=$("#refundAddForm");$(".editInfoDiv").show();d.find("[name=rno]").val(e.rno);d.find("[name=id]").val(e.id);d.find("[name=skuCount]").val(e.skuCount);
d.find("[name=returnAddr]").val(e.returnAddr);d.find("[name=trackingNo]").val(e.trackingNo);d.find("[name=scId]").val(e.scId);d.find("[name=shipAmount]").val(e.shipAmount);
d.find("[name=reasonName]").val(e.reasonName);d.find("[name=csName]").val(e.soInfoVo.csName);d.find("[name=statusName]").val(e.statusName);d.find("[name=needReturn]").val(e.needReturn);
f.find("[id=canReturnMaxAmount]").val(e.soInfoVo.soItemVos[0].sum);a.initCsAccount(e.csId);if(e.deductPoint){if(e.diffMoney&&parseInt(e.diffMoney)>0){f.find("[id=pointTip]").text("（退货将扣除消费赠送的积分:"+e.deductPoint+"，由于部分积分已兑换，需要扣除对应金额，金额为:"+e.diffMoney+"元）");
}else{f.find("[id=pointTip]").text("（退货将扣除消费赠送的积分:"+e.deductPoint+"）");}}if(e.financeBillPo){f.find("[name=payType]").val(e.financeBillPo.payType);f.find("[name=amount]").val(e.financeBillPo.total);
f.find("[name=receiptAccount]").val(e.financeBillPo.receiptAccount);f.find("[name=status]").val(e.financeBillPo.statusName);$("#viewBillDiv").show();}if(e.needReturn=="N"){if("awaiting"==e.status){a.hideReturnInfo(false);
}else{a.hideReturnInfo(true);}}else{if("awaiting"==e.status){a.showReturnInfo(false);}else{a.showReturnInfo(true);}}if("comfirm"==e.status){$(".shipQryBtn").show();
}else{$(".shipQryBtn").hide();}a._showImages(e.returnImgPos);a.soItemList.init({data:e.soInfoVo.soItemVos,type:SoItemList._CONS_.ONE_TYPE});if(b&&typeof(b)=="function"){b(e);
}a._fillShipInfo(e);});},_bindEventHander:function(){var a=this;$(document).on("click",".selectImageBtn",function(){ImageUtils.selectImage(1,function(c){if($("#imgContainer").find("ul").length==0){var d=new StringBuffer();
d.append("<ul class='dragsort'>");for(var b=0;b<c.length;b++){d.append("<li>");d.append(ImageUtils.createImageDivStr([c[b]],true));d.append("</li>");}d.append("</ul>");
$("#imgContainer").append(d.toString());$("#imgContainer").find("ul.dragsort").dragsort({dragSelector:"div",dragBetween:true,dragEnd:function(){},placeHolderTemplate:"<li class='placeHolder'><div></div></li>"});
}else{var d=new StringBuffer();for(var b=0;b<c.length;b++){d.append("<li>");d.append(ImageUtils.createImageDivStr([c[b]],true));d.append("</li>");}$("#imgContainer ul").append(d.toString());
}});a.isFormDataChange=true;});$(document).on("click",".shipQryBtn",function(){ButtonUtils.disableBtn("shipQryBtn");var b=$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[name=id]").val();
FormUtils.submit(ReturnEntityBase._CONS_.SHIP_INFO_QRY_URL,"id="+b,function(c){ButtonUtils.enableBtn("shipQryBtn");if(c.success){DialogUtils.success(msgCode.INFO,"查询成功");
var d=$("#shipInfoForm");d.find("[name=apiStatus]").val(ShipInfoUtil.getShipStatusName(c.returnEntityPo.apiStatus));d.find("[name=apiRevokeTime]").val(c.returnEntityPo.apiRevokeTime);
d.find(".shippingDataDiv").empty().append(c.returnEntityPo.apiReturnData);}else{DialogUtils.error(msgCode.FAIL_MSG,c.msg);}},function(){ButtonUtils.enableBtn("shipQryBtn");
DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});});$(document).on("click",".soTab",function(){var c=$(this).attr("csIdVal");var b=$(this).attr("value");
FormUtils.submit(ReturnEntityBase._CONS_.CS_EDIT_URL,"id="+c,function(d){JTTabUtils.addOrRefreshTab(ReturnEntityBase._CONS_.SO_DETAIL_URL+"?soNo="+b,d.name+"的订单明细");
});});$("body").on("click",".returnTab",function(){var c=$(this).attr("value");var b=ReturnEntityBase._CONS_.FIND_BY_RNO_URL;FormUtils.loadData(b+"?rNo="+c,function(d){JTTabUtils.addOrRefreshTab(ReturnEntityBase._CONS_.RETURN_DETAIL_PAGE_URL+"?rno="+c,d.name+"的退货单明细");
});});},_getManagerBtns:function(c){var b=this;var a=[];var c=b.type;if(c==ReturnEntityBase._CONS_.COMFIRM_TAB_TYPE&&ResUtils.canShow("returnEntity.button.comfirm")){a.push({lable:"去审核",btnClasses:"btn btn-primary returnEntityComfirm",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.COMFIRM_TAB_TYPE&&ResUtils.canShow("returnEntity.button.comfirmEdit")){a.push({lable:"修 改",btnClasses:"btn btn-primary comfirmEdit",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.COMFIRM_TAB_TYPE&&ResUtils.canShow("returnEntity.button.comfirmDetail")){a.push({lable:"明 细",btnClasses:"btn btn-primary comfirmDetail",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.RECEIVE_TAB_TYPE&&ResUtils.canShow("returnEntity.button.receive")){a.push({lable:"去确认收货",btnClasses:"btn btn-primary returnEntityReceive",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.RECEIVE_TAB_TYPE&&ResUtils.canShow("returnEntity.button.receiveEdit")){a.push({lable:"修 改",btnClasses:"btn btn-primary receiveEdit",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.RECEIVE_TAB_TYPE&&ResUtils.canShow("returnEntity.button.receiveDetail")){a.push({lable:"明 细",btnClasses:"btn btn-primary receiveDetail",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.REFUND_TAB_TYPE&&ResUtils.canShow("returnEntity.button.refund")){a.push({lable:"退 款",btnClasses:"btn btn-primary returnEntityRefund",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.REFUND_TAB_TYPE&&ResUtils.canShow("returnEntity.button.refundEdit")){a.push({lable:"修 改",btnClasses:"btn btn-primary refundEdit",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.REFUND_TAB_TYPE&&ResUtils.canShow("returnEntity.button.refundDetail")){a.push({lable:"明 细",btnClasses:"btn btn-primary refundDetail",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.REFUNDING_TAB_TYPE&&ResUtils.canShow("returnEntity.button.refundingDetail")){a.push({lable:"明 细",btnClasses:"btn btn-primary refundingDetail",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.COMPLETE_TAB_TYPE&&ResUtils.canShow("returnEntity.button.completeDetail")){a.push({lable:"明 细",btnClasses:"btn btn-primary completeDetail",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.REJECT_TAB_TYPE&&ResUtils.canShow("returnEntity.button.rejectDetail")){a.push({lable:"明 细",btnClasses:"btn btn-primary rejectDetail",iconClasses:"fa fa-edit"});
}if(c==ReturnEntityBase._CONS_.NOT_RECEIVE_TAB_TYPE&&ResUtils.canShow("returnEntity.button.notReceiveDetail")){a.push({lable:"明 细",btnClasses:"btn btn-primary notReceiveDetail",iconClasses:"fa fa-edit"});
}if(a.length>0){return a;}else{return"";}},_initJqgrid:function(b){var a=this;if(b==null||typeof b==undefined){b={};}$(a.grid).JTJqgrid({url:a.listDataUrl,pager:a.pager,postData:b,multiselectWidth:20,colNames:["退货单号","订单号","商品名称","数量","是否回寄","申请时间","状态","操作"],colModel:[{name:"rno",index:"rno_",width:100,formatter:function(c,d,e){if(e.rno!=null&&e.rno!=""){return"<a href='#' class='returnTab' value='"+e.rno+"' >"+e.rno+"</a>";
}return e.rno;}},{name:"soNo",index:"so_no_",width:100,formatter:function(c,d,e){return"<a class='soTab' csIdVal='"+e.csId+"' value='"+e.soNo+"'>"+e.soNo+"</a>";
}},{name:"skuName",index:"sku_name_",width:140,formatter:function(d){var c=new StringBuffer();c.append("<div style='width:auto;overflow:hidden; white-space:nowrap; text-overflow:ellipsis'>");
c.append(d);c.append("</div>");return c.toString();}},{name:"skuCount",index:"sku_count_",width:100},{name:"needReturn",index:"need_return_",width:100,formatter:function(c,e,f){var d=f.needReturn;
if(f.needReturn=="Y"){d="<span>需要</span>";}else{if(f.needReturn=="N"){d="<span>不需要</span>";}}return d;}},{name:"createTime",index:"create_time_",width:100,formatter:function(c){return DateUtils.miniTime(c);
}},{name:"status",index:"status_",width:120,formatter:function(c,e,f){var d=f.status;if(f.status=="awaiting"){d="<span>待审核</span>";}else{if(f.status=="reject"){d="<span>审核不通过</span>";
}else{if(f.status=="comfirm"){d="<span>已审核(等待退货)</span>";}else{if(f.status=="comfirm_direct"){d="<span>已审核(无需退货)</span>";}else{if(f.status=="receive"){d="<span>已收货</span>";
}else{if(f.status=="not_receive"){d="<span>未收到货</span>";}else{if(f.status=="refund"){d="<span>退款中</span>";}else{if(f.status=="complete"){d="<span>已完成</span>";
}}}}}}}}return d;}},{name:"__manage",width:60,classes:"rowOps",sortable:false,align:"center",formatter:"manage",formatoptions:a._getManagerBtns(a.type)}],loadComplete:function(){a._disableBtn();
if(a.gridRecordsSpan!=null){$(a.gridRecordsSpan).empty().append($(a.grid).jqGrid("getGridParam","records"));}},onSelectRow:function(d,c){if(a.onSelectRow&&typeof(a.onSelectRow)=="function"){a.onSelectRow(d,c);
}}});},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(a.grid,a.searchParam);},_edit:function(a){this._showFormWrapper();this.edit=true;this.loadData(a);
},_save:function(b,f,e){var d=this;var c=$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID);if("Y"==c.find("[name=needReturn]").val()){c.find("[name=scId]").rules("add",{required:true});
c.find("[name=trackingNo]").rules("add",{required:true});}else{c.find("[name=scId]").rules("remove");c.find("[name=trackingNo]").rules("remove");}if(c.valid()){var a=ReturnEntity._CONS_.SAVE_EDIT_URL;
if(e){a=e;}var g=new StringBuffer();g.append("id="+c.find("[name=id]").val());g.append("&reasonName="+c.find("[name=reasonName]").val());g.append("&needReturn="+c.find("[name=needReturn]").val());
g.append("&returnAddr="+c.find("[name=returnAddr]").val());g.append("&scId="+c.find("[name=scId]").val());g.append("&trackingNo="+c.find("[name=trackingNo]").val());
g.append("&shipAmount="+(c.find("[name=shipAmount]").val()<0?0:c.find("[name=shipAmount]").val()));g.append("&comment="+c.find("[name=comment]").val());
g.append("&imgUrls="+d._getImgUrl());g.append("&status="+b);if(b=="refund"){g.append("&payType="+$("#refundAddForm").find("[name=payType]").val());g.append("&amount="+$("#refundAddForm").find("[name=amount]").val());
g.append("&receiptAccount="+$("#refundAddForm").find("[name=receiptAccount]").val());g.append("&pointTip="+$("#refundAddForm").find("[id=pointTip]").text());
}d._disableBtn();FormUtils.submit(a,g.toString(),function(h){d._enableGrantBtn();if(h.success){if(h.msgCode==actionCode.CREATE){DialogUtils.success(msgCode.INFO,msgCode.CREATE_MSG);
}else{if(h.msgCode==actionCode.UPDATE){DialogUtils.success(msgCode.INFO,msgCode.UPDATE_MSG);}}d.clear(false);f(true);}else{DialogUtils.error(msgCode.FAIL_MSG,h.msg);
}},function(){d._enableGrantBtn();DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}},_detail:function(a){this._showFormWrapper();this.loadData(a);
$(".form_wrapper .saveBtn").hide();FormUtils.disableForm(ReturnEntityBase._CONS_.APPLY_FORM_ID);},_showListWrapper:function(){$(".list_wrapper").show();
$(".form_wrapper").hide();},_showFormWrapper:function(){$(".list_wrapper").hide();$(".form_wrapper").show();},_showImages:function(a){var c=new StringBuffer();
c.append("<ul class='dragsort'>");for(var b=0;b<a.length;b++){c.append("<li>");c.append(ImageUtils.createImageDivStr([a[b]],true));c.append("</li>");}c.append("</ul>");
$("#imgContainer").empty().append(c.toString());$("#imgContainer").find("ul.dragsort").dragsort({dragSelector:"div",dragBetween:true,dragEnd:function(){},placeHolderTemplate:"<li class='placeHolder'><div></div></li>"});
$(".deleteImage").remove();},_getImgUrl:function(){var b=new Array();var a=$("#imgContainer").find("ul.dragsort");if(a.length>0){a.find("li").each(function(){var c=$(this).find("div.file-box div.file");
b.push(c.attr("urlVal"));});}return b.join(",");},_disableBtn:function(){ButtonUtils.disableBtn("comfirmEdit");ButtonUtils.disableBtn("receiveEdit");ButtonUtils.disableBtn("receiveDetail");
ButtonUtils.disableBtn("returnEntityComfirm");ButtonUtils.disableBtn("returnEntityReceive");ButtonUtils.disableBtn("comfirmDetail");ButtonUtils.disableBtn("receiveDetail");
ButtonUtils.disableBtn("refundDetail");ButtonUtils.disableBtn("comfirm");ButtonUtils.disableBtn("comfirm_direct");ButtonUtils.disableBtn("reject");ButtonUtils.disableBtn("receive");
ButtonUtils.disableBtn("not_receive");ButtonUtils.disableBtn("prevBtn");ButtonUtils.disableBtn("returnEntityRefund");ButtonUtils.disableBtn("refundEdit");
ButtonUtils.disableBtn("refundingDetail");ButtonUtils.disableBtn("completeDetail");ButtonUtils.disableBtn("rejectDetail");ButtonUtils.disableBtn("notReceiveDetail");
},_enableGrantBtn:function(){ButtonUtils.enableBtn("comfirm");ButtonUtils.enableBtn("comfirm_direct");ButtonUtils.enableBtn("reject");ButtonUtils.enableBtn("receive");
ButtonUtils.enableBtn("not_receive");ButtonUtils.enableBtn("prevBtn");},clear:function(c){var a=this;function b(){a._showListWrapper();a.isFormDataChange=false;
a._initTabShow();FormUtils.clear(ReturnEntityBase._CONS_.APPLY_FORM_ID);FormUtils.enableForm(ReturnEntityBase._CONS_.APPLY_FORM_ID);$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[name=csName]").attr("disabled",true);
$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[name=skuCount]").attr("disabled",true);$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[name=statusName]").attr("disabled",true);
a.initRefundAddForm();$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[id=imgDiv]").show();$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID).find("[id=imgContainer]").show();
$("#refundAddForm").find("[id=pointTip]").hide();}if(c&&a.isFormDataChange){DialogUtils.warning(function(){b();});}else{b();}},countAllStatus:function(){FormUtils.loadData(ReturnEntityBase._CONS_.COUNT_STATUS_URL,function(a){if(a){$("#returnEntityComfirmGrid_record").text(a[0]);
$("#returnEntityReceiveGrid_record").text(a[1]);$("#returnEntityRefundGrid_record").text(a[2]);$("#returnEntityRefundingGrid_record").text(a[3]);$("#returnEntityCompleteGrid_record").text(a[4]);
$("#returnEntityRejectGrid_record").text(a[5]);$("#returnEntityNotReceiveGrid_record").text(a[6]);}});},openEditDialog:function(c,b){var a=this;a.layerIndex=layer.open({type:1,title:"退款单据",maxmin:false,shadeClose:false,scrollbar:false,btn:["确定","关闭"],area:["600px","350px"],content:$("#refundPage"),success:function(d,e){},yes:function(e,d){if(c){var f=$("#refundAddForm").find("[name=amount]").val();
var g=$("#refundAddForm").find("[name=receiptAccount]").val();if(!(f&&f>0)){DialogUtils.error(msgCode.FAIL_MSG,"请填写有效的退款金额");return;}if(!g){DialogUtils.error(msgCode.FAIL_MSG,"请填写收款账号");
return;}b();layer.close(a.layerIndex);}else{layer.close(a.layerIndex);}}});},showReturnInfo:function(a){$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .returnInfoDiv").show();
$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .needReturnDiv").show();$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .shipAmountDiv").show();$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .scDiv").show();
$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .trackingNoDiv").show();$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .returnAddrDiv").show();if(a){$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .needReturnDiv").hide();
}},hideReturnInfo:function(a){$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .shipAmountDiv").hide().find("input[name=shipAmount]").val(0);$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .scDiv").hide().find("[name=scId]").val("");
$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .trackingNoDiv").hide().find("input[name=trackingNo]").val("");$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .returnAddrDiv").hide().find("input[name=returnAddr]").val("");
if(a){$("#"+ReturnEntityBase._CONS_.APPLY_FORM_ID+" .returnInfoDiv").hide();}},initRefundAddForm:function(){$("#refundAddForm").find("[name=payType]").val("alipay");
$("#refundAddForm").find("[name=amount]").val(0);$("#refundAddForm").find("[name=receiptAccount]").val("");},initCsAccount:function(b){$("#receiptAccount").bsSuggest("destroy");
var a=$("#receiptAccount").bsSuggest({getDataMethod:"url",url:ctx+"/crm/cs/csEntity/findAccount.htm?csId="+b+"&account=",inputWarnColor:null,autoSelect:false,idField:"accountType",keyField:"account",effectiveFields:["typeName","account"],effectiveFieldsAlias:{typeName:"结算方式",account:"账户"},processData:function(f){var e,c,g={value:[]};
if(!f||f.length===0){return false;}c=f.length;for(e=0;e<c;e++){var d="";if("alipay"==f[e].accountType){d="支付宝";}else{if("weixin"==f[e].accountType){d="微信";
}else{if("bank"==f[e].accountType){d="银行转账";}}}g.value.push({id:f[e].id,typeName:d,account:f[e].account,accountType:f[e].accountType});}return g;}}).on("onSetSelectValue",function(d,c){$("[name=payType]").val(c.id);
});$("#receiptAccount").bsSuggest("enable");},_fillShipInfo:function(a){if(a.scName&&a.trackingNo){$("#shipTabLi").show();var b=$("#shipInfoForm");b.find("[name=scName]").val(a.scName);
b.find("[name=trackingNo]").val(a.trackingNo);b.find("[name=apiStatus]").val(ShipInfoUtil.getShipStatusName(a.apiStatus));b.find("[name=apiRevokeTime]").val(a.apiRevokeTime);
b.find(".shippingDataDiv").empty().append(a.apiReturnData);}else{$("#shipTabLi").hide();}},_initTabShow:function(){$(".returnDetailDiv .tabli").removeClass("active");
$(".returnDetailDiv .tabli").eq(0).addClass("active");$(".returnDetailDiv .tab-pane").removeClass("active");$(".returnDetailDiv .tab-pane").eq(0).addClass("active");
},};function ReturnEntityComfirm(){this.hadInit=false;this.isEdit=false;this.returnEntityBase=new ReturnEntityBase();this.returnEntityBase.hadInit=false;
}ReturnEntityComfirm._CONS_={GRID:"#returnEntityComfirmGrid",PAGER:"#returnEntityComfirmPager"};ReturnEntityComfirm.prototype={init:function(b){var a={grid:ReturnEntityComfirm._CONS_.GRID,pager:ReturnEntityComfirm._CONS_.PAGER,gridRecordsSpan:"#returnEntityComfirmGrid_record",listParams:"Q__S__EQ__entity.status_=awaiting",widthElement:".wait_submit_wrapper",onSelectRow:this.onSelectRow,type:ReturnEntityBase._CONS_.COMFIRM_TAB_TYPE};
if(!this.hadInit){this.hadInit=true;this._bindEventHander();this.returnEntityBase.init(a);}else{this.reloadJqgrid(b);}},_bindEventHander:function(){var a=this;
},reloadJqgrid:function(b){var a={grid:ReturnEntityComfirm._CONS_.GRID,pager:ReturnEntityComfirm._CONS_.PAGER,searchParam:b};this.returnEntityBase.reloadJqgrid(a);
},onSelectRow:function(b,a){selectedId=$(ReturnEntityComfirm._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(selectedId.length==1){if(ResUtils.canShow("returnEntity.button.comfirm")){ButtonUtils.enableBtn("returnEntityComfirm");
}if(ResUtils.canShow("returnEntity.button.comfirmEdit")){ButtonUtils.enableBtn("comfirmEdit");}if(ResUtils.canShow("returnEntity.button.comfirmDetail")){ButtonUtils.enableBtn("comfirmDetail");
}}else{ButtonUtils.disableBtn("comfirmEdit");ButtonUtils.disableBtn("returnEntityComfirm");ButtonUtils.disableBtn("comfirmDetail");}}};function ReturnEntityReceive(){this.hadInit=false;
this.isEdit=false;this.returnEntityBase=new ReturnEntityBase();this.returnEntityBase.hadInit=true;}ReturnEntityReceive._CONS_={GRID:"#returnEntityReceiveGrid",PAGER:"#returnEntityReceivePager"};
ReturnEntityReceive.prototype={init:function(b){var a={grid:ReturnEntityReceive._CONS_.GRID,pager:ReturnEntityReceive._CONS_.PAGER,gridRecordsSpan:"#returnEntityReceiveGrid_record",listParams:"Q__S__EQ__entity.status_=comfirm",widthElement:".wait_submit_wrapper",onSelectRow:this.onSelectRow,type:ReturnEntityBase._CONS_.RECEIVE_TAB_TYPE};
if(!this.hadInit){this.hadInit=true;this._bindEventHander();this.returnEntityBase.init(a);}else{this.reloadJqgrid(b);}},_bindEventHander:function(){var a=this;
},reloadJqgrid:function(b){var a={grid:ReturnEntityReceive._CONS_.GRID,pager:ReturnEntityReceive._CONS_.PAGER,searchParam:b};this.returnEntityBase.reloadJqgrid(a);
},onSelectRow:function(b,a){selectedId=$(ReturnEntityReceive._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(selectedId.length==1){if(ResUtils.canShow("returnEntity.button.receive")){ButtonUtils.enableBtn("returnEntityReceive");
}if(ResUtils.canShow("returnEntity.button.receiveEdit")){ButtonUtils.enableBtn("receiveEdit");}if(ResUtils.canShow("returnEntity.button.receiveDetail")){ButtonUtils.enableBtn("receiveDetail");
}}else{ButtonUtils.disableBtn("receiveEdit");ButtonUtils.disableBtn("returnEntityReceive");ButtonUtils.disableBtn("receiveDetail");}}};function ReturnEntityRefund(){this.hadInit=false;
this.isEdit=false;this.returnEntityBase=new ReturnEntityBase();this.returnEntityBase.hadInit=true;}ReturnEntityRefund._CONS_={SAVE_ADD_URL:ctx+"/ec/ret/returnEntity/refundSaveAdd.htm",GRID:"#returnEntityRefundGrid",PAGER:"#returnEntityRefundPager",FORM:"refundAddForm"};
ReturnEntityRefund.prototype={init:function(b){var a={grid:ReturnEntityRefund._CONS_.GRID,pager:ReturnEntityRefund._CONS_.PAGER,gridRecordsSpan:"#returnEntityRefundGrid_record",listParams:"Q__S__IN__entity.status_=comfirm_direct,receive",widthElement:".wait_submit_wrapper",onSelectRow:this.onSelectRow,type:ReturnEntityBase._CONS_.REFUND_TAB_TYPE};
if(!this.hadInit){this.hadInit=true;this._bindEventHander();this.returnEntityBase.init(a);}else{this.reloadJqgrid(b);}},_bindEventHander:function(){var a=this;
},reloadJqgrid:function(b){var a={grid:ReturnEntityRefund._CONS_.GRID,pager:ReturnEntityRefund._CONS_.PAGER,searchParam:b};this.returnEntityBase.reloadJqgrid(a);
},onSelectRow:function(b,a){selectedId=$(ReturnEntityRefund._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(selectedId.length==1){if(ResUtils.canShow("returnEntity.button.refund")){ButtonUtils.enableBtn("returnEntityRefund");
}if(ResUtils.canShow("returnEntity.button.refundEdit")){ButtonUtils.enableBtn("refundEdit");}if(ResUtils.canShow("returnEntity.button.refundDetail")){ButtonUtils.enableBtn("refundDetail");
}}else{ButtonUtils.disableBtn("refundEdit");ButtonUtils.disableBtn("returnEntityRefund");ButtonUtils.disableBtn("refundDetail");}}};function ReturnEntityRefunding(){this.hadInit=false;
this.isEdit=false;this.returnEntityBase=new ReturnEntityBase();this.returnEntityBase.hadInit=true;}ReturnEntityRefunding._CONS_={GRID:"#returnEntityRefundingGrid",PAGER:"#returnEntityRefundingPager"};
ReturnEntityRefunding.prototype={init:function(b){var a={grid:ReturnEntityRefunding._CONS_.GRID,pager:ReturnEntityRefunding._CONS_.PAGER,gridRecordsSpan:"#returnEntityRefundingGrid_record",listParams:"Q__S__EQ__entity.status_=refund",widthElement:".wait_submit_wrapper",onSelectRow:this.onSelectRow,type:ReturnEntityBase._CONS_.REFUNDING_TAB_TYPE};
if(!this.hadInit){this.hadInit=true;this._bindEventHander();this.returnEntityBase.init(a);}else{this.reloadJqgrid(b);}},_bindEventHander:function(){var a=this;
},reloadJqgrid:function(b){var a={grid:ReturnEntityRefunding._CONS_.GRID,pager:ReturnEntityRefunding._CONS_.PAGER,searchParam:b};this.returnEntityBase.reloadJqgrid(a);
},onSelectRow:function(b,a){selectedId=$(ReturnEntityRefunding._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(selectedId.length==1){if(ResUtils.canShow("returnEntity.button.refundingDetail")){ButtonUtils.enableBtn("refundingDetail");
}}else{ButtonUtils.disableBtn("refundingDetail");}}};function ReturnEntityComplete(){this.hadInit=false;this.isEdit=false;this.returnEntityBase=new ReturnEntityBase();
this.returnEntityBase.hadInit=true;}ReturnEntityComplete._CONS_={GRID:"#returnEntityCompleteGrid",PAGER:"#returnEntityCompletePager"};ReturnEntityComplete.prototype={init:function(b){var a={grid:ReturnEntityComplete._CONS_.GRID,pager:ReturnEntityComplete._CONS_.PAGER,gridRecordsSpan:"#returnEntityCompleteGrid_record",listParams:"Q__S__EQ__entity.status_=complete",widthElement:".wait_submit_wrapper",onSelectRow:this.onSelectRow,type:ReturnEntityBase._CONS_.COMPLETE_TAB_TYPE};
if(!this.hadInit){this.hadInit=true;this._bindEventHander();this.returnEntityBase.init(a);}else{this.reloadJqgrid(b);}},_bindEventHander:function(){var a=this;
},reloadJqgrid:function(b){var a={grid:ReturnEntityComplete._CONS_.GRID,pager:ReturnEntityComplete._CONS_.PAGER,searchParam:b};this.returnEntityBase.reloadJqgrid(a);
},onSelectRow:function(b,a){selectedId=$(ReturnEntityComplete._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(selectedId.length==1){if(ResUtils.canShow("returnEntity.button.completeDetail")){ButtonUtils.enableBtn("completeDetail");
}}else{ButtonUtils.disableBtn("completeDetail");}}};function ReturnEntityReject(){this.hadInit=false;this.isEdit=false;this.returnEntityBase=new ReturnEntityBase();
this.returnEntityBase.hadInit=true;}ReturnEntityReject._CONS_={GRID:"#returnEntityRejectGrid",PAGER:"#returnEntityRejectPager"};ReturnEntityReject.prototype={init:function(b){var a={grid:ReturnEntityReject._CONS_.GRID,pager:ReturnEntityReject._CONS_.PAGER,gridRecordsSpan:"#returnEntityRejectGrid_record",listParams:"Q__S__EQ__entity.status_=reject",widthElement:".wait_submit_wrapper",onSelectRow:this.onSelectRow,type:ReturnEntityBase._CONS_.REJECT_TAB_TYPE};
if(!this.hadInit){this.hadInit=true;this._bindEventHander();this.returnEntityBase.init(a);}else{this.reloadJqgrid(b);}},_bindEventHander:function(){var a=this;
},reloadJqgrid:function(b){var a={grid:ReturnEntityReject._CONS_.GRID,pager:ReturnEntityReject._CONS_.PAGER,searchParam:b};this.returnEntityBase.reloadJqgrid(a);
},onSelectRow:function(b,a){selectedId=$(ReturnEntityReject._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(selectedId.length==1){if(ResUtils.canShow("returnEntity.button.rejectDetail")){ButtonUtils.enableBtn("rejectDetail");
}}else{ButtonUtils.disableBtn("rejectDetail");}}};function ReturnEntityNotReceive(){this.hadInit=false;this.isEdit=false;this.returnEntityBase=new ReturnEntityBase();
this.returnEntityBase.hadInit=true;}ReturnEntityNotReceive._CONS_={GRID:"#returnEntityNotReceiveGrid",PAGER:"#returnEntityNotReceivePager"};ReturnEntityNotReceive.prototype={init:function(b){var a={grid:ReturnEntityNotReceive._CONS_.GRID,pager:ReturnEntityNotReceive._CONS_.PAGER,gridRecordsSpan:"#returnEntityNotReceiveGrid_record",listParams:"Q__S__EQ__entity.status_=not_receive",widthElement:".wait_submit_wrapper",onSelectRow:this.onSelectRow,type:ReturnEntityBase._CONS_.NOT_RECEIVE_TAB_TYPE};
if(!this.hadInit){this.hadInit=true;this._bindEventHander();this.returnEntityBase.init(a);}else{this.reloadJqgrid(b);}},_bindEventHander:function(){var a=this;
},reloadJqgrid:function(b){var a={grid:ReturnEntityNotReceive._CONS_.GRID,pager:ReturnEntityNotReceive._CONS_.PAGER,searchParam:b};this.returnEntityBase.reloadJqgrid(a);
},onSelectRow:function(b,a){selectedId=$(ReturnEntityNotReceive._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(selectedId.length==1){if(canShow("returnEntity.button.notReceiveDetail")){ButtonUtils.enableBtn("notReceiveDetail");
}}else{ButtonUtils.disableBtn("notReceiveDetail");}}};function ReturnLog(){this.hadInit=false;this.isEdit=false;this.returnLogRowid=0;}ReturnLog._CONS_={SAVE_ADD_URL:ctx+"/ec/ret/returnEntity/logSaveAdd.htm",DIV_ID:"#returnLogDiv",GRID:"#returnLogGrid",GRID_ID:"returnLogGrid",PAGER:"#returnLogPager",PAGER_ID:"returnLogPager",JSON_ID:"returnLogJSON",};
ReturnLog.prototype={init:function(b){var a=this;if(!a.hadInit){a.hadInit=true;a._bindEventHander();}a.loadListData(b);},loadListData:function(b){var a=this;
FormUtils.loadData(ctx+"/ec/ret/returnEntity/returnLogListData.htm?Q__S__EQ__entity_id_="+b,function(c){a._initJqgrid({data:c});});},_bindEventHander:function(){var a=this;
$(".form_wrapper").on("click",".returnLogDetail",function(){a.isEdit=true;var b=$(this).attr("idVal");if(!b){b=$(ReturnLog._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,"请选择要查看的记录");return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,"只能查看一条记录");return;
}}}var c=$(ReturnLog._CONS_.GRID).jqGrid("getRowData",b);$("#returnLogEditForm").find("[id=nameDiv]").show();$("#returnLogEditForm").find("[name=name]").val(c["name"]);
$("#returnLogEditForm").find("[name=comment]").val(c["comment"]).attr("disabled",true);$("#logEditType").val("detail");a._openEditDialog();});$(".form_wrapper").on("click",".returnLogAdd",function(){$("#returnLogEditForm").find("[id=nameDiv]").hide();
$("#returnLogEditForm").find("[name=comment]").val("").attr("disabled",false);$("#logEditType").val("add");a._openEditDialog();});},_loadData:function(b){var a=this;
FormUtils.loadData(ReturnEntityBase._CONS_.EDIT_URL+"?id="+b,function(c){$("#id").val(c.id);$("#skuCount").val(c.skuCount);$("#needReturn").val(c.needReturn);
$("#returnAddr").val(c.returnAddr);$("#trackingNo").val(c.trackingNo);$("#shipAmount").val(c.shipAmount);$("#reasonName").val(c.reasonName);$("."+c.status).show();
a._showImages(c.returnImgPos);a.soItemList.init({data:c.soItemVos,type:SoItemList._CONS_.ONE_TYPE});});},_initJqgrid:function(c){var a=this;var b=[];if(c){b=c.data;
}$(ReturnLog._CONS_.DIV_ID).empty().append("<table id='"+ReturnLog._CONS_.GRID_ID+"'></table><div id='"+ReturnLog._CONS_.PAGER_ID+"''></div>");$.jgrid.defaults.styleUI="Bootstrap";
$(ReturnLog._CONS_.GRID).jqGrid({datatype:"jsonstring",datastr:b,height:350,autowidth:true,shrinkToFit:true,rowNum:10,mtype:"POST",viewrecords:true,multiselect:true,rownumbers:true,colNames:["操作者姓名","源状态","目的状态","操作时间","备注说明","备注（隐藏）"],colModel:[{name:"name",width:170},{name:"srcStatus",width:170,formatter:function(d,f,g){var e=g.srcStatus;
if(g.srcStatus=="awaiting"){e="待审核";}else{if(g.srcStatus=="reject"){e="审核不通过";}else{if(g.srcStatus=="comfirm"){e="已审核(等待退货)";}else{if(g.srcStatus=="comfirm_direct"){e="已审核(无需退货)";
}else{if(g.srcStatus=="receive"){e="已收货";}else{if(g.srcStatus=="not_receive"){e="未收到";}else{if(g.srcStatus=="refund"){e="退款中";}else{if(g.srcStatus=="complete"){e="已完成";
}else{if(g.srcStatus=="reject"){e="审核不通过";}}}}}}}}}return e;}},{name:"destStatus",width:170,formatter:function(d,f,g){var e=g.destStatus;if(g.destStatus=="awaiting"){e="待审核";
}else{if(g.destStatus=="reject"){e="审核不通过";}else{if(g.destStatus=="comfirm"){e="已审核(等待退货)";}else{if(g.destStatus=="comfirm_direct"){e="已审核(无需退货)";}else{if(g.destStatus=="receive"){e="已收货";
}else{if(g.destStatus=="not_receive"){e="未收到";}else{if(g.destStatus=="refund"){e="退款中";}else{if(g.destStatus=="complete"){e="已完成";}else{if(g.destStatus=="reject"){e="审核不通过";
}}}}}}}}}return e;}},{name:"createTime",width:200,formatter:function(d){return DateUtils.miniTime(d);}},{name:"commentShow",width:300,formatter:function(d,e,f){var g=new StringBuffer();
g.append("<div style='width:auto;overflow:hidden; white-space:nowrap; text-overflow:ellipsis'>");g.append(f.comment);g.append("</div>");return g.toString();
}},{name:"comment",width:200,hidden:true}],pager:ReturnLog._CONS_.PAGER,hidegrid:false});},reloadJqgrid:function(c){var b=this;var a=$(ReturnLog._CONS_.GRID).jqGrid("getGridParam","postData");
$.extend(a,{Q__S__EQ__entity_id_:c});$(ReturnLog._CONS_.GRID).jqGrid("setGridParam",{search:true}).trigger("reloadGrid",[{page:1}]);},_openEditDialog:function(b){var a=this;
a.layerIndex=layer.open({type:1,title:"退货备注日志",maxmin:false,shadeClose:false,btn:["确定","关闭"],area:["780px","480px"],content:$("#returnLogPage"),success:function(c,d){},yes:function(d,c){if($("#logEditType").val()=="add"){a._save();
}layer.close(a.layerIndex);}});},_save:function(){var b=this;var a=ReturnLog._CONS_.SAVE_ADD_URL;var c=new StringBuffer();c.append("entityId="+$("#returnApplyForm").find("[name=id]").val());
c.append("&comment="+$("#returnLogEditForm").find("[name=comment]").val());FormUtils.submit(a,c.toString(),function(d){if(d.success){if(d.msgCode==actionCode.CREATE){DialogUtils.success(msgCode.INFO,msgCode.CREATE_MSG);
}else{if(d.msgCode==actionCode.UPDATE){DialogUtils.success(msgCode.INFO,msgCode.UPDATE_MSG);}}b.reloadJqgrid($("#returnApplyForm").find("[name=id]").val());
}else{DialogUtils.error(msgCode.FAIL_MSG,d.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}};function SoItemList(){this.hadInit=false;
this.isEdit=false;this.isCanEdit=true;this.otherFunc=null;this.soItemRowid=0;}SoItemList._CONS_={LIST_TYPE:"list",ONE_TYPE:"one",GRID_DIV:"#soItemGridDiv",GR_LIST_DIV:"#soItemListGridDiv",GR_lIST_ID:"#soItemListGrid",GRID:"#soItemGrid",EDIT_GRID:"#editSoItemGrid",EXCHANGE_GRID:"#exchangeSoItemGrid"};
SoItemList.prototype={init:function(b){var a=this;if(b){a.calType=b.calType;if(!a.hadInit&&b.type==SoItemList._CONS_.LIST_TYPE){a.hadInit=true;a._bindEventHander();
}if(b.type==SoItemList._CONS_.LIST_TYPE){a._initListJqgrid(b);}else{if(b.type==SoItemList._CONS_.ONE_TYPE){a._initJqgrid(b);}}}},_bindEventHander:function(){var a=this;
},_initListJqgrid:function(e){var a=this;var d=[];if(e){if(typeof e.data!=undefined&&e.data!=null&&e.data.length){d=e.data;}}var c="元";if("point"==e.soType){c="积分";
}if(d!=null&&d.length>0){for(var b=0;b<d.length;b++){d[b].countShow=d[b].count;d[b].spDiscoutShow=d[b].spDiscout;d[b].spCommentShow=d[b].spComment;d[b].totalAmount=parseFloat(d[b].salesPrice)*parseInt(d[b].count)-parseFloat(d[b].spDiscout);
}}$.jgrid.defaults.styleUI="Bootstrap";$(SoItemList._CONS_.GR_lIST_ID).jqGrid({datatype:"jsonstring",caption:"产品列表",datastr:d,autowidth:true,height:"auto",shrinkToFit:true,multiselect:false,sortable:false,rownumbers:true,colNames:["产品图片","产品ID","产品SKU ID","产品SKU编码","已退货数量","审核不通过数量","产品名称","原价("+c+")","数量","折扣("+c+")","小计("+c+")","操作"],colModel:[{name:"prodPic",sortable:false,width:120,formatter:function(f,i,j){var h="<img style='display: inline; width:35px;' ";
if(j.prodPic=="总计:"){return j.prodPic;}else{if(j.prodPic!=""&&j.prodPic!=null){h=h+" urlval='"+j.prodPic+"' ";var g={url:j.prodPic,name:"",id:""};h=h+" src='"+ImageUtils.getUrl(g)+"' ";
}else{h=h+" src='"+ctx+"/img/jt/nophoto.png' ";h=h+" urlval='' ";}}h+=" >";return h;}},{name:"prodId",sortable:false,width:100,hidedlg:true,hidden:true},{name:"skuId",sortable:false,width:120,hidedlg:true,hidden:true},{name:"skuKey",sortable:false,width:120,hidedlg:true,hidden:true},{name:"returnCount",sortable:false,width:120,hidedlg:true,hidden:true},{name:"rejectReturnCount",sortable:false,width:120,hidedlg:true,hidden:true},{name:"prodName",sortable:false,width:200},{name:"salesPrice",sortable:false,width:120,align:"right",sorttype:"float",classes:"test",formatter:"number",summaryType:"sum"},{name:"countShow",sortable:false,align:"right",classes:"test",width:120},{name:"spDiscoutShow",sortable:false,width:120,align:"right",sorttype:"float",classes:"test",formatter:"number",summaryType:"sum"},{name:"totalAmount",sortable:false,width:120,align:"right",sorttype:"float",classes:"test",formatter:"number",summaryType:"sum"},{name:"button",sortable:false,align:"center",width:100,formatter:function(f,g,i){var h="";
if(i.countShow>(i.returnCount+i.exchangeCount)){h=h+"<button  type='button'   class='btn btn-sm btn-outline btn-primary toApply'   style='margin: 0px 3px 0px 0px;'    value='"+i.id+"' >申请</button>";
}if((a.calType==SoInfo._CONS_.RETURN_TYPE&&i.returnCount+i.rejectReturnCount>0)||(a.calType==SoInfo._CONS_.EXCHANGE_TYPE&&i.exchangeCount+i.rejectExchangeCount>0)){h=h+"<button  type='button' class='btn btn-sm btn-outline btn-primary applyRecords'   style='margin: 0px 3px 0px 0px;'    value='"+i.id+"' >查看</button>";
}if(h==""){if(a.calType==SoInfo._CONS_.RETURN_TYPE){h=h+"<span class='label label-primary'>已申请换货</span>";}else{h=h+"<span class='label label-primary'>已申请退货</span>";
}}return h;}}],footerrow:true,gridComplete:function(){var f=a.footerData();if(a.otherFunc!=null){a.otherFunc(f);}var h=$(SoItemList._CONS_.GR_lIST_ID).jqGrid("getDataIDs");
for(var g=0;g<h.length;g++){if(h[g]!="total"){$(SoItemList._CONS_.GR_lIST_ID).editRow(h[g]);}}},});},reloadListJqgrid:function(f){var e={};if(params&&jQuery.type(params)=="string"){params=decodeURIComponent(params,true);
var b=params.split("&");if(b.length){for(var c=0;c<b.length;c++){var d=b[c].split("=");if(d.length==2&&d[1]){e[d[0]]=d[1];}}}}else{e=params;}var a=$(SoItemList._CONS_.GR_lIST_ID).jqGrid("getGridParam","postData");
$.extend(a,{datastr:f});$(SoItemList._CONS_.GR_lIST_ID).jqGrid("setGridParam",{search:true}).trigger("reloadGrid",[{page:1}]);},footerData:function(){var c=$(SoItemList._CONS_.GR_lIST_ID).jqGrid("getCol","totalAmount",true,"sum");
var b=$(SoItemList._CONS_.GR_lIST_ID).jqGrid("getCol","count",true,"sum");$(SoItemList._CONS_.GR_lIST_ID).jqGrid("footerData","set",{prodPic:"总计:",countShow:b,totalAmount:c});
var a=$(SoItemList._CONS_.GR_lIST_ID).jqGrid("footerData","get");return a;},_initJqgrid:function(e){var a=this;var d=[];if(e){if(typeof e.data!=undefined&&e.data!=null&&e.data.length){d=e.data;
}}var c="元";if("point"==e.soType){c="积分";}if(d!=null&&d.length>0){for(var b=0;b<d.length;b++){d[b].countShow=d[b].count;d[b].spDiscoutShow=d[b].spDiscout;
d[b].spCommentShow=d[b].spComment;d[b].totalAmount=parseFloat(d[b].salesPrice)*parseInt(d[b].count)-parseFloat(d[b].spDiscout);}}$("#soItemDiv").empty().append("<table id='soItemGrid'></table>");
$.jgrid.defaults.styleUI="Bootstrap";$(SoItemList._CONS_.GRID).jqGrid({datatype:"jsonstring",datastr:d,width:$("#soItemDiv").width(),height:"auto",shrinkToFit:true,multiselect:false,sortable:false,rownumbers:true,colNames:["产品图片","产品ID","产品SKU ID","产品SKU编码","产品名称","原价("+c+")","数量",],colModel:[{name:"prodPic",sortable:false,width:100,formatter:function(f,i,j){var h="<img style='display: inline; width:35px;' ";
if(j.prodPic=="总计:"){return j.prodPic;}else{if(j.prodPic!=""&&j.prodPic!=null){h=h+" urlval='"+j.prodPic+"' ";var g={url:j.prodPic,name:"",id:""};h=h+" src='"+ImageUtils.getUrl(g)+"' ";
}else{h=h+" src='"+ctx+"/img/jt/nophoto.png' ";h=h+" urlval='' ";}}h+=" >";return h;}},{name:"prodId",sortable:false,width:120,hidedlg:true,hidden:true},{name:"skuId",sortable:false,width:120,hidedlg:true,hidden:true},{name:"skuKey",sortable:false,width:120,hidedlg:true,hidden:true},{name:"prodName",sortable:false,width:200},{name:"salesPrice",sortable:false,width:100,align:"right",sorttype:"float",classes:"test",formatter:"number",summaryType:"sum"},{name:"countShow",sortable:false,align:"right",classes:"test",width:120}],});
},genEditSoItemGrid:function(d){var a=this;var c=[];if(d){if(typeof d.data!=undefined&&d.data!=null&&d.data.length){c=d.data;}}var b="元";if("point"==d.soType){b="积分";
}$("#editSoItemGridDiv").empty().append("<table id='editSoItemGrid'></table>");$.jgrid.defaults.styleUI="Bootstrap";$(SoItemList._CONS_.EDIT_GRID).jqGrid({datatype:"jsonstring",datastr:c,width:800,height:"auto",shrinkToFit:true,multiselect:false,sortable:false,rownumbers:true,colNames:["产品图片","产品ID","产品SKU ID","产品SKU编码","产品名称","原价("+b+")","操作"],colModel:[{name:"prodPic",sortable:false,width:120,formatter:function(e,h,i){var g="<img style='display: inline; width:35px;' ";
if(i.prodPic=="总计:"){return i.prodPic;}else{if(i.prodPic!=""&&i.prodPic!=null){g=g+" urlval='"+i.prodPic+"' ";var f={url:i.prodPic,name:"",id:""};g=g+" src='"+ImageUtils.getUrl(f)+"' ";
}else{g=g+" src='"+ctx+"/img/jt/nophoto.png' ";g=g+" urlval='' ";}}g+=" >";return g;}},{name:"prodId",sortable:false,width:120,hidedlg:true,hidden:true},{name:"skuId",sortable:false,width:120,hidedlg:true,hidden:true},{name:"skuKey",sortable:false,width:120,hidedlg:true,hidden:true},{name:"prodName",sortable:false,width:200},{name:"salesPrice",sortable:false,width:100,align:"right",sorttype:"float",classes:"test",formatter:"number",summaryType:"sum"},{name:"button",sortable:false,align:"center",width:120,formatter:function(e,f,h){var g="<button  type='button'   class='btn btn-primary changeSku'   style='margin: 0px 2px 0px 0px;'    value='"+h.id+"' >更换</button>";
return g;}}],});},addSoItem2Grid:function(b){var a=this;$(SoItemList._CONS_.EDIT_GRID).empty();$(SoItemList._CONS_.EDIT_GRID).jqGrid("addRowData","tmpSoItem",b,"last");
},genExchangeSoItemGrid:function(d){var a=this;var c=[];if(d){if(typeof d.data!=undefined&&d.data!=null&&d.data.length){c=d.data;}}var b="元";if("point"==d.soType){b="积分";
}$("#exchangeSoItemGridDiv").empty().append("<table id='exchangeSoItemGrid'></table>");$.jgrid.defaults.styleUI="Bootstrap";$(SoItemList._CONS_.EXCHANGE_GRID).jqGrid({datatype:"jsonstring",datastr:c,width:800,height:"auto",shrinkToFit:true,multiselect:false,sortable:false,rownumbers:true,colNames:["产品图片","产品ID","产品SKU ID","产品SKU编码","产品名称","原价("+b+")"],colModel:[{name:"prodPic",sortable:false,width:150,formatter:function(e,h,i){var g="<img style='display: inline; width:35px;' ";
if(i.prodPic=="总计:"){return i.prodPic;}else{if(i.prodPic!=""&&i.prodPic!=null){g=g+" urlval='"+i.prodPic+"' ";var f={url:i.prodPic,name:"",id:""};g=g+" src='"+ImageUtils.getUrl(f)+"' ";
}else{g=g+" src='"+ctx+"/img/jt/nophoto.png' ";g=g+" urlval='' ";}}g+=" >";return g;}},{name:"prodId",sortable:false,width:120,hidedlg:true,hidden:true},{name:"skuId",sortable:false,width:120,hidedlg:true,hidden:true},{name:"skuKey",sortable:false,width:120,hidedlg:true,hidden:true},{name:"prodName",sortable:false,width:200},{name:"salesPrice",sortable:false,width:150,align:"right",sorttype:"float",classes:"test",formatter:"number",summaryType:"sum"}],});
}};var ShipCompanyUtils={getOptions:function(c){var b=this;var a=window.sessionStorage.getItem("loacalShipCompany");if(a&&a!=null&&a!=""){b._appendData(c,JSON.parse(a));
}else{FormUtils.loadData(ctx+"/ec/ship/shipCompany/allActiveCompany.htm",function(d){window.sessionStorage.setItem("loacalShipCompany",JSON.stringify(d));
b._appendData(c,d);});}},_appendData:function(c,a){var f;if(c.container){f=$("#"+c.container);if(f.length==0){f=$("select."+c.container);if(f.length==0){f=$("select[name='"+c.container+"']");
if(f.length==0){return false;}}}}var g=new StringBuffer();if(c.caption){g.append("<option value=''>").append(c.caption).append("</option>");}if(a&&a.length>0){if(c.fn){c.fn(a);
}else{var g=new StringBuffer();if(c.caption){g.append("<option value=''>").append(c.caption).append("</option>");}for(var d=0;d<a.length;d++){var e=a[d].id;
var b=a[d].name;if(c.selectedOption&&c.selectedOption==e){g.append("<option value='").append(e).append("' hotVar='").append(a[d].isHot).append("' selected='selected'>").append(b).append("</option>");
}else{g.append("<option value='").append(e).append("' hotVar='").append(a[d].isHot).append("'>").append(b).append("</option>");}}f.empty().append(g.toString());
}}if(c.callBack&&typeof c.callBack=="function"){c.callBack();}}};var ShipInfoUtil={getShipStatusName:function(a){var b=a;if("0"==a){b="在途";}else{if("1"==a){b="揽件";
}else{if("2"==a){b="疑难";}else{if("3"==a){b="签收";}else{if("4"==a){b="退签";}else{if("5"==a){b="派件";}else{if("6"==a){b="退回";}else{if("-1"==a){b="查不到快递公司编码";
}}}}}}}}return b;},getLastShipInfo:function(b){var c="";if(b){var a=b.split("<br>");if(a.length>1){c=a[a.length-2];}else{c=a[0];}}return c;}};