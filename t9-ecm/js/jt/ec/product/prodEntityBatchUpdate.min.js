function ProdEntityBatchUpdate(){this.params=null;}ProdEntityBatchUpdate._CONS_={};ProdEntityBatchUpdate.prototype={init:function(b){var a=this;if(!this.hadInit){this.hadInit=true;
this.params=b;this._bindEventHander();this._hideNotGrantBtn();this._bindFormValidation();}},_hideNotGrantBtn:function(){},_bindEventHander:function(){var a=this;
$("body").on("change","#checkSaleRange",function(){var b=this.checked;if(b){$("[name=saleRange]").attr("required",true);}else{$("[name=saleRange]").attr("required",false);
}});$("body").on("change","#checkUpdateType",function(){var b=this.checked;if(b){$("[name=updateCateId]").attr("required",true);}else{$("[name=updateCateId]").attr("required",false);
}});$("body").on("change","#checkUpdateSkuPrecentLimit",function(){var b=this.checked;if(b){$("[name=skuPercentLimit]").attr("required",true);}else{$("[name=skuPercentLimit]").attr("required",false);
}});$(document).on("click","#updateCateId",function(){var b={isMultiple:0,typeKey:"product_catalog",selectedCateIds:$("#checkCateId").val(),pKey:"category",container:"updateCateId",fn:function(c){$("#checkCateId").val(c);
}};CateUtils.selectCateTreeBox(b);});$(document).on("click","#batchUpdateCancel",function(){$("#batchUpdateContainer").modal("hide");});$(document).on("click","#batchUpdateSave",function(){if($("#batchUpdateForm").find("select[name=saleRange]").val()&&!$("#checkSaleRange").is(":checked")){DialogUtils.error(msgCode.ERROR,"请勾选产品范围");
return;}if($("#batchUpdateForm").find("input[name=cateId]").val()&&!$("#checkUpdateType").is(":checked")){DialogUtils.error(msgCode.ERROR,"请勾选产品分类");return;
}if($("#batchUpdateForm").find("input[name=skuPercentLimit]").val()&&!$("#skuPercentLimit").is(":checked")){DialogUtils.error(msgCode.ERROR,"请勾选sku折扣限制");
return;}if(!$("#batchUpdateForm").valid()){return;}DialogUtils.confirmWithOptions({title:"确定批量修改当前选中结果？",text:"",confirmButtonText:"确定",yesFunc:function(){var b=$("#batchUpdateForm").serialize();
FormUtils.submit(ctx+"/ec/product/prodEntity/batchUpdate.htm",a.params+"&"+b,function(c){if(c.success){DialogUtils.success(msgCode.SUCCESS,c.msg);$("#batchUpdateContainer").modal("hide");
$("#prodEntitySearchForm").find(".prodEntitySearch").trigger("click");}else{DialogUtils.error(msgCode.ERROR,c.msg);}},function(){DialogUtils.error(msgCode.ERROR,"服务器错误");
});}});});},_bindFormValidation:function(){var a={rules:{skuPercentLimit:{digits:true,number:true,min:1,max:99}},messages:{skuPercentLimit:{digits:"请输入正整数",min:"请输入大于1的整数",max:"请输入小于99的整数"}}};
FormUtils.bindFormValidation("batchUpdateForm",a);}};