(function(d){var c="album-carousel-thumb-selected",a="hide",b="px";jQuery.Album=function(e){this.setting={root:d("#album-image-md"),image:d("#album-image"),title:d("#album-image-ft"),btnDownload:d("#album-download"),navBlock:d("#album-image-nav"),btnPrev:d("#album-image-btn-prev"),btnNext:d("#album-image-btn-next"),prevBlock:d("#album-image-nav-left-block"),nextBlock:d("#album-image-nav-right-block"),overlay:d("#album-image-loading-overlay"),Carousel:new jQuery.Carousel({root:"#album-carousel",carousel:"#album-carousel-list",pages:{prev:"#album-carousel-btn-prev",next:"#album-carousel-btn-next"},direction:"H"}),curIndex:0,maxWidth:700,maxHeight:300};
d.extend(this.setting,e);this.selectedItem=null;this.currentItem=null;this.isloading=false;this.init();return this;};jQuery.Album.prototype={init:function(){this.select().change().bindEvent();
return this;},change:function(){var f=this,n=f.currentItem,g=f.getImage(),m=f.getTitle(),h=f.getOverlay(),i=f.getBtnDownload(),e=n.find("a:first").attr("href"),j=n.find("img:first").attr("alt"),l=0,k=new Image();
d.log("the src is "+e);h.removeClass(a);this.isloading=true;k.src=e;d(k).load(function(p){var q=k.width,o=k.height,s=f.getMaxWidth(),r=f.getMaxHeight();
l=q/o;if(q>s){q=s;o=q/l;if(o>r){l=r/o;q=q*l;o=r;}}else{if(q<=s){if(o>r){l=r/o;q=q*l;o=r;}}}g.animate({"width":q+b,"height":o+b,"margin-left":-(q/2)+b,"margin-top":-(o/2)+b},500,function(){g.attr({"src":e,"alt":j});
m.html(j);i.attr("href",e);h.addClass(a);f.isloading=false;});});return this;},select:function(){var h=this.selectedItem,g=null,e=this.getItems(),f=this.getCurrentIndex();
if(h){h.removeClass(c);}g=this.currentItem=d(e[f]);g.addClass(c);this.selectedItem=g;return this;},prev:function(){this.setCurrentIndex(this.getCurrentIndex()-1);
if(this.getCurrentIndex()<0){this.setCurrentIndex(this.getLength()-1).prevGroup();}else{if(this.getCurrentIndex()>0){if(this.getCurrentIndex()<this.getCurrentPage()*this.getItemsPrePage()){this.prevGroup();
}}}this.select().change();return this;},next:function(){this.setCurrentIndex(this.getCurrentIndex()+1);if(this.getCurrentIndex()>this.getLength()-1){this.setCurrentIndex(0).nextGroup();
}else{if(this.getCurrentPage()<this.getMaxPages()){if(this.getCurrentIndex()>((this.getCurrentPage()+1)*this.getItemsPrePage())-1){this.nextGroup();}}}this.select().change();
return this;},prevGroup:function(){var e=this.getCarousel();e.prev();return this;},nextGroup:function(){var e=this.getCarousel();e.next();return this;},bindEvent:function(){var j=this,f=j.getRoot(),l=j.getNavBlock(),k=j.getPrevBlock(),i=j.getNextBlock(),h=j.getBtnPrev(),e=j.getBtnNext(),g=j.getItems();
f.hover(function(){l.removeClass(a);},function(){l.addClass(a);});k.click(function(m){j.prev();m.preventDefault();m.stopPropagation();});i.click(function(m){j.next();
m.preventDefault();m.stopPropagation();});h.click(function(m){j.prev();m.preventDefault();m.stopPropagation();});e.click(function(m){j.next();m.preventDefault();
m.stopPropagation();});g.each(function(m,n){d(n).click(function(o){if(!d(this).hasClass(c)&&!j.isLoading){j.setCurrentIndex(m).select().change();}o.preventDefault();
o.stopPropagation();});});return this;},getRoot:function(){return d(this.setting.root);},getImage:function(){return d(this.setting.image);},getTitle:function(){return d(this.setting.title);
},getBtnDownload:function(){return d(this.setting.btnDownload);},getNavBlock:function(){return d(this.setting.navBlock);},getPrevBlock:function(){return d(this.setting.prevBlock);
},getNextBlock:function(){return d(this.setting.nextBlock);},getBtnPrev:function(){return d(this.setting.btnPrev);},getBtnNext:function(){return d(this.setting.btnNext);
},getOverlay:function(){return d(this.setting.overlay);},getCarousel:function(){return this.setting.Carousel;},getCurrentPage:function(){var e=this.getCarousel();
return e.setting.curPage;},setCurrentPage:function(e){var f=this.getCarousel();f.setting.curPage=e;return this;},getMaxPages:function(){var e=this.getCarousel();
return e.setting.maxPages;},getItemsPrePage:function(){var e=this.getCarousel();return e.setting.itemsPrePage;},getItems:function(){return this.getSamples();
},getSamples:function(){var e=this.getCarousel();return e.setting.items;},getLength:function(){return this.getItems().length;},getCurrentIndex:function(){return this.setting.curIndex;
},setCurrentIndex:function(e){this.setting.curIndex=e;return this;},getMaxWidth:function(){return this.setting.maxWidth;},getMaxHeight:function(){return this.setting.maxHeight;
}};})(jQuery);