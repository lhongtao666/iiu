$(function(){var a=new FeeSeeting();a.init();});function FeeSeeting(){this.hadInit=false;this.ids=[];this.prList=[];}FeeSeeting._CONS_={SAVE_ADD_URL:ctx+"/ec/ship/shipCompany/feeSettingAdd.htm",LIST_DATA_URL:ctx+"/ec/ship/shipCompany/listData.htm",PROVINCE_LIST_URL:ctx+"/gl/cate/cate/getCateByCateTypeAndParentId.htm",EDIT_FORM_ID:"shipCompanyForm",};
FeeSeeting.prototype={init:function(){if(!this.hadInit){this.hadInit=true;self.isFormDataChange=false;this._initTable();this._bindEventHander();this.getProvinceList();
ShipCompanyUtils.getOptions({container:"shipCompanySearch",caption:"全部"});}},_bindEventHander:function(){var a=this;$(document).on("click",".prDoubleDown",function(){$(this).hide();
$(this).next().show();$(this).parents("td").find(".shipPrWeight").show();$(this).parents("td").find(".returnPrWeight").show();});$(document).on("click",".prDoubleUp",function(){$(this).hide();
$(this).prev().show();$(this).parents("td").find(".shipPrWeight").hide();$(this).parents("td").find(".returnPrWeight").hide();});$(document).on("click",".weightDivMinus",function(){$(this).parent().remove();
});$(document).on("click",".feeSettingAdd",function(){var b=$(".shipCompanySearch").val();var c=$(".shipCompanySearch").find("option:selected").text();
if(a.ids.includes(b)){$(".nav-tabs li").removeClass("active");$(".tab-content").children().removeClass("active");$(".nav-tabs").find("li[idVal="+b+"]").addClass("active");
$(".tab-content").find("div[id="+b+"]").addClass("active");}else{$(".nav-tabs li").removeClass("active");$(".tab-content").children().removeClass("active");
a.ids.push(b);a.buildFeeSetting(c,b);a.initProSelect($(".tab-content").find("div[id="+b+"]").find(".shipPrContainer"),"shipToPid");a.initProSelect($(".tab-content").find("div[id="+b+"]").find(".shipPrContainerStart"),"shipStartPid");
a.initProSelect($(".tab-content").find("div[id="+b+"]").find(".returnPrContainerStart"),"returnStartPid");a.initProSelect($(".tab-content").find("div[id="+b+"]").find(".returnPrContainer"),"returnToPid");
}});$(document).on("click",".feeSettingSaveAll",function(){ButtonUtils.enableBtn("feeSettingSaveAll");var c=$(".tab-content").find("div[class*=active]");
var b="shipCompanyPo="+JSON.stringify(a._getShipPo(c))+"&shipFeeServices="+JSON.stringify(a._getShipFeeServices(c))+"&shipFeeFormulas="+JSON.stringify(a._getShipFeeFormulas(c))+"&shipFeeStocks="+JSON.stringify(a._getShipFeeStocks(c));
FormUtils.submit(FeeSeeting._CONS_.SAVE_ADD_URL,b,function(d){if(d.success){ButtonUtils.disableBtn("feeSettingSaveAll");if(d.msgCode==actionCode.CREATE){DialogUtils.success(msgCode.INFO,msgCode.CREATE_MSG);
}}else{ButtonUtils.enableBtn("feeSettingSaveAll");DialogUtils.error(msgCode.FAIL_MSG,d.msg);}},function(){ButtonUtils.enableBtn("feeSettingSaveAll");DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});});$(document).on("click",".shipAddToPid",function(){var b=$(this).next().val();var c=$(this).next().find("option:selected").text();if(b){if($(this).parents("td").find(".shipPrWeight").find("input[prIdVal="+b+"]").length>0){DialogUtils.error(msgCode.ERROR,"省份已存在");
}else{var d=new StringBuffer();d.append("<div class='col-sm-4 shipPrWeightDiv' style='padding-top:3px;'>");d.append("<input type='text' class='form-control' name='toPid' value='"+c+"' prIdVal='"+b+"' style='float:left;width:25%;' readonly='true'><span style='float:left;'>&nbsp;</span>");
d.append("<input type='text' class='form-control' name='basePrice' style='float:left;width:20%;' placeholder='首重单价'><span style='float:left;'>&nbsp;</span>");
d.append("<input type='text' class='form-control' name='additionalPrice' style='float:left;width:20%;' placeholder='续重单价'>");d.append("&nbsp;<button type='button' class='btn btn-xs btn-primary weightDivMinus'><i class='fa fa-minus'></i></button>");
d.append("</div>");$(this).parents("td").find(".shipPrWeight").append(d.toString());}}else{DialogUtils.error(msgCode.ERROR,"请选择发货目的地省份");}});$(document).on("click",".returnAddToPid",function(){var b=$(this).next().val();
var c=$(this).next().find("option:selected").text();if(b){if($(this).parents("td").find(".returnPrWeight").find("input[prIdVal="+b+"]").length>0){DialogUtils.error(msgCode.ERROR,"省份已存在");
}else{var d=new StringBuffer();d.append("<div class='col-sm-4 returnPrWeightDiv' style='padding-top:3px;'>");d.append("<input type='text' class='form-control' name='startPid' value='"+c+"' prIdVal='"+b+"' style='float:left;width:25%;' readonly='true'><span style='float:left;'>&nbsp;</span>");
d.append("<input type='text' class='form-control' name='basePrice' style='float:left;width:20%;' placeholder='首重单价'><span style='float:left;'>&nbsp;</span>");
d.append("<input type='text' class='form-control' name='additionalPrice' style='float:left;width:20%;' placeholder='续重单价'>");d.append("&nbsp;<button type='button' class='btn btn-xs btn-primary weightDivMinus'><i class='fa fa-minus'></i></button>");
d.append("</div>");$(this).parents("td").find(".returnPrWeight").append(d.toString());}}else{DialogUtils.error(msgCode.ERROR,"请选择退货出发地省份");}});$(document).on("change","select[name=serviceTypes]",function(){if($(this).val()=="money"){$(this).parent().next().remove();
var b=new StringBuffer();b.append("<div class='col-sm-2'>");b.append("<input type='text' class='form-control' name='serviceMoney'style='width:calc(100% - 50px);float: left;'>&nbsp;元");
b.append("</div>");$(this).parents(".row").append(b.toString());}else{$(this).parent().next().remove();var b=new StringBuffer();b.append("<div class='col-sm-2'>");
b.append("<input type='text' class='form-control' name='servicePercent'style='width:calc(100% - 50px);float: left;'>&nbsp;%");b.append("</div>");$(this).parents(".row").append(b.toString());
}});$(document).on("change","select[name=exceedType]",function(){$(this).next().remove();if($(this).val()=="one"){var b=new StringBuffer();b.append("<div>");
b.append("<span style='float:left;'>&nbsp;每件收&nbsp;</span>");b.append("<input type='text' class='form-control' name='exceedOne' style='width:15%;float: left;'>");
b.append("<span style='float:left;width:5%;'>元</span>");b.append("</div>");$(this).parent().append(b.toString());}else{var b=new StringBuffer();b.append("<div>");
b.append("<span style='float:left;'>&nbsp;每单收&nbsp;</span>");b.append("<input type='text' class='form-control' name='exceedSo' style='width:15%;float: left;'>");
b.append("<span style='float:left;width:5%;'>元</span>");b.append("</div>");$(this).parent().append(b.toString());}});$(document).on("change","select[name=packageExceedType]",function(){$(this).next().remove();
if($(this).val()=="one"){var b=new StringBuffer();b.append("<div>");b.append("<span style='float:left;'>&nbsp;每件收&nbsp;</span>");b.append("<input type='text' class='form-control' name='packageExceedOne' style='width:15%;float: left;'>");
b.append("<span style='float:left;width:5%;'>元</span>");b.append("</div>");$(this).parent().append(b.toString());}else{if($(this).val()=="so"){var b=new StringBuffer();
b.append("<div>");b.append("<span style='float:left;'>&nbsp;每单收&nbsp;</span>");b.append("<input type='text' class='form-control' name='packageExceedSo' style='width:15%;float: left;'>");
b.append("<span style='float:left;width:5%;'>元</span>");b.append("</div>");$(this).parent().append(b.toString());}else{var b=new StringBuffer();b.append("<div>");
b.append("<span style='float:left;'>&nbsp;收&nbsp;</span>");b.append("<input type='text' class='form-control' name='packageExceedFix' style='float:left;width:15%;'>");
b.append("<span style='float:left;width:5%;'>元</span>	");b.append("</div>");$(this).parent().append(b.toString());}}});$(document).on("click",".feeSetting",function(){if($(this).is(":checked")){$(this).val("y");
if($(this).attr("name")=="feeService"){var b=new StringBuffer();a.buildFeeServiceTr(b);$(this).parents(".tab-pane").find("#feeSettingTbody").append(b.toString());
}else{if($(this).attr("name")=="feeStock"){var b=new StringBuffer();a.buildFeeStockTr(b);$(this).parents(".tab-pane").find("#feeSettingTbody").append(b.toString());
}else{if($(this).attr("name")=="feePackage"){var b=new StringBuffer();a.buildFeePackageTr(b);$(this).parents(".tab-pane").find("#feeSettingTbody").append(b.toString());
}else{if($(this).attr("name")=="feeShip"){var b=new StringBuffer();a.buildFeeShipTr(b);$(this).parents(".tab-pane").find("#feeSettingTbody").append(b.toString());
a.initProSelect($(this).parents(".tab-pane").find(".shipPrContainer"),"shipToPid");a.initProSelect($(this).parents(".tab-pane").find(".shipPrContainerStart"),"shipStartPid");
}else{if($(this).attr("name")=="feeReturn"){var b=new StringBuffer();a.buildFeeReturnTr(b);$(this).parents(".tab-pane").find("#feeSettingTbody").append(b.toString());
a.initProSelect($(this).parents(".tab-pane").find(".returnPrContainerStart"),"returnStartPid");a.initProSelect($(this).parents(".tab-pane").find(".returnPrContainer"),"returnToPid");
}}}}}}else{$(this).val("n");if($(this).attr("name")=="feeService"){$(this).parents(".tab-pane").find(".feeServiceTr").remove();}else{if($(this).attr("name")=="feeStock"){$(this).parents(".tab-pane").find(".feeStockTr").remove();
}else{if($(this).attr("name")=="feePackage"){$(this).parents(".tab-pane").find(".feePackageTr").remove();}else{if($(this).attr("name")=="feeShip"){$(this).parents(".tab-pane").find(".feeShipTr").remove();
}else{if($(this).attr("name")=="feeReturn"){$(this).parents(".tab-pane").find(".feeReturnTr").remove();}}}}}}});},getProvinceList:function(){var a=this;
var b=FeeSeeting._CONS_.PROVINCE_LIST_URL+"?cateType=AddressCateType&parentKey=ChinaCityCateType-root";FormUtils.loadData(b,function(c){if(c.success){if(c.msg!=null&&c.msg!=""){a.prList=JSON.parse(c.msg);
}}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});},initProSelect:function(b,c){var a=this;var d=a.prList;b.each(function(){var g=new StringBuffer();
var f=$(this).attr("prVal");if(d&&d.length>0){g.append("<select class='form-control' style='float:left;width:40%;' name='"+c+"'>");g.append("<option value=''>请选择</option>");
for(var e=0;e<d.length;e++){g.append("<option idValue='"+d[e].id+"' value='"+d[e].value+"'");if(f&&f==d[e].value){g.append(" selected='selected'");}g.append(">"+d[e].name+"</option>");
}$(this).append(g.toString());}});},_getShipFeeStocks:function(c){var a=[];if(c.find("input[name=baseLte]").val()&&c.find("input[name=baseMoney]").val()){var b=new Object();
b.baseLte=c.find("input[name=baseLte]").val();b.baseMoney=c.find("input[name=baseMoney]").val();b.exceedType=c.find("select[name=exceedType]").val();b.exceedOne=c.find("input[name=exceedOne]").val();
b.exceedSo=c.find("input[name=exceedSo]").val();b.packageLte=c.find("input[name=packageLte]").val();b.packageOne=c.find("input[name=packageOne]").val();
b.packageExceedType=c.find("select[name=packageExceedType]").val();b.packageExceedFix=c.find("input[name=packageExceedFix]").val();b.packageExceedOne=c.find("input[name=packageExceedOne]").val();
b.packageExceedSo=c.find("input[name=packageExceedSo]").val();a.push(b);}return a;},_getShipFeeFormulas:function(a){var c=a.attr("id");var b=[];a.find(".shipPrWeightDiv").each(function(){var d=new Object();
d.type="ship";d.startPid=a.find("select[name=shipStartPid]").val();d.baseWeight=a.find("input[name=baseWeight]").val();d.toPid=$(this).find("input[name=toPid]").attr("prIdVal");
d.basePrice=$(this).find("input[name=basePrice]").val();d.additionalPrice=$(this).find("input[name=additionalPrice]").val();b.push(d);});a.find(".returnPrWeightDiv").each(function(){var d=new Object();
d.type="return";d.toPid=a.find("select[name=returnToPid]").val();d.baseWeight=a.find("input[name=baseWeight]").val();d.startPid=$(this).find("input[name=startPid]").attr("prIdVal");
d.basePrice=$(this).find("input[name=basePrice]").val();d.additionalPrice=$(this).find("input[name=additionalPrice]").val();b.push(d);});return b;},_getShipFeeServices:function(b){var a=[];
if(b.find("input[name=desc]").val()){b.find(".feeServiceMoneyRange").each(function(){var c=new Object();c.desc=b.find("input[name=desc]").val();c.moenyGt=$(this).find("input[name=moenyGt]").val();
c.moneyLte=$(this).find("input[name=moneyLte]").val()?$(this).find("input[name=moneyLte]").val():"";c.serviceTypes=$(this).find("select[name=serviceTypes]").val();
c.servicePercent=$(this).find("input[name=servicePercent]").val();c.serviceMoney=$(this).find("input[name=serviceMoney]").val();a.push(c);});}return a;
},_getShipPo:function(b){var a=new Object();var c=b.attr("id");a.id=c;if(b.find("input[name=feeService]").is(":checked")){a.feeService="y";}else{a.feeService="n";
}if(b.find("input[name=feeStock]").is(":checked")){a.feeStock="y";}else{a.feeStock="n";}if(b.find("input[name=feePackage]").is(":checked")){a.feePackage="y";
}else{a.feePackage="n";}if(b.find("input[name=feeShip]").is(":checked")){a.feeShip="y";}else{a.feeShip="n";}if(b.find("input[name=feeReturn]").is(":checked")){a.feeReturn="y";
}else{a.feeReturn="n";}if(a.feeReturn=="n"&&a.feeShip=="n"&&a.feePackage=="n"&&a.feeStock=="n"&&a.feeService=="n"){a.feeSetting="n";}else{a.feeSetting="y";
}return a;},_initTable:function(){var a=this;FormUtils.loadData(FeeSeeting._CONS_.LIST_DATA_URL+"?Q__S__EQ__status_=actived&Q__S__EQ__fee_setting_=y",function(b){if(b&&b.length>0){var d=new StringBuffer();
d.append("<div class='tabs-container'>");d.append("<ul class='nav nav-tabs'>");d.append("</ul>");d.append("<div class='tab-content'>");d.append("</div>");
d.append("</div>");$(".feeSettingContent").append(d.toString());for(var c=0;c<b.length;c++){a.ids.push(b[c].id);a.loadFeeSetting(b[c],c);}a.initProSelect($(".shipPrContainer"),"shipToPid");
a.initProSelect($(".shipPrContainerStart"),"shipStartPid");a.initProSelect($(".returnPrContainerStart"),"returnStartPid");a.initProSelect($(".returnPrContainer"),"returnToPid");
}});},loadFeeSetting:function(g,f){var c=this;var b=new StringBuffer();b.append("<li idVal='"+g.id+"' class='tabLi");if(f==0){b.append(" active");}b.append("'>");
b.append("<a href='#"+g.id+"' data-toggle='tab'>"+g.name+"</a>");b.append("</li>");$(".feeSettingContent").find(".nav-tabs").append(b.toString());var h=new StringBuffer();
h.append("<div id='"+g.id+"' class='tab-pane fade in");if(f==0){h.append(" active");}h.append("'>");h.append("<div class='form-group'>");h.append("<div class='col-sm-2' style='text-align:center;'>");
h.append("<div class='checkbox checkbox-success checkbox-inline'>");h.append("<input type='checkbox' class='feeSetting' name='feeService'");if("y"==g.feeService){h.append(" value='y'");
h.append(" checked");}else{h.append(" value='n'");}h.append(">");h.append("<label for='feeService'>服务费</label>");h.append("</div>");h.append("</div>");
h.append("<div class='col-sm-2' style='text-align:center;'>");h.append("<div class='checkbox checkbox-success checkbox-inline'>");h.append("<input type='checkbox' class='feeSetting' name='feeStock'");
if("y"==g.feeStock){h.append(" value='y'");h.append(" checked");}else{h.append(" value='n'");}h.append(">");h.append("<label for='feeStock'>仓储费</label>");
h.append("</div>");h.append("</div>");h.append("<div class='col-sm-2' style='text-align:center;'>");h.append("<div class='checkbox checkbox-success checkbox-inline'>");
h.append("<input type='checkbox' class='feeSetting' name='feePackage'");if("y"==g.feePackage){h.append(" value='y'");h.append(" checked");}else{h.append(" value='n'");
}h.append(">");h.append("<label for='feePackage'>打包费</label>");h.append("</div>");h.append("</div>");h.append("<div class='col-sm-2' style='text-align:center;'>");
h.append("<div class='checkbox checkbox-success checkbox-inline'>");h.append("<input type='checkbox' class='feeSetting' name='feeShip'");if("y"==g.feeShip){h.append(" value='y'");
h.append(" checked");}else{h.append(" value='n'");}h.append(">");h.append("<label for='feeShip'>发货运费</label>");h.append("</div>");h.append("</div>");h.append("<div class='col-sm-2' style='text-align:center;'>");
h.append("<div class='checkbox checkbox-success checkbox-inline'>");h.append("<input type='checkbox' class='feeSetting' name='feeReturn'");if("y"==g.feeReturn){h.append(" value='y'");
h.append(" checked");}else{h.append(" value='n'");}h.append(">");h.append("<label for='feeReturn'>退货运费</label>");h.append("</div>");h.append("</div>");
h.append("</div>");h.append("<table class='table table-striped table-bordered '>");h.append("<thead>");h.append("<tr>");h.append("<td style='width: 30%;border-right: 2px solid rgb(242, 242, 242);'>类型</td>");
h.append("<td style='width: 70%;'>设置</td>");h.append("</tr>");h.append("</thead>");h.append("<tbody id='feeSettingTbody'>");if("y"==g.feeService){if(g.shipFeeServicePos&&g.shipFeeServicePos.length>0){h.append("<tr class='feeServiceTr'>");
h.append("<td>服务费</td>");h.append("<td>");h.append("<div class='row'>");h.append("<label class='col-sm-2 control-label'>规则说明<span style='color:red;'>*</span></label>");
h.append("<div class='col-sm-8'>");h.append("<input type='text' class='form-control' name='desc' value='"+g.shipFeeServicePos[0].desc+"' style='margin-bottom:2px;'>");
h.append("</div>");h.append("</div>");for(var e=0;e<g.shipFeeServicePos.length;e++){h.append("<div class='row feeServiceMoneyRange'>");h.append("<label class='col-sm-2 control-label'>金额范围</label>");
h.append("<div class='col-sm-3'>");h.append("<div class='input-daterange input-group no'>");h.append("<input type='text' name='moenyGt' value='"+g.shipFeeServicePos[e].moenyGt+"' class='form-control'>");
h.append("<span class='input-group-addon'>到</span>");h.append("<input type='text' name='moneyLte' value='"+(g.shipFeeServicePos[e].moneyLte==0?"":g.shipFeeServicePos[e].moneyLte)+"' class='form-control'>");
h.append("</div>");h.append("</div>");h.append("<label class='col-sm-1 control-label'>收费</label>");h.append("<div class='col-sm-2'>");h.append("<select class='form-control' name='serviceTypes' value='"+g.shipFeeServicePos[e].serviceTypes+"' >");
if("money"==g.shipFeeServicePos[e].serviceTypes){h.append("<option value='money' selected='selected'>固定金额</option>");h.append("<option value='percent'>百分比</option>");
}else{h.append("<option value='money'>固定金额</option>");h.append("<option value='percent' selected='selected'>百分比</option>");}h.append("</select>");h.append("</div>");
h.append("<div class='col-sm-2'>");if("money"==g.shipFeeServicePos[e].serviceTypes){h.append("<input type='text' class='form-control' name='serviceMoney' value='"+g.shipFeeServicePos[e].serviceMoney+"' style='width:calc(100% - 50px);float: left;'>&nbsp;元");
}else{h.append("<input type='text' class='form-control' name='servicePercent' value='"+g.shipFeeServicePos[e].servicePercent+"' style='width:calc(100% - 50px);float: left;'>&nbsp;%");
}h.append("</div>");h.append("</div>");}h.append("</td>");h.append("</tr>");}else{c.buildFeeServiceTr(h);}}if("y"==g.feeStock){if(g.shipFeeStockPos&&g.shipFeeStockPos.length>0){h.append("<tr class='feeStockTr'>");
h.append("<td>仓储费</td>");h.append("<td>");h.append("<div class='row'>");h.append("<div class='col-sm-5'>");h.append("<input type='text' class='form-control' name='baseLte' value='"+g.shipFeeStockPos[0].baseLte+"' style='width:25%;float: left;'>");
h.append("<span style='float:left;'>&nbsp;件（含）内收取&nbsp;</span>");h.append("<input type='text' class='form-control' name='baseMoney' value='"+g.shipFeeStockPos[0].baseMoney+"' style='width:25%;float: left;'>");
h.append("<span style='float:left;width:10%;'>元</span>");h.append("</div>");h.append("<div class='col-sm-6'>");h.append("<span style='float:left;width:28%;'>超件后收费形式</span>");
h.append("<select class='form-control' name='exceedType' value='"+g.shipFeeStockPos[0].exceedType+"' style='float:left;width:30%;'>");if("one"==g.shipFeeStockPos[0].exceedType){h.append("<option value='one' selected='selected'>按件</option>");
h.append("<option value='so'>按订单</option>");}else{h.append("<option value='one'>按件</option>");h.append("<option value='so' selected='selected'>按订单</option>");
}h.append("</select>");if("one"==g.shipFeeStockPos[0].exceedType){h.append("<div>");h.append("<span style='float:left;'>&nbsp;每件收&nbsp;</span>");h.append("<input type='text' class='form-control' name='exceedOne' value='"+g.shipFeeStockPos[0].exceedOne+"' style='width:15%;float: left;'>");
h.append("<span style='float:left;width:5%;'>元</span>");h.append("</div>");}else{h.append("<div>");h.append("<span style='float:left;'>&nbsp;每单收&nbsp;</span>");
h.append("<input type='text' class='form-control' name='exceedSo' value='"+g.shipFeeStockPos[0].exceedSo+"' style='width:15%;float: left;'>");h.append("<span style='float:left;width:5%;'>元</span>");
h.append("</div>");}h.append("</div>");h.append("</div>");h.append("</td>");h.append("</tr>");}else{c.buildFeeStockTr(h);}}if("y"==g.feePackage){if(g.shipFeeStockPos&&g.shipFeeStockPos.length>0){h.append("<tr  class='feePackageTr'>");
h.append("<td>打包费</td>");h.append("<td>");h.append("<div class='row'>");h.append("<div class='col-sm-5'>");h.append("<input type='text' class='form-control' name='packageLte' value='"+g.shipFeeStockPos[0].packageLte+"' style='width:25%;float: left;'>");
h.append("<span style='float:left;'>&nbsp;件（含）内收取&nbsp;</span>");h.append("<input type='text' class='form-control' name='packageOne' value='"+g.shipFeeStockPos[0].packageOne+"' style='width:25%;float: left;'>");
h.append("<span style='float:left;width:10%;'>元</span>");h.append("</div>");h.append("<div class='col-sm-6'>");h.append("<span style='float:left;width:28%;'>超件后收费形式</span>");
h.append("<select class='form-control' name='packageExceedType' value='"+g.shipFeeStockPos[0].packageExceedType+"' style='float:left;width:30%;'>");if("fix"==g.shipFeeStockPos[0].packageExceedType){h.append("<option value='fix' selected='selected'>固定金额</option>");
h.append("<option value='one'>按件</option>");h.append("<option value='so'>按订单</option>");}else{if("one"==g.shipFeeStockPos[0].packageExceedType){h.append("<option value='fix'>固定金额</option>");
h.append("<option value='one' selected='selected'>按件</option>");h.append("<option value='so'>按订单</option>");}else{h.append("<option value='fix'>固定金额</option>");
h.append("<option value='one'>按件</option>");h.append("<option value='so' selected='selected'>按订单</option>");}}h.append("</select>");if("fix"==g.shipFeeStockPos[0].packageExceedType){h.append("<div>");
h.append("<span style='float:left;'>&nbsp;收&nbsp;</span>");h.append("<input type='text' class='form-control' name='packageExceedFix' value='"+g.shipFeeStockPos[0].packageExceedFix+"' style='float:left;width:15%;'>");
h.append("<span style='float:left;width:5%;'>元</span>	");h.append("</div>");}else{if("fix"==g.shipFeeStockPos[0].packageExceedType){h.append("<div>");h.append("<span style='float:left;'>&nbsp;每单收&nbsp;</span>");
h.append("<input type='text' class='form-control' name='packageExceedSo' value='"+g.shipFeeStockPos[0].packageExceedSo+"'  style='width:15%;float: left;'>");
h.append("<span style='float:left;width:5%;'>元</span>");h.append("</div>");}else{h.append("<div>");h.append("<span style='float:left;'>&nbsp;每件收&nbsp;</span>");
h.append("<input type='text' class='form-control' name='packageExceedOne' value='"+g.shipFeeStockPos[0].packageExceedOne+"' style='width:15%;float: left;'>");
h.append("<span style='float:left;width:5%;'>元</span>");h.append("</div>");}}h.append("</div>");h.append("</div>");h.append("</td>");h.append("</tr>");
}else{c.buildFeePackageTr(h);}}if("y"==g.feeShip){if(g.shipFeeFormulaPos&&g.shipFeeFormulaPos.length>0){for(var e=0;e<g.shipFeeFormulaPos.length;e++){h.append("<tr class='feeShipTr'>");
h.append("<td>发货运费</td>");h.append("<td>");h.append("<div class='row' style='margin-bottom:2px;'>");h.append("<div class='col-sm-4'>");h.append("<span style='float:left;'>首重重量（KG千克）</span>");
h.append("<input type='text' class='form-control' name='baseWeight' value='"+g.shipFeeFormulaPos[e].baseWeight+"' style='width:20%;float: left;'>");h.append("</div>");
h.append("</div>");h.append("<div class='row' style='margin-bottom:2px;'>");h.append("<div class='col-sm-4 shipPrContainerStart' prVal='"+g.shipFeeFormulaPos[e].startPid+"'>");
h.append("<span style='float:left;'>发货出发地省份</span>");h.append("</div>");h.append("</div>");h.append("<div class='row' style='margin-bottom:2px;'>");h.append("<div class='col-sm-4 shipPrContainer'>");
h.append("<span style='float:left;'>发货目的地省份</span>");h.append("&nbsp;<button type='button' class='jt-btn shipAddToPid'><i class='fa fa-plus'>&nbsp;添加</i></button>");
h.append("</div>");h.append("<div class='col-sm-1'>");h.append("<i style='font-size: 23px;' class='prDoubleDown fa fa-angle-double-down'></i>");h.append("<i style='font-size: 23px;display:none;' class='prDoubleUp fa fa-angle-double-up'></i>");
h.append("</div>");h.append("</div>");h.append("<div class='row shipPrWeight' style='display:none;'>");for(var a=0;a<g.shipFeeFormulaPos.length;a++){h.append("<div class='col-sm-4 shipPrWeightDiv' style='padding-top:3px;'>");
h.append("<input type='text' class='form-control' name='toPid' value='"+g.shipFeeFormulaPos[a].toName+"' prIdVal='"+g.shipFeeFormulaPos[a].toPid+"' style='float:left;width:25%;' readonly='true'><span style='float:left;'>&nbsp;</span>");
h.append("<input type='text' class='form-control' name='basePrice' value='"+g.shipFeeFormulaPos[a].basePrice+"' style='float:left;width:20%;' placeholder='首重单价'><span style='float:left;'>&nbsp;</span>");
h.append("<input type='text' class='form-control' name='additionalPrice' value='"+g.shipFeeFormulaPos[a].additionalPrice+"' style='float:left;width:20%;' placeholder='续重单价'>");
h.append("&nbsp;<button type='button' class='btn btn-xs btn-primary weightDivMinus'><i class='fa fa-minus'></i></button>");h.append("</div>");}h.append("</div>");
h.append("</td>");h.append("</tr>");break;}}else{c.buildFeeShipTr(h);}}if("y"==g.feeReturn){if(g.shipFeeFormulaReturnPos&&g.shipFeeFormulaReturnPos.length>0){for(var e=0;
e<g.shipFeeFormulaReturnPos.length;e++){h.append("<tr class='feeReturnTr'>");h.append("<td>退货运费</td>");h.append("<td>");h.append("<div class='row'>");h.append("<div class='col-sm-4' style='margin-bottom:2px;'>");
h.append("<span style='float:left;'>首重重量（KG千克）</span>");h.append("<input type='text' class='form-control' name='baseWeight' value='"+g.shipFeeFormulaReturnPos[e].baseWeight+"' style='width:20%;float: left;'>");
h.append("</div>");h.append("</div>");h.append("<div class='row' style='margin-bottom:2px;'>");h.append("<div class='col-sm-4 returnPrContainer' prVal='"+g.shipFeeFormulaReturnPos[e].toPid+"' >");
h.append("<span style='float:left;'>退货目的地省份</span>");h.append("</div>");h.append("</div>");h.append("<div class='row' style='margin-bottom:2px;'>");h.append("<div class='col-sm-4 returnPrContainerStart'>");
h.append("<span style='float:left;'>退货出发地省份</span>");h.append("&nbsp;<button type='button' class='jt-btn returnAddToPid'><i class='fa fa-plus'>&nbsp;添加</i></button>");
h.append("</div>");h.append("<div class='col-sm-1'>");h.append("<i style='font-size: 23px;' class='prDoubleDown fa fa-angle-double-down'></i>");h.append("<i style='font-size: 23px;display:none;' class='prDoubleUp fa fa-angle-double-up'></i>");
h.append("</div>");h.append("</div>");h.append("<div class='row returnPrWeight' style='display:none;'>");for(var d=0;d<g.shipFeeFormulaReturnPos.length;
d++){h.append("<div class='col-sm-4 returnPrWeightDiv' style='padding-top:3px;'>");h.append("<input type='text' class='form-control' name='startPid' value='"+g.shipFeeFormulaReturnPos[d].toName+"' prIdVal='"+g.shipFeeFormulaReturnPos[d].startPid+"' style='float:left;width:25%;' readonly='true'><span style='float:left;'>&nbsp;</span>");
h.append("<input type='text' class='form-control' name='basePrice' value='"+g.shipFeeFormulaReturnPos[d].basePrice+"' style='float:left;width:20%;' placeholder='首重单价'><span style='float:left;'>&nbsp;</span>");
h.append("<input type='text' class='form-control' name='additionalPrice' value='"+g.shipFeeFormulaReturnPos[d].additionalPrice+"' style='float:left;width:20%;' placeholder='续重单价'>");
h.append("&nbsp;<button type='button' class='btn btn-xs btn-primary weightDivMinus'><i class='fa fa-minus'></i></button>");h.append("</div>");}h.append("</div>");
h.append("</td>");h.append("</tr>");break;}}else{c.buildFeeReturnTr(h);}}h.append("</tbody>");h.append("</div>");h.append("</div>");$(".feeSettingContent").find(".tab-content").append(h.toString());
},buildFeeServiceTr:function(a){a.append("<tr class='feeServiceTr'>");a.append("<td>服务费</td>");a.append("<td>");a.append("<div class='row'>");a.append("<label class='col-sm-2 control-label'>规则说明<span style='color:red;'>*</span></label>");
a.append("<div class='col-sm-8'>");a.append("<input type='text' class='form-control' name='desc' style='margin-bottom:2px;'>");a.append("</div>");a.append("</div>");
a.append("<div class='row feeServiceMoneyRange'>");a.append("<label class='col-sm-2 control-label'>金额范围</label>");a.append("<div class='col-sm-3'>");a.append("<div class='input-daterange input-group no'>");
a.append("<input type='text' name='moenyGt' class='form-control'>");a.append("<span class='input-group-addon'>到</span>");a.append("<input type='text' name='moneyLte' class='form-control'>");
a.append("</div>");a.append("</div>");a.append("<label class='col-sm-1 control-label'>收费</label>");a.append("<div class='col-sm-2'>");a.append("<select class='form-control' name='serviceTypes'>");
a.append("<option value='money'>固定金额</option>");a.append("<option value='percent'>百分比</option>");a.append("</select>");a.append("</div>");a.append("<div class='col-sm-2'>");
a.append("<input type='text' class='form-control' name='serviceMoney'style='width:calc(100% - 50px);float: left;'>&nbsp;元");a.append("</div>");a.append("</div>");
a.append("<div class='row feeServiceMoneyRange'>");a.append("<label class='col-sm-2 control-label'>金额范围</label>");a.append("<div class='col-sm-3'>");a.append("<div class='input-daterange input-group no'>");
a.append("<input type='text' name='moenyGt' class='form-control'>");a.append("<span class='input-group-addon'>到</span>");a.append("<input type='text' name='moneyLte' class='form-control'>");
a.append("</div>");a.append("</div>");a.append("<label class='col-sm-1 control-label'>收费</label>");a.append("<div class='col-sm-2'>");a.append("<select class='form-control' name='serviceTypes'>");
a.append("<option value='money'>固定金额</option>");a.append("<option value='percent'>百分比</option>");a.append("</select>");a.append("</div>");a.append("<div class='col-sm-2'>");
a.append("<input type='text' class='form-control' name='serviceMoney' style='width:calc(100% - 50px);float: left;'>&nbsp;元");a.append("</div>");a.append("</div>");
a.append("</td>");a.append("</tr>");},buildFeeStockTr:function(a){a.append("<tr class='feeStockTr'>");a.append("<td>仓储费</td>");a.append("<td>");a.append("<div class='row'>");
a.append("<div class='col-sm-5'>");a.append("<input type='text' class='form-control' name='baseLte' style='width:25%;float: left;'>");a.append("<span style='float:left;'>&nbsp;件（含）内收取&nbsp;</span>");
a.append("<input type='text' class='form-control' name='baseMoney' style='width:25%;float: left;'>");a.append("<span style='float:left;width:10%;'>元</span>");
a.append("</div>");a.append("<div class='col-sm-6'>");a.append("<span style='float:left;width:28%;'>超件后收费形式</span>");a.append("<select class='form-control' name='exceedType' style='float:left;width:30%;'>");
a.append("<option value='one'>按件</option>");a.append("<option value='so'>按订单</option>");a.append("</select>");a.append("<div>");a.append("<span style='float:left;'>&nbsp;每件收&nbsp;</span>");
a.append("<input type='text' class='form-control' name='exceedOne' style='width:15%;float: left;'>");a.append("<span style='float:left;width:5%;'>元</span>");
a.append("</div>");a.append("</div>");a.append("</div>");a.append("</td>");a.append("</tr>");},buildFeePackageTr:function(a){a.append("<tr class='feePackageTr'>");
a.append("<td>打包费</td>");a.append("<td>");a.append("<div class='row'>");a.append("<div class='col-sm-5'>");a.append("<input type='text' class='form-control' name='packageLte' style='width:25%;float: left;'>");
a.append("<span style='float:left;'>&nbsp;件（含）内收取&nbsp;</span>");a.append("<input type='text' class='form-control' name='packageOne' style='width:25%;float: left;'>");
a.append("<span style='float:left;width:10%;'>元</span>");a.append("</div>");a.append("<div class='col-sm-6'>");a.append("<span style='float:left;width:28%;'>超件后收费形式</span>");
a.append("<select class='form-control' name='packageExceedType' style='float:left;width:30%;'>");a.append("<option value='fix'>固定金额</option>");a.append("<option value='one'>按件</option>");
a.append("<option value='so'>按订单</option>");a.append("</select>");a.append("<div>");a.append("<span style='float:left;'>&nbsp;收&nbsp;</span>");a.append("<input type='text' class='form-control' name='packageExceedFix' style='float:left;width:15%;'>");
a.append("<span style='float:left;width:5%;'>元</span>	");a.append("</div>");a.append("</div>");a.append("</div>");a.append("</td>");a.append("</tr>");},buildFeeShipTr:function(a){a.append("<tr class='feeShipTr'>");
a.append("<td>发货运费</td>");a.append("<td>");a.append("<div class='row' style='margin-bottom:2px;'>");a.append("<div class='col-sm-4'>");a.append("<span style='float:left;'>首重重量（KG千克）</span>");
a.append("<input type='text' class='form-control' name='baseWeight' style='width:20%;float: left;'>");a.append("</div>");a.append("</div>");a.append("<div class='row' style='margin-bottom:2px;'>");
a.append("<div class='col-sm-4 shipPrContainerStart'>");a.append("<span style='float:left;'>发货出发地省份</span>");a.append("</div>");a.append("</div>");a.append("<div class='row' style='margin-bottom:2px;'>");
a.append("<div class='col-sm-4 shipPrContainer'>");a.append("<span style='float:left;'>发货目的地省份</span>");a.append("&nbsp;<button type='button' class='jt-btn shipAddToPid'><i class='fa fa-plus'>&nbsp;添加</i></button>");
a.append("</div>");a.append("</div>");a.append("<div class='row shipPrWeight'>");a.append("</div>");a.append("</td>");a.append("</tr>");},buildFeeReturnTr:function(a){a.append("<tr class='feeReturnTr'>");
a.append("<td>退货运费</td>");a.append("<td>");a.append("<div class='row'>");a.append("<div class='col-sm-4' style='margin-bottom:2px;'>");a.append("<span style='float:left;'>首重重量（KG千克）</span>");
a.append("<input type='text' class='form-control' name='baseWeight' style='width:20%;float: left;'>");a.append("</div>");a.append("</div>");a.append("<div class='row' style='margin-bottom:2px;'>");
a.append("<div class='col-sm-4 returnPrContainer'>");a.append("<span style='float:left;'>退货目的地省份</span>");a.append("</div>");a.append("</div>");a.append("<div class='row' style='margin-bottom:2px;'>");
a.append("<div class='col-sm-4 returnPrContainerStart'>");a.append("<span style='float:left;'>退货出发地省份</span>");a.append("&nbsp;<button type='button' class='jt-btn returnAddToPid'><i class='fa fa-plus'>&nbsp;添加</i></button>");
a.append("</div>");a.append("</div>");a.append("<div class='row returnPrWeight'>");a.append("</div>");a.append("</td>");a.append("</tr>");},buildFeeSetting:function(c,e){var b=this;
if($(".tabs-container").length<=0){var d=new StringBuffer();d.append("<div class='tabs-container'>");d.append("<ul class='nav nav-tabs'>");d.append("</ul>");
d.append("<div class='tab-content'>");d.append("</div>");d.append("</div>");$(".feeSettingContent").append(d.toString());}var a=new StringBuffer();a.append("<li idVal='"+e+"' class='tabLi");
a.append(" active");a.append("'>");a.append("<a href='#"+e+"' data-toggle='tab'>"+c+"</a>");a.append("</li>");$(".feeSettingContent").find(".nav-tabs").append(a.toString());
var d=new StringBuffer();d.append("<div id='"+e+"' class='tab-pane fade in");d.append(" active");d.append("'>");d.append("<div class='form-group'>");d.append("<div class='col-sm-2' style='text-align:center;'>");
d.append("<div class='checkbox checkbox-success checkbox-inline'>");d.append("<input type='checkbox' class='feeSetting' name='feeService' value='y' checked>");
d.append("<label for='feeService'>服务费</label>");d.append("</div>");d.append("</div>");d.append("<div class='col-sm-2' style='text-align:center;'>");d.append("<div class='checkbox checkbox-success checkbox-inline'>");
d.append("<input type='checkbox' class='feeSetting' name='feeStock' value='y' checked>");d.append("<label for='feeStock'>仓储费</label>");d.append("</div>");
d.append("</div>");d.append("<div class='col-sm-2' style='text-align:center;'>");d.append("<div class='checkbox checkbox-success checkbox-inline'>");d.append("<input type='checkbox' class='feeSetting' name='feePackage' value='y' checked>");
d.append("<label for='feePackage'>打包费</label>");d.append("</div>");d.append("</div>");d.append("<div class='col-sm-2' style='text-align:center;'>");d.append("<div class='checkbox checkbox-success checkbox-inline'>");
d.append("<input type='checkbox' class='feeSetting' name='feeShip' value='y' checked>");d.append("<label for='feeShip'>发货运费</label>");d.append("</div>");
d.append("</div>");d.append("<div class='col-sm-2' style='text-align:center;'>");d.append("<div class='checkbox checkbox-success checkbox-inline'>");d.append("<input type='checkbox' class='feeSetting' name='feeReturn' value='y' checked>");
d.append("<label for='feeReturn'>退货运费</label>");d.append("</div>");d.append("</div>");d.append("</div>");d.append("<table class='table table-striped table-bordered '>");
d.append("<thead>");d.append("<tr>");d.append("<td style='width: 30%;border-right: 2px solid rgb(242, 242, 242);'>类型</td>");d.append("<td style='width: 70%;'>设置</td>");
d.append("</tr>");d.append("</thead>");d.append("<tbody id='feeSettingTbody'>");b.buildFeeServiceTr(d);b.buildFeeStockTr(d);b.buildFeePackageTr(d);b.buildFeeShipTr(d);
b.buildFeeReturnTr(d);d.append("</tbody>");d.append("</div>");d.append("</div>");$(".feeSettingContent").find(".tab-content").append(d.toString());}};