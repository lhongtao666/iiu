$(function(){function a(){this.hadInit=false;this.type=null;}a._CONS_={LIST_DATA_URL:ctx+"/ec/finance/financeBill/listData.htm",SO_DETAIL_URL:ctx+"/ec/salesorder/soEntity/detail.htm"};
a.prototype={init:function(d){if(!this.hadInit){this.hadInit=true;this.type=d.showType;this._bindEventHander();if(this.type=="receipt"){$(".titleName").html("公司账户收入明细");
}else{$(".titleName").html("公司账户支出明细");}this._initTable(d);}},_bindEventHander:function(){var d=this;$(document).on("click",".soTab",function(){var e=$(this).attr("value");
JTTabUtils.addOrRefreshTab(a._CONS_.SO_DETAIL_URL+"?soNo="+e,"订单["+showNo+"]明细");});$("body").on("click",".returnTab",function(){var e=$(this).attr("value");
if(e.length>4){var f="*"+e.substring(e.length-3,e.length);}JTTabUtils.addOrRefreshTab(a._CONS_.RETURN_DETAIL_PAGE_URL+"?rno="+e,"退货单["+f+"]明细");});$("body").on("click",".changeTab",function(){var e=$(this).attr("value");
if(e.length>4){var f="*"+e.substring(e.length-3,e.length);}JTTabUtils.addOrRefreshTab(a._CONS_.CHANGE_DETAIL_PAGE_URL+"?eno="+e,"换货单["+f+"]明细");});},_initTable:function(f){var d=this;
var e=a._CONS_.LIST_DATA_URL+"?Q__S__EQ__bill.status_=done";if(f.showType!=null){e+="&Q__S__IN__bill.type_="+f.showType;}FormUtils.loadData(e,function(n){var m=n.rows;
if(m&&m.length){var o=new StringBuffer();for(var h=0;h<m.length;h++){if(h>10){o.append("<tr>");if(d.type=="receipt"){o.append("<td colspan='5' align='right'><span nameVal='收款单' urlVal='/ec/finance/financeBill/list.htm' style='text-decoration: underline;color: blue;cursor: pointer;' class='showMore'>查看更多</span></td>");
}else{o.append("<td colspan='5' align='right'><span nameVal='付款单' urlVal='/ec/finance/financeBill/list.htm' style='text-decoration: underline;color: blue;cursor: pointer;' class='showMore'>查看更多</span></td>");
}o.append("<tr>");break;}else{o.append("<tr>");var l=m[h].type=="receipt"?m[h].receiptAccount:m[h].payAccount;o.append("<td>"+l+"</td>");var j="";if(m[h].type=="receipt"){j="<span>收款单</span>";
}else{if(m[h].type=="pay"){j="<span>付款单</span>";}else{if(m[h].type=="refund"){j="<span >退款单</span>";}}}o.append("<td>"+j+"</td>");var k="";if(m[h].entityType=="none"){k="<span>人工录入</span>";
}else{if(m[h].entityType=="salesorder"){k="<span>订单</span>";}else{if(m[h].entityType=="returnentity"){k="<span>退货单</span>";}else{if(m[h].entityType=="exchange"){k="<span>换货单</span>";
}else{if(m[h].entityType=="contract"){k="<span>合同</span>";}}}}}o.append("<td>"+k+"</td>");if(m[h].entityType=="salesorder"){var g=m[h].entityNo&&"<a href='#'  class='soTab' value='"+m[h].entityNo+"'>"+m[h].entityNo+"</a>";
}if(m[h].entityType=="returnentity"){var g=m[h].entityNo&&"<a href='#'  class='returnTab' value='"+m[h].entityNo+"'>"+m[h].entityNo+"</a>";}else{if(m[h].entityType=="exchange"){var g=m[h].entityNo&&"<a href='#'  class='changeTab' value='"+m[h].entityNo+"'>"+m[h].entityNo+"</a>";
}}o.append("<td>"+g+"</td>");o.append("<td>"+m[h].total+"</td>");o.append("</tr>");}}$("#comPaymentContainer").empty().append(o.toString());}});},};var c=null;
if($("input[name=hiddenType]").length>0){c=$("input[name=hiddenType]").val();}var b=new a();b.init({showType:c});});