$(function(){var a=new MediaPeriod();a.init();});function MediaPeriod(){this.hadInit=false;}MediaPeriod._CONS_={EDIT_URL:ctx+"/ec/media/mediaPeriod/edit.htm",DELETE_URL:ctx+"/ec/media/mediaPeriod/delete.htm",LIST_DATA_URL:ctx+"/ec/media/mediaPeriod/listDataTable.htm",BATCH_SAVE_URL:ctx+"/ec/media/mediaPeriod/batchAdd.htm",EXPORT_URL:ctx+"/ec/media/mediaPeriod/exportExcelNew.htm",EDIT_FORM_ID:"mediaPeriodForm",};
MediaPeriod.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindEventHander();this._hideNotGrantBtn();this._initChannelSelect();$("#periodDaySearch").val(DateUtils.format(new Date(),"yyyy-MM-dd"));
this._initTable($("#mediaPeriodSearchForm").serialize());if(type=="self"){$(".mediaPeriodAdd").hide();}else{$(".mediaPeriodAdd").show();}this._locateToGlHelp();
}},_locateToGlHelp:function(){if(type=="self"){glHelpUtil.init("glHelp.operations.mediaPeriod.self");}else{glHelpUtil.init("glHelp.operations.mediaPeriod");
}},_initBaseInfo:function(){var a=this;a._prodSearch();a._channelSearch();a._outPhoneSearch();this._bindFormValidation();$("#periodDaySearch").val(DateUtils.format(new Date(),"yyyy-MM-dd"));
},_channelSearch:function(c){$(".mediaPeriodTbody").children("tr:last-child").find(".searchChannel").bsSuggest("destroy");var a=this;var b=$(".mediaPeriodTbody").children("tr:last-child").find(".searchChannel").width()+"px";
$(".mediaPeriodTbody").children("tr:last-child").find(".searchChannel").bsSuggest({url:ctx+"/ec/media/mediaChannel/search.htm",effectiveFields:["name"],searchFields:["name"],effectiveFieldsAlias:{name:"渠道名称"},showBtn:false,idField:"id",keyField:"name",showBtn:false,twoWayMatch:false,ignorecase:true,allowNoKeyword:true,multiWord:false,autoSelect:false,delayUntilKeyup:false,getDataMethod:"firstByUrl",processData:function(d){a.searchChannels=d.value;
return d;},listStyle:{"padding-top":0,"max-height":"500px","max-width":b,"overflow":"auto","width":"auto","transition":"0.3s","-webkit-transition":"0.3s","-moz-transition":"0.3s","-o-transition":"0.3s"}}).on("onDataRequestSuccess",function(f,d){a.searchChannels=d.value;
}).on("onSetSelectValue",function(g,f){for(var d=0;d<a.searchChannels.length;d++){if(a.searchChannels[d].id==f.id){a.currentChannel=a.searchChannels[d];
break;}}$(this).prev().val(a.currentChannel.id);$(this).val(a.currentChannel.name);$(this).parent().parent().next().find("input[name=outPhone]").val(a.currentChannel.outPhone);
}).on("onUnsetSelectValue",function(d){a.currentChannel={};});},_outPhoneSearch:function(c){$(".mediaPeriodTbody").children("tr:last-child").find(".searchOutPhone").bsSuggest("destroy");
var a=this;var b=$(".mediaPeriodTbody").children("tr:last-child").find(".searchOutPhone").width()+"px";$(".mediaPeriodTbody").children("tr:last-child").find(".searchOutPhone").bsSuggest({url:ctx+"/ec/media/mediaChannel/searchOutPhone.htm",effectiveFields:["outPhone"],searchFields:["outPhone"],effectiveFieldsAlias:{outPhone:"400电话"},showBtn:false,idField:"id",keyField:"outPhone",showBtn:false,twoWayMatch:false,ignorecase:true,allowNoKeyword:true,multiWord:false,autoSelect:false,delayUntilKeyup:false,getDataMethod:"firstByUrl",processData:function(d){a.searchOutPhones=d.value;
return d;},listStyle:{"padding-top":0,"max-height":"500px","max-width":b,"overflow":"auto","width":"auto","transition":"0.3s","-webkit-transition":"0.3s","-moz-transition":"0.3s","-o-transition":"0.3s"}}).on("onDataRequestSuccess",function(f,d){a.searchOutPhones=d.value;
}).on("onSetSelectValue",function(g,d){for(var f=0;f<a.searchOutPhones.length;f++){if(a.searchOutPhones[f].id==d.id){a.currentPhone=a.searchOutPhones[f];
break;}}$(this).val(a.currentPhone.outPhone);}).on("onUnsetSelectValue",function(d){a.currentPhone={};});},_prodSearch:function(e){$(".mediaPeriodTbody").children("tr:last-child").find(".searchProd").bsSuggest("destroy");
var a=this;var d=$(".mediaPeriodTbody").children("tr:last-child").find(".searchProd").width()+"px";var b="entity";var f="n";var c="n";$(".mediaPeriodTbody").children("tr:last-child").find(".searchProd").bsSuggest({url:ctx+"/ec/product/prodEntity/search.htm?prodType="+b+"&hasStock="+f+"&storeId="+"&limitProdCate="+c+"&keyword=",effectiveFields:["prodName"],searchFields:["prodName","skuCode"],effectiveFieldsAlias:{prodName:"产品名字"},showBtn:false,idField:"skuId",keyField:"skuCode",showBtn:false,twoWayMatch:false,ignorecase:true,allowNoKeyword:true,multiWord:false,autoSelect:false,delayUntilKeyup:false,getDataMethod:"firstByUrl",processData:function(g){a.searchProds=g.value;
return g;},listStyle:{"padding-top":0,"max-height":"500px","max-width":d,"overflow":"auto","width":"auto","transition":"0.3s","-webkit-transition":"0.3s","-moz-transition":"0.3s","-o-transition":"0.3s"}}).on("onDataRequestSuccess",function(h,g){a.searchProds=g.value;
}).on("onSetSelectValue",function(j,g){for(var h=0;h<a.searchProds.length;h++){if(a.searchProds[h].skuId==g.id){a.currentProd=a.searchProds[h];break;}}$(this).val(a.currentProd.prodName);
}).on("onUnsetSelectValue",function(g){a.currentProd={};});},_hideNotGrantBtn:function(){if(!ResUtils.canShow("mediaPeriod.button.exportExcel")){$(".mediaPeriodExportExcel").hide();
}if(!ResUtils.canShow("mediaPeriod.button.add")){$(".mediaPeriodAdd").hide();}},_bindEventHander:function(){var a=this;$(".mediaPeriodSearch").on("click",function(){var b=a.toPostParam($("#mediaPeriodSearchForm").serialize());
a._initTable(b);});$("#mediaPeriodSearchForm").on("keypress",function(b){if(b.keyCode=="13"){$(".mediaPeriodSearch").trigger("click");}});$(document).on("click",".mediaPeriodAdd",function(){a._mediaPeriodAddTr();
$(".list_wrapper").hide();$(".form_wrapper").show();});$(document).on("keyup",".startTime",function(b){$(".startTime").each(function(c){var d=$(this).val();
if(96<=b.keyCode<=105&&b.keyCode!=8){if(d.length==2&&/^[0-9]*$/.test(d)){$(this).val(d+":");}}});});$(document).on("keyup",".endTime",function(b){$(".endTime").each(function(c){var d=$(this).val();
if(96<=b.keyCode<=105&&b.keyCode!=8){if(d.length==2&&/^[0-9]*$/.test(d)){$(this).val(d+":");}}});});$(document).on("click",".prevBtn",function(){$(".mediaPeriodTbody").empty();
$(".list_wrapper").show();$(".form_wrapper").hide();});$(document).on("click",".saveBtn",function(){a._saveAdd();});$(document).on("click",".mediaPeriodSubtract",function(){$(this).parents("tr").remove();
});$(document).on("click",".mediaPeriodEdit",function(){a.isEdit=true;var b=$(this).attr("idVal");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);
return;}a._edit(b);});$(document).on("click",".prevDay",function(){$("#periodDaySearch").val(DateUtils.getBeforeDate(1,$("#periodDaySearch").val()));});
$(document).on("click",".nextDay",function(){$("#periodDaySearch").val(DateUtils.getAfterDate(1,$("#periodDaySearch").val()));});$(document).on("click",".toDay",function(){$("#periodDaySearch").val(DateUtils.format(new Date(),"yyyy-MM-dd"));
});$(document).on("click",".mediaPeriodDelete",function(){var b=$(this).attr("idVal");DialogUtils.confirmWithOptions({title:"是否删除该推广计划，删除后无法回复?",text:"",confirmButtonText:"确定",yesFunc:function(){a._delete(b);
}});});$(".mediaPeriodExportExcel").on("click",function(){var b=a.toPostParam($("#mediaPeriodSearchForm").serialize());FormUtils.submit(MediaPeriod._CONS_.EXPORT_URL,b,function(c){ButtonUtils.enableBtn("mediaPeriodExportExcel");
if(c.success){DialogUtils.success(msgCode.INFO,c.msg+"成功");}else{DialogUtils.error(msgCode.FAIL_MSG,c.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});});$(document).on("click",".simple-time-select",function(){var f=$(this).find("option:selected").val();var g=new StringBuffer();var c=DateUtils.format(new Date(),"yyyy-MM-dd");
var e=DateUtils.getAfterDate(6,c);$("#mediaPeriodDay").empty();if(f==0){$("#periodDays").css("width","20%");$("#columns").css("width","15%");g.append("<input  class='laydate-icon  form-control layer-date' validateType='default' name='beginDay' placeholder='yyyy-mm-dd' onclick='laydate({istime: false})' value='"+c+"'>");
}else{if(f==1){$("#periodDays").css("width","25%");$("#columns").css("width","10%");g.append("<input type='text' id='weeklyStart' style='width:95% ! important; border-radius: 5px !important;' class='laydate-icon  layer-date' validateType='default' name='beginDay' placeholder='yyyy-mm-dd' onclick='laydate({istime: false})' value='"+c+"' onChange=''>");
g.append("<span class='input-group-addon' style='text-align: center; padding: 6px 12px;color: inherit;border-radius: 1px;width:25px;background-color: #fff;font-size: 14px;'>到</span>");
g.append("<input type='text' id='weeklyEnd' style='width:95% ! important;border-radius: 5px !important;' class='laydate-icon  layer-date' validateType='default' name='endDay' placeholder='yyyy-mm-dd' onclick='laydate({istime: false})' value='"+e+"' onChange=''> ");
}else{if(f==2){$("#periodDays").css("width","25%");$("#columns").css("width","10%");g.append(a._bulidYear());var d=true;g.append(a._bulidMonth(d));}else{if(f==3){$("#periodDays").css("width","25%");
$("#columns").css("width","10%");var b=true;g.append(a._bulidYear(b));}}}}$("#mediaPeriodDay").append(g.toString());});$(document).on("change",".yearSearch",function(){$(".monthSearch").empty();
var c=$(this).find("option:selected").val();var e=new Date();var f=e.getFullYear();var d=false;var b=true;if(c==f){d=true;}$(".monthSearch").append(a._bulidMonth(d,b));
});},_bulidMonth:function(e,a){var b=this;var g=new StringBuffer();if(e){if(!a){g.append('<select name="monthSearch" style="width:48%;height:33px;" placeholder="" class="form-control monthSearch" validatetype="default">');
}var c=new Date();var f=c.getMonth()+1;for(var d=f;d<13;d++){g.append('<option value="'+d+'">'+d+"月</option>");}if(!a){g.append("</select>");}}else{for(var d=1;
d<13;d++){g.append('<option value="'+d+'">'+d+"月</option>");}}return g.toString();},_bulidYear:function(a){var b=this;var f=new StringBuffer();var c=new Date();
var e=c.getFullYear();if(a){f.append('<select name="yearSearch" style="width:95%;height:33px;"  placeholder="" class="form-control yearSearch" validatetype="default">');
}else{f.append('<select name="yearSearch" style="width:48%;height:33px;"  placeholder="" class="form-control yearSearch" validatetype="default">');}for(var d=0;
d<8;d++){f.append('<option value="'+e+'">'+e+"年</option>");e=e+1;}f.append("</select>");return f.toString();},_edit:function(b){var a=this;$(".list_wrapper").hide();
$(".form_wrapper").show();$(".mediaPeriodTbody").empty();FormUtils.loadData(MediaPeriod._CONS_.EDIT_URL+"?id="+b,function(c){a._mediaPeriodEditTr(c);});
},_delete:function(b){var a=this;FormUtils.del(MediaPeriod._CONS_.DELETE_URL,b,function(c){if(c.success){DialogUtils.success(msgCode.SUCCESS,c.msg);}else{DialogUtils.error(msgCode.SUCCESS,c.msg);
}$(".mediaPeriodSearch").trigger("click");});},_initChannelSelect:function(){var a=ctx+"/ec/media/mediaChannel/findActived.htm";var b=new StringBuffer();
b.append("<option value=''>请选择</option>");FormUtils.loadData(a,function(d){if(d&&d.length>0){for(var c=0;c<d.length;c++){b.append("<option value='"+d[c].id+"'>"+d[c].name+"</option>");
}}$("#channelSearch").empty().append(b.toString());$("#channelSearch").chosen("destroy");$("#channelSearch").chosen();});},_bindFormValidation:function(){jQuery.validator.addMethod("isDate",function(c,b){return this.optional(b)||/^(20|21|22|23|[0-1]{1}[0-9]{1}):[0-5]{1}[0-9]{1}$/.test(c);
},"格式必须是HH:mm");var a={rules:{day:{required:true},startTime:{required:true,isDate:true,},endTime:{required:true,isDate:true,},},};FormUtils.bindFormValidation("mediaPeriodForm",a);
},_saveAdd:function(){var b=this;if($("#"+MediaPeriod._CONS_.EDIT_FORM_ID).valid()){var a=b._getMediaPeriodJson();if(!a){DialogUtils.error("提示","渠道未填或时间错误");
return false;}FormUtils.submit(MediaPeriod._CONS_.BATCH_SAVE_URL,"mediaPeriodJson="+a,function(c){ButtonUtils.enableBtn("saveBtn");if(c.success){if(c.msgCode==actionCode.CREATE){DialogUtils.success(msgCode.INFO,msgCode.CREATE_MSG);
}else{DialogUtils.success(msgCode.INFO,msgCode.UPDATE_MSG);}$(".mediaPeriodTbody").empty();$(".list_wrapper").show();$(".form_wrapper").hide();$("#mediaPeriodTable").DataTable().ajax.reload();
}else{DialogUtils.error(msgCode.FAIL_MSG,c.msg);}},function(){ButtonUtils.enableBtn("saveBtn");DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}},_mediaPeriodAddTr:function(){var b=this;
var c=new StringBuffer();var a=DateUtils.format(new Date(),"yyyy-MM-dd");c.append("<tr class='mediaPeriodTr'>");c.append("<td>");c.append("<div class='input-group'>");
c.append("<input type='hidden' class='idVal'>");c.append("<input type='hidden' class='createTimeVal'>");c.append("<input type='hidden' class='searchChannelVal'>");
c.append("<input type='text' class='form-control searchChannel' name='channelId'>");c.append("<div class='input-group-btn'>");c.append("<button type='button' class='btn btn-white dropdown-toggle' data-toggle='dropdown'>");
c.append("<span class='caret'></span>");c.append("</button>");c.append("<ul class='dropdown-menu dropdown-menu-right' role='menu'></ul>");c.append("</div>");
c.append("</div>");c.append("</td>");c.append("<td>");c.append("<div class='input-group'>");c.append("<input type='text' class='form-control searchOutPhone' name='outPhone'>");
c.append("<div class='input-group-btn'>");c.append("<button type='button' class='btn btn-white dropdown-toggle' data-toggle='dropdown'>");c.append("<span class='caret'></span>");
c.append("</button>");c.append("<ul class='dropdown-menu dropdown-menu-right' role='menu'></ul>");c.append("</div>");c.append("</div>");c.append("</td>");
c.append("<td>");c.append("<div class='input-group'>");c.append("<input type='text' class='form-control searchProd' name='productName'>");c.append("<div class='input-group-btn'>");
c.append("<button type='button' class='btn btn-white dropdown-toggle' data-toggle='dropdown'>");c.append("<span class='caret'></span>");c.append("</button>");
c.append("<ul class='dropdown-menu dropdown-menu-right' role='menu'></ul>");c.append("</div>");c.append("</div>");c.append("</td>");c.append("<td>");c.append("<div class='input-group' style='text-align:center;width:98%'>");
c.append("<select class='simple-time-select'>");c.append("<option value='0'>按天</option><option value='1'>时间</option><option value='2'>按月</option><option value='3'>按年</option>");
c.append("</select>");c.append("<div id='mediaPeriodDay' style='border-collapse: separate;position: relative;display: table;' class='col-sm-9'>");c.append("<input class='laydate-icon  form-control layer-date' validateType='default' name='beginDay' placeholder='yyyy-mm-dd' onclick='laydate({istime: false})' value='"+a+"'>");
c.append("</div>");c.append("</div>");c.append("</td>");c.append("<td>");c.append("<div class='input-group'>");c.append("<input type='text' name='startTime' class='form-control startTime' placeholder='hh:mm' validateType='default'>");
c.append("<span class='input-group-addon'>到</span>");c.append("<input type='text' name='endTime' class='form-control endTime' placeholder='hh:mm' validateType='default'>");
c.append("</div>");c.append("</td>");c.append("<td>");c.append("<input type='number' name='cost' class='form-control'>");c.append("</td>");c.append("</tr>");
$(".mediaPeriodTbody").append(c.toString());b._initBaseInfo();},_mediaPeriodEditTr:function(b){var a=this;var c=new StringBuffer();c.append("<tr class='mediaPeriodTr'>");
c.append("<td>");c.append("<div class='input-group'>");c.append("<input type='hidden' class='idVal' value='"+b.id+"'>");c.append("<input type='hidden' class='createTimeVal' value='"+b.createTime+"'>");
c.append("<input type='hidden' class='searchChannelVal' value='"+b.channelId+"'>");c.append("<input type='text' class='form-control searchChannel' validateType='default' name='channelId' value='"+b.channelName+"'>");
c.append("<div class='input-group-btn'>");c.append("<button type='button' class='btn btn-white dropdown-toggle' data-toggle='dropdown'>");c.append("<span class='caret'></span>");
c.append("</button>");c.append("<ul class='dropdown-menu dropdown-menu-right' role='menu'></ul>");c.append("</div>");c.append("</div>");c.append("</td>");
c.append("<td>");c.append("<div class='input-group'>");c.append("<input type='text' class='form-control searchOutPhone' name='outPhone' value='"+b.outPhone+"'>");
c.append("<div class='input-group-btn'>");c.append("<button type='button' class='btn btn-white dropdown-toggle' data-toggle='dropdown'>");c.append("<span class='caret'></span>");
c.append("</button>");c.append("<ul class='dropdown-menu dropdown-menu-right' role='menu'></ul>");c.append("</div>");c.append("</div>");c.append("</td>");
c.append("<td>");c.append("<div class='input-group'>");c.append("<input type='text' class='form-control searchProd' name='productName' value='"+b.productName+"'>");
c.append("<div class='input-group-btn'>");c.append("<button type='button' class='btn btn-white dropdown-toggle' data-toggle='dropdown'>");c.append("<span class='caret'></span>");
c.append("</button>");c.append("<ul class='dropdown-menu dropdown-menu-right' role='menu'></ul>");c.append("</div>");c.append("</div>");c.append("</td>");
c.append("<td>");c.append("<input class='laydate-icon form-control layer-date' validateType='default' name='beginDay' placeholder='yyyy-mm-dd' onclick='laydate({istime: false})' value='"+b.startTime.substring(0,10)+"'>");
c.append("</td>");c.append("<td>");c.append("<div class='input-group'>");c.append("<input type='text' name='startTime' class='form-control startTime' placeholder='hh:mm' validateType='default' value='"+b.startTime.substring(11,16)+"'>");
c.append("<span class='input-group-addon'>到</span>");c.append("<input type='text' name='endTime' class='form-control endTime' placeholder='hh:mm' validateType='default' value='"+b.endTime.substring(11,16)+"'>");
c.append("</div>");c.append("</td>");c.append("<td>");c.append("<input type='number' name='cost' class='form-control' value='"+b.cost+"'>");c.append("</td>");
c.append("</tr>");$(".mediaPeriodTbody").append(c.toString());a._initBaseInfo();},_initTable:function(d){var c="";if(ResUtils.canShow("mediaPeriod.button.edit")||ResUtils.canShow("mediaPeriod.button.delete")){c="<td style='width: 8%;'>操作</td>";
}var a=MediaPeriod._CONS_.LIST_DATA_URL+"?"+d;if("self"==type){a+="&Q__S__EQ__channel.mgr_="+currentUserId;}$(".mediaPeriodDiv").empty().append("<table class='table table-striped table-bordered' id='mediaPeriodTable' style='text-align:center;'>	            <thead>	                <tr>	                    <td style='width: 5%;'>序号</td>	                    <td style='width: 12%;'>渠道</td>	                    <td style='width: 10%;'>400号码</td>	                    <td style='width: 18%;'>推广人员</td>	                    <td style='width: 10%;'>产品意向</td>	                    <td style='width: 10%;'>推广天</td>	                    <td style='width: 17%;'>投放时段</td>	                    <td style='width: 10%;'>消费</td>	                    "+c+"	                    	                </tr>	            </thead>	        </table>");
var b=[{data:"lineNum"},{data:"channelName"},{data:"outPhone"},{data:"channelMgrName"},{data:"productName"},{data:"day",render:function(e,g,f){return f.day.substring(0,10);
}},{data:"startTime",render:function(g,f,e){return e.startTime.substring(11,16)+" - "+e.endTime.substring(11,16);}},{data:"cost"}];if(ResUtils.canShow("mediaPeriod.button.edit")||ResUtils.canShow("mediaPeriod.button.delete")){b.push({data:"id",render:function(g,f,e){var h=new StringBuffer();
if(ResUtils.canShow("mediaPeriod.button.edit")){h.append("<button class='jt-btn-opt mediaPeriodEdit' idVal='"+e.id+"' type='button'>编辑</button>");}if(ResUtils.canShow("mediaPeriod.button.delete")){h.append("<button class='jt-btn-error mediaPeriodDelete' idVal='"+e.id+"' type='button'>删除</button>");
}return h.toString();}});}$("#mediaPeriodTable").DataTable({ajax:{url:a,type:"POST"},columns:b,rowId:"id",lengthMenu:[[20],],searching:false,paging:true,pagingType:"simple",lengthChange:false,autoWidth:false,ordering:false});
},_getMediaPeriodJson:function(){var b=true;var a=new StringBuffer();a.append("[");$(".mediaPeriodTbody").find(".mediaPeriodTr").each(function(){var B=$(this).find(".simple-time-select").find("option:selected").val();
var m=0;var w=$(this).find("input[name=beginDay]").eq(0).val();var z=new Date();var k=z.getFullYear();var s=z.getMonth()+1;if(B==1){var e=$(this).find("input[name=endDay]").eq(0).val();
if(w&&e){m=DateUtils.getDateDiff(w,e,"day");}}else{if(B==2){var l=$(".yearSearch").find("option:selected").val();var t=$(".monthSearch").find("option:selected").val();
if(k==l&&s==t){var j=DateUtils.format(z,"yyyy-MM-dd");w=j;var q=DateUtils.getCurrentMonthLast();m=DateUtils.getDateDiff(j,q,"day")+1;}else{var j=DateUtils.getMonthFirst(l,t);
j=DateUtils.format(j,"yyyy-MM-dd");w=j;var q=DateUtils.getMonthLast(l,t);m=DateUtils.getDateDiff(j,q,"day");}}else{if(B==3){var l=$(".yearSearch").find("option:selected").val();
w=DateUtils.format(DateUtils.getYearFirst(l),"yyyy-MM-dd");if(k==l){var j=DateUtils.format(z,"yyyy-MM-dd");w=j;var q=DateUtils.getYearLast(k);m=DateUtils.getDateDiff(j,q,"day");
}else{if(l%4==0&&(l%100!=0||l%400==0)){m=365;}else{m=364;}}}}}var o=$(this).find(".idVal").val();var p=$(this).find(".createTimeVal").val();var d=$(this).find(".searchChannelVal").val();
var y=$(this).find("input[name=channelId]").eq(0).val();var h=$(this).find("input[name=productName]").eq(0).val();var v=w;var n=$(this).find("input[name=startTime]").eq(0).val();
var f=$(this).find("input[name=endTime]").eq(0).val();var x=$(this).find("input[name=cost]").eq(0).val();var r=$(this).find("input[name=outPhone]").eq(0).val();
if(!n){$(this).find("input[name=startTime]").addClass("validate_input_error");b=false;}if(!y){$(this).find("input[name=channelId]").addClass("validate_input_error");
b=false;}var A=n.split(":");var g=f.split(":");if(Number(A[0])>Number(g[0])){b=false;}else{if(Number(A[0])==Number(g[0])){if(Number(A[1])>Number(g[1])){b=false;
}}}for(var u=0;u<=m;u++){a.append("{");a.append('"id":"').append(o).append('",');a.append('"channelId":"').append(d).append('",');a.append('"productName":"').append(h).append('",');
a.append('"day":"').append(v).append('",');a.append('"startTime":"').append(n).append('",');a.append('"endTime":"').append(f).append('",');a.append('"cost":"').append(x).append('",');
a.append('"createTime":"').append(p).append('",');a.append('"outPhone":"').append(r).append('"');a.append("},");v=DateUtils.getAfterDate(1,v);}});var c=""+a;
if(c.length>1){c=c.substring(0,c.length-1);}c=c+"]";if(!b){return b;}return c;},toPostParam:function(b){var a=new StringBuffer();$("#channelSearch option:selected").each(function(c){a.append($(this).val());
if(c==$("#channelSearch option:selected").length-1){return false;}else{a.append(",");}});b=b+"&channelSearchs="+a.toString();return b;}};