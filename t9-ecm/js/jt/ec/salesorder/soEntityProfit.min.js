function SoEntityProfit(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;this.soEntityBase=new SoEntityBase();this.soItem=new SoItem();
this.soLog=new SoLog();this.soShip=new SoShip();this.soProfit=new SoProfit();}SoEntityProfit._CONS_={EDIT_URL:ctx+"/ec/salesorder/soEntity/edit.htm",EDIT_FORM_ID:"soEntityForm",GRID:"#soEntityProfitGrid",PAGER:"#soEntityProfitPager",};
SoEntityProfit.prototype={init:function(b){if(!this.hadInit){this.hadInit=true;this._bindEventHander();var a={};if(b.selectParams){a=b.selectParams;}this.soEntityBase.init({getManagerBtns:this.getManagerBtns,grid:SoEntityProfit._CONS_.GRID,pager:SoEntityProfit._CONS_.PAGER,gridRecordsSpan:b.gridRecordsSpan,listParams:"profitSearch=true"+b.searchParam,widthElement:".profit_wrapper",selectParams:a,onSelectRow:this.onSelectRow,canModifyProfit:b.canModifyProfit,canShowScTrankNo:b.canShowScTrankNo});
$(".profit_wrapper").find(".soEntityDetail").attr("disabled",true);this._hideNotGrantBtn();}else{$(".profit_wrapper").find(".soEntitySearch").trigger("click");
}},_hideNotGrantBtn:function(){if(!ResUtils.canShow("soEntity.button.detail")){$(".soEntityDetail").hide();}},clear:function(c){var a=this;function b(){a._showListWrapper();
a.isFormDataChange=false;a.isEdit=false;if(c){$(".profit_wrapper").find(".soEntitySearch").click();}}if(a.isEdit&&a.isFormDataChange){DialogUtils.warning(function(){b();
});}else{b();}},_showListWrapper:function(){$(".list_wrapper").show();$(".form_wrapper").hide();$(".pack_wrapper").hide();$(".soEndToolBtn").hide();$("select[name='soShipPos[0].scCode']").attr("disabled",true);
$("input[name='soShipPos[0].scTrackingNo']").attr("disabled",true);$("input[name='soShipPos[0].weight']").attr("disabled",true);$("input[name='soShipPos[0].actualAmount']").attr("disabled",true);
},_showFormWrapper:function(){$(".list_wrapper").hide();$(".form_wrapper").show();$(".soDeliverToolBtn").show();$(".deliverSoBtn").show();$(".pack_wrapper").hide();
},_showDetailFormWrapper:function(){$(".list_wrapper").hide();$(".form_wrapper").show();$(".soEndToolBtn").show();$(".pack_wrapper").hide();},_show:function(a){this._showFormWrapper();
this.edit=true;$("select[id=interests]").attr("disabled",true);this.soEntityBase.loadSoData(this,SoEntityBase._CONS_.EDIT_INFO_URL+"?id="+a,this.soEntityBase.loadSelfData,this._initBtn);
},_initBtn:function(a,b){},detail:function(a){var b=this._getSelId(a);if(b==null){return;}this._showDetailFormWrapper();$("select[id=interests]").attr("disabled",true);
this.soEntityBase.loadSoData(this,SoEntityBase._CONS_.EDIT_INFO_URL+"?id="+b,this.soEntityBase.loadSelfData,this._initBtn);},_getSelId:function(a){if(!a){a=$(SoEntityProfit._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(a==null||a.length==0){DialogUtils.error("提示","请选择要查看的订单");return null;}if(a.length>1){DialogUtils.error("提示","不能同时选择多个订单进行查看");return null;}}return a;
},_bindEventHander:function(){var a=this;$(".soEndToolBtn").on("click",".prevBtn",function(){a.clear(false);});},getManagerBtns:function(){var a=[];return a;
},onSelectRow:function(b,a){selectedId=$(SoEntityProfit._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(selectedId.length==1){$(".profit_wrapper").find(".soEntityDetail").attr("disabled",false);
}else{$(".profit_wrapper").find(".soEntityDetail").attr("disabled",true);}}};