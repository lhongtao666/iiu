$(function(){var a=new SoEntityQueryLogistics();a.init();});function SoEntityQueryLogistics(){}SoEntityQueryLogistics._CONS_={SHIP_INFO_QRY_URL:ctx+"/ec/salesorder/soEntity/logicsByNo.htm",};
SoEntityQueryLogistics.prototype={init:function(){this._bindEventHander();},_bindEventHander:function(){var a=this;$(document).on("click",".main-page .nav div.queryPlatform",function(){var b=$(this);
$(".main-page .nav div").removeClass("on");b.addClass("on");});$(".queryLogistics").off("click").on("click",function(){$(".queryLogistics").attr("disabled",true);
var b="kuaidiwo";if($(".main-page .nav div.on").hasClass("queryPlatform")){b=$(".main-page .nav div.on").attr("id");}if(b=="shunfengkuaidi"||b=="jdkuaidi"){b="kuaidiwo";
}FormUtils.submit(SoEntityQueryLogistics._CONS_.SHIP_INFO_QRY_URL,"id="+$("#shipInfoDiv").find("input[name=soId]").val()+"&shipType="+b,function(h){if(h.success){if(!h.msg){DialogUtils.success(msgCode.FAIL_MSG,"没有快递信息！");
}else{DialogUtils.success(msgCode.INFO,"查询成功");var g=$.parseJSON(h.msg);if(g.apiReturnData){var e="";var c=g.apiReturnData.split("<br>");for(var d=c.length-2;
d>=0;d--){var f=c[d].split("|");if(d==c.length-2){e+='<tr class="last">'+'<td class="row1">'+'<span class="day">'+f[0].substring(0,10)+"</span>"+'<span class="time">'+f[0].substring(10,16)+"</span>&nbsp;&nbsp;"+'<span class="week">'+f[0].substring(19,f[0].length)+"</span>"+"</td>"+'<td class="status status-wait">&nbsp;'+'<div class="col2">'+'<span class="step">'+'<span class="line1"></span>'+'<span class="line2"></span>'+"</span>"+"</div>"+"</td>"+'<td class="contex" t="">'+f[1]+"</td>"+"</tr>";
}else{if(d==0){e+="<tr >"+'<td class="row1">'+'<span class="day">'+f[0].substring(0,10)+"</span>"+'<span class="time">'+f[0].substring(10,16)+"</span>&nbsp;&nbsp;"+'<span class="week">'+f[0].substring(19,f[0].length)+"</span>"+"</td>"+'<td class="status status-first">&nbsp;'+"</td>"+'<td class="contex" t="">'+f[1]+"</td>"+"</tr>";
}else{e+="<tr >"+'<td class="row1">'+'<span class="day">'+f[0].substring(0,10)+"</span>"+'<span class="time">'+f[0].substring(10,16)+"</span>&nbsp;&nbsp;"+'<span class="week">'+f[0].substring(19,f[0].length)+"</span>"+"</td>"+'<td class="status ">&nbsp;'+'<div class="col2">'+'<span class="step">'+'<span class="line1"></span>'+'<span class="line2"></span>'+"</span>"+"</div>"+"</td>"+'<td class="contex" t="">'+f[1]+"</td>"+"</tr>";
}}}$(".time-axis").empty().append(e);}$("input[name=scNameShow]").val(g.scName);$("input[name=scTrackingNoShow]").val(g.scTrackingNo);$("#shipInfoDiv").show();
}}else{DialogUtils.error(msgCode.FAIL_MSG,h.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});$(".queryLogistics").attr("disabled",false);
});$(".shipQryBtn").off("click").on("click",function(){$(".shipQryBtn").attr("disabled",true);var b=$("input[name=id]").val();a.layerFollow=layer.open({type:1,title:["查询物流信息","background-color:#2ac1ac;font-size:1.2em;color:white;"],shade:false,btn:["关闭",],area:["51%","65%"],content:$(".soEntityDetailShipInfo"),scrollbar:false,skin:"my-skin",offset:"65px",success:function(c,d){var e=$("#scCode").find("option:selected").text();
$("input[name=scNameShow]").val(e);$("#shipInfoDiv").find("input[name=soId]").val(b);$("#shipInfoDiv").find("input[name=scTrackingNoShow]").val($("input[name=scTrackingNo]").val());
$(".main-page .nav div").removeClass("on");if(e.indexOf("京东")>-1){$("#jdkuaidi").addClass("on");$(".main-page .nav div").addClass("queryPlatform");}else{if(e.indexOf("顺丰")>-1){$("#shunfengkuaidi").addClass("on");
$("#shunfengkuaidi").addClass("queryPlatform");}else{$("#kuaidiwo").addClass("on");}}},yes:function(d,c){layer.close(a.layerFollow);},on:function(d,c){layer.close(a.layerFollow);
},cancel:function(){layer.close(a.layerFollow);}});$(".shipQryBtn").attr("disabled",false);});$(document).on("click",".soEntityShipQryBtn",function(){$(this).attr("disabled",true);
var d=$(this);var e=d.attr("idVal");var c=d.attr("scTrackingNo");var b=d.attr("shipName");a.layerIndex=layer.open({type:1,title:["队列排队列表","background-color:#2ac1ac;color:white;font-size:1em;"],shade:false,btn:["关闭"],area:["51%","60%"],content:$(".soEntityListShipInfo"),scrollbar:false,skin:"my-skin",success:function(f,g){$("#shipInfoDiv").find("input[name=scNameShow]").val(b);
$("#shipInfoDiv").find("input[name=soId]").val(e);$("#shipInfoDiv").find("input[name=scTrackingNoShow]").val(c);$(".main-page .nav div").removeClass("on");
if(b.indexOf("京东")>-1){$("#jdkuaidi").addClass("on");$(".main-page .nav div").addClass("queryPlatform");}else{if(b.indexOf("顺丰")>-1){$("#shunfengkuaidi").addClass("on");
$("#shunfengkuaidi").addClass("queryPlatform");}else{$("#kuaidiwo").addClass("on");}}},yes:function(g,f){layer.close(a.layerIndex);},on:function(g,f){layer.close(a.layerIndex);
},cancel:function(){layer.close(a.layerIndex);}});$(this).attr("disabled",false);});}};