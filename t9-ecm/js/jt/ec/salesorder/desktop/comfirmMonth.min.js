$(function(){function b(){this.hadInit=false;this.isEdit=false;this.intervalId=null;this.time=0;this.$container=$('div[srcVal="/ec/salesorder/soEntity/desktop/monthComfirmInfo.htm"]');
}b._CONS_={INDEX_URL:ctx+"/ec/salesorder/soEntity/getDesktopInfo.htm",REFRESH_TIME_ELEMENT:"#timeSpan",INFO_SHOW_ELEMENT:"#infoSpan",IDENTITY_ELEMENT:".fa-play",IDENTITY_UP:"fa-rotate-270",IDENTITY_UNCHANGE:"fa-rotate-0",COLOR_ELEMENT:"#colorH",COLOR_UP:"text-navy",COLOR_UNCHANGE:"text-info",};
b.prototype={init:function(d){var c=this;if(!c.hadInit){c.hadInit=true;c._refreshChart();}},_refreshChart:function(){var c=this;$.ajax({type:"GET",url:b._CONS_.INDEX_URL,data:"stausType=audit&timeType=month",contentType:"application/json",dataType:"json",success:function(d){if(d.isUp=="n"){c.$container.find(b._CONS_.INFO_SHOW_ELEMENT).html(d.count+"/"+parseFloat(d.totalAmount).toFixed(0));
c.$container.find(b._CONS_.IDENTITY_ELEMENT).removeClass(b._CONS_.IDENTITY_UP).addClass(b._CONS_.IDENTITY_UNCHANGE);c.$container.find(b._CONS_.COLOR_ELEMENT).removeClass(b._CONS_.COLOR_UP).addClass(b._CONS_.COLOR_UNCHANGE);
}else{c.$container.find(b._CONS_.INFO_SHOW_ELEMENT).html(d.count+"/"+parseFloat(d.totalAmount).toFixed(0));c.$container.find(b._CONS_.IDENTITY_ELEMENT).addClass(b._CONS_.IDENTITY_UP).removeClass(b._CONS_.IDENTITY_UNCHANGE);
c.$container.find(b._CONS_.COLOR_ELEMENT).addClass(b._CONS_.COLOR_UP).removeClass(b._CONS_.COLOR_UNCHANGE);}c.time=0;c.$container.find(b._CONS_.REFRESH_TIME_ELEMENT).html("0");
setTimeout(function(){c._refreshChart();},30*60000);clearInterval(c.intervalId);c.intervalId=setInterval(function(){c.time=c.time+1;c.$container.find(b._CONS_.REFRESH_TIME_ELEMENT).html(c.time);
},60000);},error:function(d){DialogUtils.error("错误",d);c.$container.find(b._CONS_.REFRESH_TIME_ELEMENT).html("0");clearInterval(c.intervalId);setTimeout(function(){c._refreshChart();
},60000);}});}};var a=new b();a.init();});