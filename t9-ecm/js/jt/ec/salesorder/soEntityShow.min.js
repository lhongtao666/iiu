function SoEntityShow(){this.hadInit=false;this.isEdit=false;this.grid=SoEntityShow._CONS_.GRID;this.pager=SoEntityShow._CONS_.PAGER;this.listDataUrl=SoEntityShow._CONS_.LIST_DATA_URL;
this.widthWId=null;}SoEntityShow._CONS_={EDIT_INFO_URL:ctx+"/ec/salesorder/soEntity/edit.htm",DETAIL_PAGE_URL:ctx+"/ec/salesorder/soEntity/detail.htm",LIST_DATA_URL:ctx+"/ec/salesorder/soEntity/listData.htm",EDIT_FORM_ID:"soEntityForm",GRID:"#soEntityGrid",PAGER:"#soEntityPager",};
SoEntityShow.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this.listDataUrl=SoEntityShow._CONS_.LIST_DATA_URL;if(a!=null&&typeof a!=undefined){if(a.grid!=undefined){this.grid=a.grid;
}if(a.pager!=undefined){this.pager=a.pager;}if(a.getManagerBtns!=undefined){this.getManagerBtns=a.getManagerBtns;}if(a.widthWId!=undefined){this.widthWId=a.widthWId;
}}this._bindEventHander();this._initJqgrid(a);}},_bindEventHander:function(){var a=this;$("body").on("click",".soTab",function(){var c=$(this).attr("value");
var b=$(this).attr("value");if(b.length>4){c="*"+b.substring(b.length-3,b.length);}JTTabUtils.addOrRefreshTab(SoEntityShow._CONS_.DETAIL_PAGE_URL+"?soNo="+b,"订单["+c+"]明细");
});},reloadJqgrid:function(f){var e={};if(jQuery.type(f)=="string"){f=decodeURIComponent(f,true);var b=f.split("&");if(b.length){for(var c=0;c<b.length;
c++){var d=b[c].split("=");if(d.length==2){e[d[0]]=d[1];}else{e[d[0]]="";}}}}else{e=f;}var a=$(this.grid).jqGrid("getGridParam","postData");$.extend(a,e);
$(this.grid).jqGrid("setGridParam",{search:true}).trigger("reloadGrid",[{page:1}]);},_initJqgrid:function(c){var a=this;if(c==null||typeof c==undefined){c={};
}var b=$(".jqGrid_wrapper").width();if(a.widthWId){b=$("."+a.widthWId).width();}$(this.grid).jqGrid({url:this.listDataUrl,pager:this.pager,postData:c,datatype:"json",height:"auto",width:b,shrinkToFit:true,postData:c.listParams,rowNum:20,mtype:"POST",multiselect:false,viewrecords:true,rownumbers:true,colNames:["订单编号","订单类型key","订单类型","订单状态key","订单状态","是否主订单.","父订单 ID","关联绿色订单 ID","关联订单 ID","关联绿色订单","关联订单","货款方式key","货款方式","来源类型","产品总数量","服务总数量","赠品总数量","产品金额","运费","金额 - 实际运费（冗余，用于统计成本）","发票类型","发票抬头","发票说明","发票金额","其它费用","其它费用说明","总金额","总折扣金额","金额 - 主订单客单金额","支付方式","订金","应收金额","已付金额","退款金额","财务单数量","是否锁定","锁定人ID","锁定人","是否强制干预订单状态","状态 - 支付状态。unpaid=未支付；partial=部分支付；paid_off=已支付","是否已物流结算（COD）","支付完成时间","订单结束时间。订单状态到达终止状态（包括已取消、已完成、已退款等）时的时间。","客户 ID","客户","跟单员 ID（后台创建的订单创建者和跟单员相同）","订单备注（特殊要求）","下单者ID","下单时间","更新者","更新时间"],colModel:[{name:"soNo",width:130,formatter:function(d,e,f){if(f.soNo!=null&&f.soNo!=""){return"<a href='#' class='soTab' value='"+f.soNo+"'>"+f.soNo+"</a>";
}return f.soNo;}},{name:"soType",hidedlg:true,hidden:true},{name:"soTypeName",width:90,formatter:function(d,f,g){var e=g.soType;if(g.soType=="common"){e="普通订单";
}else{if(g.soType=="change"){e="换货单";}else{if(g.soType=="repeat"){e="重发单";}else{if(g.soType=="point"){e="积分订单";}}}}return e;}},{name:"status",hidedlg:true,hidden:true},{name:"statusName",width:90,formatter:function(d,f,g){var e=g.status;
if(g.status=="awaiting_pay"){e="等待支付";}else{if(g.status=="awaiting_post"){e="待提交";}else{if(g.status=="paid_up"){e="已支付";}else{if(g.status=="awaiting_comfirm"){e="待审核";
}else{if(g.status=="comfirm"){e="已审核";}else{if(g.status=="packing"){e="待备货";}else{if(g.status=="deliver"){e="待发货";}else{if(g.status=="shipping"){e="已发货";
}else{if(g.status=="complete"){e="已签收";}else{if(g.status=="close"){e="订单作废";}else{if(g.status=="back"){e="待退回";}else{if(g.status=="awaiting_refund"){e="申请退款";
}else{if(g.status=="refund"){e="已退款";}else{if(g.status=="close_reject"){e="拒收";}else{if(g.status=="close_repeat"){e="需重发";}else{if(g.status=="close_lost"){e="包裹丢失";
}else{if(g.status=="close_has_repeat"){e="已重发";}}}}}}}}}}}}}}}}}return e;}},{name:"isMain",width:120,hidedlg:true,hidden:true},{name:"pid",width:120,hidedlg:true,hidden:true},{name:"greenId",width:150,hidedlg:true,hidden:true},{name:"relId",width:150,hidedlg:true,hidden:true},{name:"greenNo",width:130,hidedlg:true,hidden:true,formatter:function(d,e,f){if(f.greenNo!=null&&f.greenNo!=""){return"<a href='#' class='soTab' value='"+f.greenNo+"' >"+f.greenNo+"</a>";
}return f.greenNo;}},{name:"relNo",width:130,hidedlg:true,hidden:true,formatter:function(d,e,f){if(f.relNo!=null&&f.relNo!=""){return"<a href='#'  class='soTab' value='"+f.relNo+"' >"+f.relNo+"</a>";
}return f.relNo;}},{name:"cashType",hidedlg:true,hidden:true},{name:"cashTypeName",width:90,formatter:function(d,f,g){var e=g.cashType;if(g.cashType=="pay"){e="款到发货";
}else{if(g.cashType=="pay_sub"){e="支付订金";}else{if(g.cashType=="green"){e="绿色通道";}else{if(g.cashType=="green_by"){e="由绿色通道订单支付订金";}else{if(g.cashType=="cod"){e="货到付款";
}else{if(g.cashType=="free"){e="免费已付";}}}}}}return e;}},{name:"fromType",width:120,hidedlg:true,hidden:true},{name:"prodQty",width:90},{name:"serviceQty",width:120,hidedlg:true,hidden:true},{name:"giftQty",width:120,hidedlg:true,hidden:true},{name:"prodAmount",width:90},{name:"shippingAmount",width:60,hidedlg:true,hidden:true},{name:"shippingActual",width:120,hidedlg:true,hidden:true},{name:"billType",width:90,hidedlg:true,hidden:true},{name:"billTitle",width:120,hidedlg:true,hidden:true},{name:"billContent",width:120,hidedlg:true,hidden:true},{name:"billAmount",width:80,hidedlg:true,hidden:true},{name:"otherAmount",width:80,hidedlg:true,hidden:true},{name:"otherComment",width:120,hidedlg:true,hidden:true},{name:"totalAmount",width:70},{name:"discountAmount",width:120,hidedlg:true,hidden:true},{name:"mainAmount",width:120,hidedlg:true,hidden:true},{name:"payType",width:120,hidedlg:true,hidden:true,formatter:function(d,f,g){var e=g.payType;
if(g.payType=="alipay"){e="支付宝";}else{if(g.payType=="weixin"){e="微信支付";}else{if(g.payType=="bank"){e="银行转账";}else{if(g.payType=="cash"){e="现金支付";}}}}return e;
}},{name:"subAmount",width:60,hidedlg:true,hidden:true},{name:"payableAmount",width:80,hidedlg:true,hidden:true},{name:"payedAmount",width:80,hidedlg:true,hidden:true},{name:"refundApply",width:120,hidedlg:true,hidden:true},{name:"financeBillCount",width:60,hidedlg:true,hidden:true,formatter:function(d,e,f){if(f.financeBillCount!=null&&f.financeBillCount!=0){return"<a href='#' class='soFinanceBillTab' value='"+f.soNo+"'  style='color:red;'>"+f.financeBillCount+"(查看)</a>";
}return f.financeBillCount;}},{name:"isLock",width:60,hidedlg:true,hidden:true,formatter:function(d,f,g){var e=g.isLock;if(g.isLock=="y"){e="<span style='color:red;'>是</span>";
}else{if(g.isLock=="n"){e="否";}}return e;}},{name:"lockId",width:100,hidedlg:true,hidden:true},{name:"lockName",width:100,hidedlg:true,hidden:true},{name:"isForce",width:120,hidedlg:true,hidden:true},{name:"payStatus",width:120,hidedlg:true,hidden:true},{name:"isSettle",width:120,hidedlg:true,hidden:true},{name:"payTime",width:120,hidedlg:true,hidden:true},{name:"closeTime",width:120,hidedlg:true,hidden:true},{name:"csId",width:120,hidedlg:true,hidden:true},{name:"csName",width:100,hidedlg:true,hidden:true},{name:"belongId",width:120,hidedlg:true,hidden:true},{name:"comment",width:120,hidedlg:true,hidden:true},{name:"createBy",width:120,hidedlg:true,hidden:true},{name:"createTime",width:120,hidedlg:true,hidden:true},{name:"updateBy",width:120,hidedlg:true,hidden:true},{name:"updateTime",width:120,hidedlg:true,hidden:true}],gridComplete:function(){var d=$(a.grid).jqGrid("getGridParam","records");
if(d<=0){if($(a.grid).parent().find(".norecords").html()==null){$(a.grid).parent().append('<div class="norecords">没有符合数据！</div>');$(a.grid).parent().find(".norecords").show();
}else{$(a.grid).parent().find(".norecords").show();}}else{$(a.grid).parent().find(".norecords").hide();}}});$(window).bind("resize",function(){var d=$(".jqGrid_wrapper").width();
if(a.widthWId){d=$("."+a.widthWId).width();}$(a.grid).setGridWidth(d);});}};