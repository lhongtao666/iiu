function SweepDeliver(){this.hadInit=false;this.index=1;this.beginTime=0;this.endTime=0;this.hasSweep=false;}SweepDeliver._CONS_={SWEEP_DELIVER_URL:ctx+"/ec/salesorder/soEntity/sweepDeliver.htm",GRID:"#sweepDeliverGrid",PAGER:"#sweepDeliverPager"};
SweepDeliver.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindEventHander();}},_bindEventHander:function(){var a=this;$(document).on("keypress",".sweepDeliverNo",function(b){var c=$(this).val();
if(b.keyCode!="13"&&a.beginTime==0&&!a.hasSweep){a.beginTime=new Date().getTime();return true;}if(b.keyCode!="13"&&a.beginTime!=0&&a.endTime==0){a.endTime=new Date().getTime();
return true;}if(c==null||c==""){a.beginTime=0;a.endTime=0;a.hasSweep=false;}if(b.keyCode=="13"){if(a.beginTime!=0&&a.endTime!=0&&(a.endTime-a.beginTime<20)){a.hasSweep=true;
}if(a.hasSweep){a._deliver(c,this);a._addNew();}a.beginTime=0;a.endTime=0;a.hasSweep=false;}});},_deliver:function(d,c){var b=this;var a=SweepDeliver._CONS_.SWEEP_DELIVER_URL;
FormUtils.submit(a,{scTrackingNo:d},function(e){b._addData(e,c);},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});},_addData:function(c,b){var a=$(b).parents("tr");
a.find("td:eq(2)").append(c.soNo);a.find("td:eq(3)").append(c.success?c.status:("<span style='color:red;'>"+c.status+"</span"));a.find("td:eq(4)").append(c.csName);
a.find("td:eq(5)").append(c.proxyAmount);a.find("td:eq(6)").append(c.address);$(b).attr("disabled",true);},_addNew:function(){this.index=this.index+1;var a=new StringBuffer();
a.append("<tr>").append("<td>"+this.index+"</td>").append("<td><input style='width:90%' class='sweepDeliverNo'></td>").append("<td></td>").append("<td></td>").append("<td></td>").append("<td></td>").append("<td></td>").append("</tr>");
$("#sweepDeliverbodyContainer").append(a.toString());$("#sweepDeliverbodyContainer").find("tr:eq("+(this.index-1)+")").find(".sweepDeliverNo").focus();
},};