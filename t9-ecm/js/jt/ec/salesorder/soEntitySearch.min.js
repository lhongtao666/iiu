$(function(){StoreUtils.loadStores("","storeIdContainer");StoreUtils.loadStores("","storeIdPack");var a=new SoEntitySelectList();a.init();});function SoEntitySelectList(){this.simpleShowLastFollow=(simpleShowLastFollow=="n"?false:true);
this.simpleShowComment=(simpleShowComment=="n"?false:true);this.hadInit=false,self=this;this.soEntitySearch=new SoEntity({pager:"soEntityMgrPager",grid:"soEntityMgrGrid",tabContainer:"soEntityContainer",status:"",bizType:"placer",simpleShowLastFollow:this.simpleShowLastFollow,simpleShowComment:this.simpleShowComment,canShowScTrankNo:ResUtils.canShow("soSearch.button.showScTrackNo")?"can":"cannot",bindEventHandler:function(){self._bindEventHander();
}});ConfigUtils.findByKey("soEntity.isShowExport",function(a){if(a.success){new FormConfig({"formId":$(".soSelectSearchForm"),title:"订单查询配置",isHidden:true,"endLess":[],modular:"soSelectSearchList"}).init();
}else{new FormConfig({"formId":$(".soSelectSearchForm"),title:"订单查询配置",isHidden:true,forceParam:["是否导出"],"endLess":[],modular:"soSelectSearchList"}).init();
}});}SoEntitySelectList._CONS_={SAVE_EDIT_URL:ctx+"/ec/salesorder/soEntity/saveEdit.htm",SUBMIT_URL:ctx+"/ec/salesorder/soEntity/submit.htm",EDIT_FORM_ID:"soEntityForm",GRID:"#soEntityMgrGrid",PAGER:"#soEntityMgrPager",};
SoEntitySelectList.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._initSearch();this.soEntitySearch.init();this._buildEmployeeSelect();
this._hideNotGrantBtn();}},_initSearch:function(){CateUtils.getOptions([{typeKey:"system",pKey:"CsInterestType",container:"interestsQry"},{typeKey:"system",pKey:"soFollowStatus",container:"followQry"},{typeKey:"system",pKey:"CsEntryType",container:"entryQry"},{typeKey:"system",pKey:"CsInterestType",container:"soInterestQry"},{typeKey:"system",pKey:"soEntityStoreName",container:"storeNameSearch"},{typeKey:"system",pKey:"CsGenderType",container:"genderSearch"}]);
CateUtils.findCatePos({typeKey:"soEntity",pKey:"soType",container:"soTypeQry"});ConfigUtils.findByKey("system.isBanDelayConfirm",function(d){if(d.success){$("#isDelayConfirm").hide();
}else{$("#isDelayConfirm").show();}});StoreUtils.loadData({container:"storeSearch",isSale:false});ShipCompanyUtils.getOptions({container:"scCodeQry",caption:"全部"});
ChannelUtils.getOptions({container:"srcQry",caption:"全部"});ChannelUtils.getOptions({container:"soSrcQry",caption:"全部"});var a=new Date();var b=a.currentDate()+" 00:00:00";
var c=new Date().currentDate()+" 23:59:59";$(".minPlaceTime").val(b);$(".maxPlaceTime").val(c);this.addressServiceSearch=new AddressService("addrContainerSearch");
this.addressServiceSearch.init({isSelect:"y",isNotRequired:true},function(){});},_hideNotGrantBtn:function(){if(!ResUtils.canShow("soEntitySearch.button.exportShip")){$(".exportSoEntityInfo").hide();
}},_bindEventHander:function(){var a=this;$("#groupName").on("click",function(){var b={isMultiple:1,selectedGroupId:$("input[name='belongOgn']").val(),container:"groupName",fn:function(c){$("input[name=belongOgn]").val(c);
a._buildEmployeeSelect(c);}};GroupUtils.selectGroupTreeBox(b);});$(".selectPlacer").on("click",function(){var b={isMultiple:1,selectedGroupId:$("input[name='belongOgnPlacer']").val(),container:"selectPlacer",fn:function(c){$("input[name=belongOgnPlacer]").val(c);
a._buildEmployeeSelect(c);}};GroupUtils.selectGroupTreeBox(b);});},_buildEmployeeSelect:function(a){$.ajax({type:"GET",url:ctx+"/crm/ou/employee/listEmployees.htm"+"?groupId="+(a?a:""),contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(c){if(c&&c.length>0){var d=new StringBuffer();
d.append("<option value=''>请选择</option>");for(var b=0;b<c.length;b++){d.append("<option value='"+c[b].id+"'>"+c[b].aid+":"+c[b].name+"</option>");}$("#belongEmployeeSearch").empty().append(d.toString()).select2();
$("#planMan").empty().append(d.toString()).select2();}}});},};