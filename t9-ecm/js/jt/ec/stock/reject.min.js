$(function(){var a=new Reject();a.init();});function Reject(){this.hadInit=false;this.hadInitProd=false;this.canShowScTrankNo=false;this.hadInitRejecting=false;
this.soEntityExport=new SoEntityExport();this.listParams="Q__S__EQ__entity.after_sale_status_=complete";this.canShowScTrankNo=(ResUtils.canShow("soDeliver.button.showScTrackNo")?"can":"cannot");
this.hiddenMore=true;this.storeDatas=[];}Reject._CONS_={EXPORT_EXCEL_URL:ctx+"/ec/salesorder/soEntity/exportSoStockInExcel.htm",IMPORT_EXCEL_URL:ctx+"/ec/salesorder/soEntity/importSoStockInExcel.htm",LIST_REJECT_URL:ctx+"/ec/salesorder/soEntity/listData.htm",DETAIL_CS_PAGE_URL:ctx+"/crm/cs/csEntity/detail.htm",DETAIL_PAGE_URL:ctx+"/ec/salesorder/soEntity/detail.htm",GET_REJECT_URL:ctx+"/ec/salesorder/soEntity/getSoEntityForReject.htm",STOCK_ONE_URL:ctx+"/ec/salesorder/soEntity/stockForOne.htm",STOCK_MANY_URL:ctx+"/ec/salesorder/soEntity/stockForMany.htm",STOCK_STOP_URL:ctx+"/ec/salesorder/soEntity/stockStop.htm",LIST_PROD_URL:ctx+"/ec/salesorder/soEntity/listReturnData.htm",EMPLOYEE_LIST_URL:ctx+"/crm/ou/employee/listEmployees.htm",BACK_STOCK_REJECT:ctx+"/ec/salesorder/soEntity/backRejectStock.htm",REJECT_GRID:"#soRejectListGrid",REJECT_PAGER:"#soRejectListPager",REJECTING_GRID:"#soRejectingGrid",REJECTING_PAGER:"#soRejectingPager",DPROD_GRID:"#soRejectDProdListGrid",DPROD_PAGER:"#soRejectDProdListPager",TPROD_GRID:"#soRejectTProdListGrid",TPROD_PAGER:"#soRejectTProdListPager",};
Reject.prototype={init:function(b){if(!this.hadInit){this.hadInit=true;this._hideNotGrantBtn();this._bindEventHander();$(".minPlaceTime").val(new Date(new Date().getTime()-7*24*60*60*1000).currentDate()+" 00:00:00");
$(".maxPlaceTime").val(new Date(new Date().getTime()).currentDate()+" 23:59:59");ShipCompanyUtils.getOptions({container:"scCodeQry",caption:"全部"});this._initRejectJqgrid({grid:Reject._CONS_.REJECTING_GRID,pager:Reject._CONS_.REJECTING_PAGER,url:Reject._CONS_.LIST_REJECT_URL+"?baseTypeAndStatus=uncompleteBack&canShowScTrankNo"+this.canShowScTrankNo,searchParam:{"Q__D__BW__entity.create_time_":$(".minPlaceTime").val()}});
var a=this;StoreUtils.loadData({container:"storeSearch",isSale:false,callBackFunc:function(c){a.storeDatas=c;}});StoreUtils.loadData({container:"singleStoreId",isSale:false});
StoreUtils.loadData({container:"batchStoreId",isSale:false});this._locateToGlHelp();this._buildEmployeeSelect();}},_buildEmployeeSelect:function(a){$.ajax({type:"GET",url:ctx+"/crm/ou/employee/listEmployees.htm"+"?groupId="+(a?a:""),contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(c){if(c&&c.length>0){var d=new StringBuffer();
d.append("<option value=''>请选择</option>");for(var b=0;b<c.length;b++){d.append("<option value='"+c[b].id+"'>"+c[b].aid+":"+c[b].name+"</option>");}$("#belongEmployeeSearch").empty().append(d.toString()).select2();
}}});},_locateToGlHelp:function(){var a="glHelp.stock.soReject";glHelpUtil.init(a);},_hideNotGrantBtn:function(){if(!ResUtils.canShow("soEntity.button.backOne")){$(".soRejectBackForOne").hide();
}if(!ResUtils.canShow("rejecting.button.exportExcel")){$(".soStockInExport").hide();}if(!ResUtils.canShow("rejecting.button.importExcel")){$(".soRejectBackImport").hide();
}if(!ResUtils.canShow("soEntity.button.backMany")){$(".soRejectBackForMany").hide();}if(!ResUtils.canShow("soEntity.button.reject.export")){$(".exportSoEntityInfo").hide();
}if(!ResUtils.canShow("soEntity.button.reject.backStock")){$(".backStockBtn").hide();}},_toExportExcel:function(b){var a=this;$(".prevBtn").show();$(".list_wrapper").hide();
$(".form_wrapper").hide();$(".excel_wrapper").show();if(b&&b.length>0){$("#endExportNum").val(b.length);}else{$("#endExportNum").val($(Reject._CONS_.REJECTING_GRID).jqGrid("getGridParam","records"));
}$("input[name=selectIds]").val(b);excelUtil.findExportColByModule("soStockIn",true,function(d){var e=new StringBuffer();if(d&&d.length>0){for(var c=0;
c<d.length;c++){e.append("<div class='checkbox checkbox-success checkbox-inline'>");e.append("<input type='checkbox' checked class='columnCheckBox' name='exportColumn' id="+d[c].id+" value='"+d[c].devCode+"'><label for='"+d[c].id+"'>"+d[c].name+"</label>");
e.append("</div>");}}$("#exportExcelForm").find("#exportColumnContainer").empty().append(e.toString());});},_exportExcel:function(){var b=this;var d=$("#exportColumnContainer").find(".columnCheckBox");
var f=[];$(d).each(function(){if($(this).is(":checked")){f.push($(this).val());}});var a=$("#beginExportNum").val();var c=$("#endExportNum").val();if(!a){DialogUtils.error(msgCode.ERROR,"请填写正确的开始记录");
return;}if(!c){DialogUtils.error(msgCode.ERROR,"请填写正确的结束记录");return;}if(a>c){DialogUtils.error(msgCode.ERROR,"开始记录不能大于结束记录");return;}if(parseInt(a)-parseInt($(Reject._CONS_.REJECTING_GRID).jqGrid("getGridParam","records"))>0){DialogUtils.error(msgCode.ERROR,"开始记录不能大于记录总条数");
return;}if(!c){c=a;}var g=$("#soEntityRejectingForm").closest("form").serialize();var e=$("input[name=selectIds]").val();if(e&&e.length>0){var g=g+"&columns="+f.toString()+"&selectIds="+e+"&Q__S__EQ__entity.after_sale_status_=processing"+"&canShowScTrankNo="+b.canShowScTrankNo;
}else{var g=g+"&columns="+f.toString()+"&beginExportNum="+a+"&endExportNum="+c+"&Q__S__EQ__entity.after_sale_status_=processing"+"&canShowScTrankNo="+b.canShowScTrankNo;
}window.location.href=Reject._CONS_.EXPORT_EXCEL_URL+"?"+g;},_bindEventHander:function(){var a=this;$("body").on("click",".soStockInExport",function(){var b=$(Reject._CONS_.REJECTING_GRID).jqGrid("getGridParam","selarrrow");
a._toExportExcel(b);});$("body").on("click",".exportSoStockInExcel",function(){a._exportExcel();});$("body").on("click",".soRejectBackImport",function(){var b={"importUrl":Reject._CONS_.IMPORT_EXCEL_URL,"tabTitle":"导入入仓订单excel数据"};
excelUtil.importExcel(b);});$(document).on("click",".prevBtn",function(){a.clear(false);});$("body").on("click",".exportSoEntityInfo",function(){var d=$("#soEntityRejectSearchForm").closest("form").serialize();
var c=$(Reject._CONS_.REJECT_GRID).jqGrid("getGridParam","records");var b=$(Reject._CONS_.REJECT_GRID).jqGrid("getGridParam","selarrrow");var e="baseTypeAndStatus=completeBack"+"&canShowScTrankNo="+a.canShowScTrankNo;
a.soEntityExport.init({params:d,selectIds:b,toatolCount:c,requestQueryParams:e});});$("#belongOgnNamePack").on("click",function(){var b={isMultiple:0,selectedGroupId:$("#belongOgnPack").val(),container:"belongOgnNamePack",nolimit:true,positionType:"order_print,dept_manager",fn:function(d){$("#belongOgnPack").val(d);
var c=SoEntityBase._CONS_.EMPLOYEE_LIST_URL+"?groupId="+d+"&type=order_print,dept_manager";$("#belongEmployeePackSearch").empty();FormUtils.loadData(c,function(f){if(f&&f.length>0){var g=new StringBuffer();
g.append("<option value=''>请选择</option>");for(var e=0;e<f.length;e++){g.append("<option value='"+f[e].id+"'>"+f[e].aid+":"+f[e].name+"</option>");}$("#belongEmployeePackSearch").append(g.toString());
}},null,true);}};GroupUtils.selectGroupTreeBox(b);});$(".showSearch").on("click",function(){$(this).parent().parent().parent().find(".hideSearchParam").show();
$(this).parent().parent().parent().find(".hideSearch").show();$(this).hide();});$(".hideSearch").on("click",function(){$(this).parent().parent().parent().find(".hideSearchParam").hide();
$(this).parent().parent().parent().find(".showSearch").show();$(this).hide();});$("#soRejecting").on("click",".soEntitySearch",function(){var b=$(this).closest("form").serialize();
a.reloadRejectingJqgrid(b);});$("#soEntityReject").on("click",".soEntitySearch",function(){var b=$(this).closest("form").serialize();a.reloadRejectJqgrid(b);
});$("body").on("click",".stStockSearch",function(){var b=$(this).closest("form").serialize();var c=$("input[name='showType']:checked").val();if("total"==c){a.hiddenMore=true;
}else{a.hiddenMore=false;}a.reloadProdJqgrid(b);});$("body").on("click",".csTab",function(){var c=$(this).text();var b=$(this).attr("value");if(c.length>5){c="*"+c.substring(c.length-4,c.length);
}JTTabUtils.addOrRefreshTab(Reject._CONS_.DETAIL_CS_PAGE_URL+"?csId="+b,"客户["+c+"]");});$("#soEntityReject").on("click",".showSoDetail",function(){var b=$(this).attr("id-value");
var c=$(this).attr("oprate-time");a._showBackDetail(b,c);});$("#soRejecting").on("click",".showSoDetail",function(){var b=$(this).attr("id-value");a._backToStockForOne(b);
});$("#soEntityReject").on("click",".resetBtn",function(){FormUtils.clear("#soEntityRejectSearchForm");});$("#soRejecting").on("click",".resetBtn",function(){FormUtils.clear("#soEntityRejectingForm");
});$("body").on("change",".goodCount",function(){var b=$(this).attr("totalCount");var c=$(this).val();if(a._checkCount(b,c)){var d=parseInt(b)-parseInt(c);
$(this).parents("tr").find(".badCount").empty().append(d);}});$("body").on("click",".stockPreBtn",function(){$("#soRejectingbodyContainer").empty();$("#soRejecting").find(".list_wrapper").show();
$("#soRejecting").find(".form_wrapper").hide();});$("body").on("click",".rejectPreBtn",function(){$("#soRejectBodyContainer").empty();$("#soEntityReject").find(".list_wrapper").show();
$("#soEntityReject").find(".form_wrapper").hide();});$("body").on("click",".soRejectBackForOne",function(){var b=a._getSelId(Reject._CONS_.REJECTING_GRID);
if(b==null){return;}a._backToStockForOne(b);});$("body").on("click",".stockSaveBtn",function(){a._saveStockForOne();});$("body").on("click",".stockStopBtn",function(){a._stockStop();
});$("body").on("click",".soRejectBackForMany",function(){var b=$(Reject._CONS_.REJECTING_GRID).jqGrid("getGridParam","selarrrow");if(b==null){return;}a._saveStockForMany(b);
});$("body").on("click",".tabli",function(){if($(this).attr("id")=="soEntityRejectTabLi"){if(!a.hadInitRejecting){a._initRejectJqgrid({grid:Reject._CONS_.REJECT_GRID,pager:Reject._CONS_.REJECT_PAGER,url:Reject._CONS_.LIST_REJECT_URL+"?baseTypeAndStatus=completeBack"+"&canShowScTrankNo="+a.canShowScTrankNo,searchParam:{"Q__D__BW__entity.create_time_":$(".minPlaceTime").val()},});
a.hadInitRejecting=true;}else{$("#soEntityReject").find(".soEntitySearch").trigger("click");}}else{if($(this).attr("id")=="soRejectingTabLi"){$("#soRejecting").find(".soEntitySearch").trigger("click");
}else{if($(this).attr("id")=="soRejectProdListTabLi"){if(!a.hadInitProd){a._initTProdJqgrid({grid:Reject._CONS_.TPROD_GRID,pager:Reject._CONS_.TPROD_PAGER,url:Reject._CONS_.LIST_PROD_URL+"?backQty=y",searchParam:{"Q__D__BW__entity.inbound_time_":$(".minPlaceTime").val()},});
a.hadInitProd=true;}else{$("#soRejectProdList").find(".stStockSearch").trigger("click");}}}}});$("#groupName").on("click",function(){var b={isMultiple:0,selectedGroupId:$("input[id='belongOgn']").val(),container:"groupName",positionType:"order_search,dept_manager",fn:function(c){$("input[name=belongOgn]").val(c);
a.buildEmployeeOption(c);}};GroupUtils.selectGroupTreeBox(b);});$("#groupName2").on("click",function(){var b={isMultiple:0,selectedGroupId:$("input[id='belongOgn2']").val(),container:"groupName2",positionType:"order_search,dept_manager",fn:function(c){$("input[name=belongOgn]").val(c);
}};GroupUtils.selectGroupTreeBox(b);});$("body").on("click",".backStockBtn",function(){var b=$(Reject._CONS_.REJECT_GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error("提示","请选择要查看的订单");return null;}DialogUtils.confirmWithOptions({title:"您确认要撤销入库吗？",text:"",confirmButtonText:"确定",yesFunc:function(){a._backStock(b);
}});});$("#soEntityReject").on("click",".batchShipQryBtn",function(){var b=$("#soRejectListGrid").jqGrid("getGridParam","selarrrow");if(!b||b.length<=0){b=$("#soRejectListGrid").jqGrid("getDataIDs");
}JTTabUtils.addOrRefreshTab(ctx+"/ec/salesorder/soEntity/shipQry/list.htm?ids="+b,"批量查物流");});$("#soRejecting").on("click",".batchShipQryBtn",function(){var b=$("#soRejectingGrid").jqGrid("getGridParam","selarrrow");
if(!b||b.length<=0){b=$("#soRejectingGrid").jqGrid("getDataIDs");}JTTabUtils.addOrRefreshTab(ctx+"/ec/salesorder/soEntity/shipQry/list.htm?ids="+b,"批量查物流");
});},clear:function(c){var a=this;function b(){a._showListWrapper();a.isEdit=false;if(c){var d=$("#soEntityRejectingForm").serialize();a.reloadRejectingJqgrid(d);
}}if(a.isEdit){DialogUtils.warning(function(){b();});}else{b();}},_showListWrapper:function(){$(".list_wrapper").show();$(".form_wrapper").hide();$(".excel_wrapper").hide();
},_backStock:function(c){var b=this;var a=Reject._CONS_.BACK_STOCK_REJECT;FormUtils.submit(a,{ids:c},function(d){if(d.success){DialogUtils.success(msgCode.INFO,d.msg);
$("#soEntityReject").find(".soEntitySearch").trigger("click");}else{DialogUtils.error(msgCode.FAIL_MSG,d.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});},buildEmployeeOption:function(b,c,d){var a=d?d:"dept_manager";$.ajax({type:"GET",url:Reject._CONS_.EMPLOYEE_LIST_URL+"?groupId="+b+"&type="+a,contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(f){if(f&&f.length>0){var g=new StringBuffer();
g.append("<option value=''>请选择</option>");for(var e=0;e<f.length;e++){g.append("<option value='"+f[e].id+"'>"+f[e].aid+":"+f[e].name+"</option>");}if(c){$("#"+c).empty().append(g.toString());
}else{$("#belongEmployeeSearch").empty().append(g.toString());}}}});},_stockStop:function(){var a=Reject._CONS_.STOCK_STOP_URL;var b=$("#backSoId").val();
DialogUtils.confirmWithOptions({title:"确定终止？",text:"",confirmButtonText:"确定",yesFunc:function(){FormUtils.submit(a,"soId="+b,function(c){if(c.success){DialogUtils.success(msgCode.SUCCESS,"操作成功！");
$("#soRejecting").find(".soEntitySearch").trigger("click");}else{DialogUtils.error(msgCode.FAIL_MSG,c.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});}});},_showBackDetail:function(b,a){$("#soEntityReject").find(".list_wrapper").hide();$("#soEntityReject").find(".form_wrapper").show();this._getDetailData(b,a);
},_backToStockForOne:function(a){$("#soRejecting").find(".list_wrapper").hide();$("#soRejecting").find(".form_wrapper").show();this._getRejectData(a);},_saveStockForOne:function(){var i=this;
var c=$("#backSoId").val();var h=$("#singleStoreId").val();if(c==""||c==null){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);return;}var d=[];var e=true;
var f=false;$("#soRejectingbodyContainer").find("tr").each(function(){var k={};k.id=$(this).attr("id");k.count=$(this).find(".goodCount").val();k.badCount=$(this).find(".badCount").text();
k.salePrice=$(this).find("#salePrice").text();var j=$(this).find(".goodCount").attr("totalCount");if(!i._checkCount(j,k.count)){$(this).find(".goodCount").focus();
e=false;return false;}if(Number(k.badCount)>0){f=true;}d.push(k);});if(!e){return false;}var b="soId="+c+"&items="+JSON.stringify(d)+"&storeId="+h;var g=Reject._CONS_.STOCK_ONE_URL;
var a="";if(f){a="注：退库商品中存在次品";}DialogUtils.confirmWithOptions({title:"确定入库？",text:a,confirmButtonText:"确定",yesFunc:function(){FormUtils.submit(g,b,function(j){if(j.success){DialogUtils.success(msgCode.SUCCESS,"操作成功！");
$(".stockPreBtn").trigger("click");$("#soRejecting").find(".soEntitySearch").trigger("click");}else{DialogUtils.error(msgCode.FAIL_MSG,j.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});}});},_saveStockForMany:function(b){var a=this;a.layerIndex=layer.open({type:1,title:"批量入库",shadeClose:false,btn:["保存","关闭"],area:["400px","350px"],content:$(".batchBackPane"),scrollbar:false,success:function(c,d){},yes:function(f,e){var c=Reject._CONS_.STOCK_MANY_URL;
var d=$("#batchStoreId").val();FormUtils.submit(c,"ids="+b+"&storeId="+d,function(g){if(g.success){DialogUtils.success(msgCode.SUCCESS,"操作成功！");layer.close(f);
$("#soRejecting").find(".soEntitySearch").trigger("click");}else{DialogUtils.error(msgCode.FAIL_MSG,g.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});},cancel:function(){}});},_getSelId:function(b){var a=$(b).jqGrid("getGridParam","selarrrow");if(a==null||a.length==0){DialogUtils.error("提示","请选择要查看的订单");
return null;}if(a.length>1){DialogUtils.error("提示","不能同时选择多个订单进行查看");return null;}return a;},_checkCount:function(a,b){if(parseInt(b)<0){DialogUtils.error(msgCode.ERROR,"正品数量不能小于0");
return false;}else{if(parseInt(b)>parseInt(a)){DialogUtils.error(msgCode.ERROR,"正品数量不能大于总数量");return false;}}return true;},_getRejectData:function(b){var a=this;
$("#backSoId").val(b);FormUtils.loadData(Reject._CONS_.GET_REJECT_URL+"?soId="+b,function(f){var g=new StringBuffer();if(f.success){var e=JSON.parse(f.msg);
for(var c=0;c<e.soItemPos.length;c++){var d=a._createTr(e.soItemPos[c]);g.append(d);}}$("#soRejectingbodyContainer").empty().append(g.toString());},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});},_getDetailData:function(b,c){var a=this;FormUtils.loadData(Reject._CONS_.GET_REJECT_URL+"?soId="+b,function(f){var g=new StringBuffer();if(f.success){var e=JSON.parse(f.msg);
for(var d=0;d<e.soItemPos.length;d++){g.append(a._createCompleteTr(e,e.soItemPos[d],c));}}$("#soRejectBodyContainer").empty().append(g.toString());},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});},_createTr:function(a){var b=new StringBuffer();b.append("<tr id='"+a.id+"'><td></td><td>").append(a.skuKey).append("</td><td>").append(a.prodName).append("</td><td id='salePrice'>").append(a.salesPrice).append("</td><td>").append(a.count).append("</td><td>").append("<span class='badCount'>0</span>").append("</td><td>").append("<input class='goodCount' name='goodCount' totalCount='"+a.count+"' value='"+a.count+"' type='number' style='width:50px;' >").append("</td><td>").append((parseFloat(a.count)*parseFloat(a.salesPrice)).toFixed(2)).append("</td>").append("</tr>");
return b.toString();},_createCompleteTr:function(c,b,a){var d=new StringBuffer();d.append("<tr id='"+b.id+"'><td></td><td>").append(b.skuKey).append("</td><td>").append(b.prodName).append("</td><td>").append(b.salesPrice).append("</td><td>").append(b.count).append("</td><td>").append(b.afterSaleStatus=="bad"?"<span style='color:red'>次品</span>":"正品").append("</td><td>").append(c.storeName).append("</td><td>").append("退货入库").append("</td><td>").append(a);
return d.toString();},reloadRejectJqgrid:function(a){JTJqgridUtils.reloadJqgrid(Reject._CONS_.REJECT_GRID,a);},reloadRejectingJqgrid:function(a){JTJqgridUtils.reloadJqgrid(Reject._CONS_.REJECTING_GRID,a);
},reloadProdJqgrid:function(a){if(!this.hiddenMore){$(".soRejectTProdListGrid").hide();$(".soRejectDProdListGrid").show();this._initDProdJqgrid({grid:Reject._CONS_.DPROD_GRID,pager:Reject._CONS_.DPROD_PAGER,url:Reject._CONS_.LIST_PROD_URL+"?backQty=y&showType=detail",searchParam:{"Q__D__BW__entity.inbound_time_":$(".minPlaceTime").val()},});
JTJqgridUtils.reloadJqgrid(Reject._CONS_.DPROD_GRID,a);}else{$(".soRejectDProdListGrid").hide();$(".soRejectTProdListGrid").show();JTJqgridUtils.reloadJqgrid(Reject._CONS_.TPROD_GRID,a);
}},_getManagerBtns:function(){var a=[];return a;},_initRejectJqgrid:function(b){var a=this;$(b.grid).JTJqgrid({url:b.url+"&canShowScTrankNo="+a.canShowScTrankNo,pager:b.pager,postData:b.searchParam,shrinkToFit:false,autoScroll:true,colNames:["订单编号","订单编号","客户ID","客户","状态","状态","加急","发货仓库","入仓仓库","货款方式","快递公司","快递单号","原单快递公司","原单快递单号","订单金额","下单人","订单商品","下单工号","最新跟进","下单时间","发货时间","入库时间","货款类型","操作"],colModel:[{name:"soNoShow",index:"so_no_",width:80,hidedlg:true,hidden:true,formatter:function(c,d,e){if(c&&c.length>0){return c;
}return e.soNo;}},{name:"soNo",index:"so_no_",width:120,formatter:function(c,d,e){if(e.footData){return e.soNo;}else{return"<a href='#' class='showSoDetail' value='"+c+"' id-value='"+e.id+"' oprate-time='"+e.updateTime+"'>"+c+"</a>";
}}},{name:"csId",width:120,hidedlg:true,hidden:true},{name:"csName",index:"cs_name_",width:100,formatter:function(c,e,f){var d=c+":"+f.csCode;return"<a href='#' class='csTab'  title='"+d+"' value='"+f.csId+"''>"+d+"</a>";
}},{name:"statusShow",index:"status_",width:80,formatter:function(d,f,g){var c=g.status;var e=c;if(c=="comfirm"){e="已审核";}else{if(c=="packing"){e="已备货";
}else{if(c=="deliver"){e="待发货";}else{if(c=="shipping"){e="已发货";}else{if(c=="close_reject"){e="拒收";}else{if(c=="close_repeat"){e="需重发";}else{if(c=="close_lost"){e="包裹丢失";
}else{if(c=="complete"){e="已签收";}else{if(c=="unbound"){e="退货中";}}}}}}}}}return e;}},{name:"status",index:"status_",width:120,hidedlg:true,hidden:true},{name:"isFast",index:"is_fast_",width:60,formatter:function(d){var c="否";
if(d=="y"){c="<span style='color:red;'>是</span>";}return c;}},{name:"storeName",width:120},{name:"arrivalStoreName",width:120,hidden:b.grid=="#soRejectingGrid"?true:false,},{name:"cashTypeName",width:70,index:"entity.cash_type_",formatter:function(c,e,f){var d=f.cashType;
if(f.cashType=="pay"){d="款到发货";}else{if(f.cashType=="pay_sub"){d="支付订金";}else{if(f.cashType=="green"){d="绿色通道";}else{if(f.cashType=="green_by"){d="绿色通道订金";
}else{if(f.cashType=="cod"){d="货到付款";}else{if(f.cashType=="free"){d="免费已付";}}}}}}return d;}},{name:"shipName",width:100},{name:"scTrackingNo",width:120},{name:"returnShipName",index:"return_ship_name_",width:100},{name:"returnScTrackingNo",width:100,index:"return_sc_tracking_no_"},{name:"totalAmount",index:"total_amount_",width:80,formatter:function(c){return parseFloat(c).toFixed(2);
}},{name:"placerName",width:90,index:"entity.placer_id_",formatter:function(c,d,e){if($(window).width()<1024){return e.placerAid+"<br>"+c;}else{return e.placerAid+":"+c;
}}},{name:"prodNames",width:120,sortable:false,formatter:function(c){var d='<span  style="color:#1ab394;'+(a.simpleShowProduct?"":"display:none")+'" class="tooltip-product fa fa-bell" data-toggle="tooltip"  data-placement="right" title="'+c+'"></span>';
d+='<span style="'+(a.simpleShowProduct?"display:none":"")+'" class="product-detail">'+c+"</span>";return d;}},{name:"placerAid",width:120,hidedlg:true,hidden:true},{name:"lastFollow",width:120,sortable:false},{name:"createTime",width:110,index:"entity.create_time_",formatter:function(c){return DateUtils.miniTime(c);
}},{name:"shipTime",width:110,index:"entity.ship_time_",formatter:function(c){return DateUtils.miniTime(c);}},{name:"updateTime",width:110,hidden:b.grid=="#soRejectingGrid"?true:false,formatter:function(c){return DateUtils.miniTime(c);
}},{name:"cashType",width:120,hidedlg:true,hidden:true},{name:"__manage",width:40,classes:"rowOps",sortable:false,align:"center",formatter:"manage",formatoptions:this._getManagerBtns()}],footerrow:true,userDataOnFooter:true,gridComplete:function(){var c=$(b.grid).parents(".jqGrid_wrapper").find(".ui-jqgrid-sdiv").find("tr.footrow");
c.find("td").hide();c.find('td[aria-describedby*="_soNoShow"]').show();c.find("td").css({"font-weight":400});$(window).resize();}});},_initDProdJqgrid:function(b){var a=this;
$(b.grid).JTJqgrid({url:b.url,pager:b.pager,postData:b.searchParam,colNames:["订单编号","单号","sku编码","产品名称","产品金额","入库数量","入库仓库","入库时间"],colModel:[{name:"soNo",index:"so_no_",width:120},{name:"soNoShow",width:120,hidden:true},{name:"skuKey",index:"selectitem.sku_key_",width:120,},{name:"prodName",index:"selectitem.prod_name_",width:200,},{name:"totalAmount",index:"total_amount_",width:100,},{name:"count",index:"count_",width:100},{name:"storeName",width:100},{name:"updateTime",width:90,index:"entity.inbound_time_",formatter:function(d){var c="<span title='"+d+"'>"+DateUtils.mini2Time(d)+"</span>";
return c;}},],footerrow:true,userDataOnFooter:true,gridComplete:function(){var e=$(b.grid).parents(".jqGrid_wrapper").find(".ui-jqgrid-sdiv").find("tr.footrow");
e.find("td").hide();e.find('td[aria-describedby*="soNoShow"]').show();e.find("td").css({"font-weight":400});var d=$(b.grid).parents(".jqGrid_wrapper").find(".ui-jqgrid-hdiv").find("table");
var c=$(b.grid).parents(".jqGrid_wrapper").find(".ui-jqgrid-bdiv").find("table");$(window).resize();}});},_initTProdJqgrid:function(b){var a=this;$(b.grid).JTJqgrid({url:b.url,pager:b.pager,postData:b.searchParam,colNames:["单号","sku编码","产品名称","产品金额","入库数量","入库仓库"],colModel:[{name:"soNoShow",width:120,hidden:true},{name:"skuKey",index:"selectitem.sku_key_",width:120,},{name:"prodName",index:"selectitem.prod_name_",width:200,},{name:"totalAmount",index:"total_amount_",width:100,},{name:"count",index:"count_",width:100,},{name:"storeName",width:100}],footerrow:true,userDataOnFooter:true,gridComplete:function(){var e=$(b.grid).parents(".jqGrid_wrapper").find(".ui-jqgrid-sdiv").find("tr.footrow");
e.find("td").hide();e.find('td[aria-describedby*="soNoShow"]').show();e.find("td").css({"font-weight":400});var d=$(b.grid).parents(".jqGrid_wrapper").find(".ui-jqgrid-hdiv").find("table");
var c=$(b.grid).parents(".jqGrid_wrapper").find(".ui-jqgrid-bdiv").find("table");$(window).resize();},});}};