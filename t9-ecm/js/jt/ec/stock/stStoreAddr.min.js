function StStoreAddr(){this.hadInit=false;this.receiveAddr=new AddressService(StStoreAddr._CONS_.RECEIVE_ADDR_CONTAINER);this.sendAddr=new AddressService(StStoreAddr._CONS_.SEND_ADDR_CONTAINER);
}StStoreAddr._CONS_={GET_EMP_PHONE_URL:ctx+"/crm/ou/employee/getEmpPhone.htm",RECEIVE_ADDR_CONTAINER:"receiveAddrForm_cateContainer",SEND_ADDR_CONTAINER:"sendAddrForm_cateContainer",RECEIVE_FORM_ID:"receiveAddrForm",SEND_FORM_ID:"sendAddrForm",};
StStoreAddr.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindFormValidation();this._bindEventHander();}},clear:function(){FormUtils.clear(StStoreAddr._CONS_.RECEIVE_FORM_ID);
FormUtils.enableForm(StStoreAddr._CONS_.RECEIVE_FORM_ID);FormUtils.clear(StStoreAddr._CONS_.SEND_FORM_ID);FormUtils.enableForm(StStoreAddr._CONS_.SEND_FORM_ID);
$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID).find(":input").removeAttr("disabled");$("#"+StStoreAddr._CONS_.SEND_FORM_ID).find(":input").removeAttr("disabled");
$(".nav.nav-tabs li").eq(0).find("a").trigger("click");},loadData:function(c,b){var a=this;if(c){$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=partyId]").val(c.id);
$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=partyId]").val(c.id);if(c.receiveAddr){a._loadReceiveAddrData(c.receiveAddr,b);}else{a.receiveAddr.init();
}if(c.sendAddr){a._laodSendAddrData(c.sendAddr,b);}else{a.sendAddr.init();}}else{a.receiveAddr.init();a.sendAddr.init();}},_loadReceiveAddrData:function(b,a){var c="#"+StStoreAddr._CONS_.RECEIVE_FORM_ID;
$(c+" input[name=id]").val(b.id);$(c+" textarea[name=addr]").val(b.addr);$(c+" input[name=name]").val(b.name);$(c+" input[name=zipcode]").val(b.zipcode);
$(c+" input[name=mobile]").val(b.mobile);$(c+" input[name=email]").val(b.email);$(c+" input[name=createBy]").val(b.createBy);if(a){$(c).find(":input").attr("disabled","disabled");
}else{$(c).find(":input").removeAttr("disabled");}this.receiveAddr.init({province:b.prRid,city:b.ciRid,area:b.arRid,disabled:a});},_laodSendAddrData:function(b,a){var c="#"+StStoreAddr._CONS_.SEND_FORM_ID;
$(c+" input[name=id]").val(b.id);$(c+" textarea[name=addr]").val(b.addr);$(c+" input[name=name]").val(b.name);$(c+" input[name=zipcode]").val(b.zipcode);
$(c+" input[name=mobile]").val(b.mobile);$(c+" input[name=email]").val(b.email);$(c+" input[name=createBy]").val(b.createBy);if(a){$(c).find(":input").attr("disabled","disabled");
}else{$(c).find(":input").removeAttr("disabled");}this.sendAddr.init({province:b["prRid"],city:b["ciRid"],area:b["arRid"],disabled:a});},getReceiveAddrData:function(){if(this.receiveAddr.isValid()){var a=this.receiveAddr.getAddress();
var b={partyId:$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=partyId]").val(),id:$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=id]").val(),coRid:a.country,coName:a.countryName,prRid:a.province,prName:a.provinceName,ciRid:a.city,ciName:a.cityName,arRid:a.area,arName:a.areaName,isSnapshot:"n",types:"shipping",isDefault:"y",addr:$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" textarea[name=addr]").val(),zipcode:$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=zipcode]").val(),name:$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=name]").val(),mobile:$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=mobile]").val(),email:$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=email]").val(),createBy:$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=createBy]").val(),};
return b;}else{return false;}},getSendAddrData:function(){if(this.sendAddr.isValid()){var a=this.sendAddr.getAddress();var b={partyId:$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=partyId]").val(),id:$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=id]").val(),coRid:a.country,coName:a.countryName,prRid:a.province,prName:a.provinceName,ciRid:a.city,ciName:a.cityName,arRid:a.area,arName:a.areaName,isSnapshot:"n",types:"contact",isDefault:"y",addr:$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" textarea[name=addr]").val(),zipcode:$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=zipcode]").val(),name:$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=name]").val(),mobile:$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=mobile]").val(),email:$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=email]").val(),createBy:$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=createBy]").val(),};
return b;}else{return false;}},_loadReceivePhone:function(a){FormUtils.loadData(StStoreAddr._CONS_.GET_EMP_PHONE_URL+"?employeeId="+a,function(b){if(b.success){$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=mobile]").val(b.msg).trigger("keyup");
}});},_loadSendPhone:function(a){FormUtils.loadData(StStoreAddr._CONS_.GET_EMP_PHONE_URL+"?employeeId="+a,function(b){if(b.success){$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=mobile]").val(b.msg).trigger("keyup");
}});},_bindFormValidation:function(){var a={rules:{},messages:{}};FormUtils.bindFormValidation(StStoreAddr._CONS_.RECEIVE_FORM_ID,a);FormUtils.bindFormValidation(StStoreAddr._CONS_.SEND_FORM_ID,a);
},_bindEventHander:function(){var a=this;$("body").on("click","#receiveAddrForm_selectMgr",function(){var b=0;if(ResUtils.canShow("employeeSelector.button.stock")){b:1;
}var d={isShowAllGroup:b,grantType:"/stock/",callBack:function(e){if(e!=null&&e.length>0){$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID+" input[name=name]").val(e[0].name).trigger("keyup");
a._loadReceivePhone(e[0].id);}}};var c=new EmployeesSelect();c.init(d);});$("body").on("click","#sendAddrForm_selectMgr",function(){var b=0;if(ResUtils.canShow("employeeSelector.button.stock")){b:1;
}var d={isShowAllGroup:b,grantType:"/stock/",isShowAllGroup:b,callBack:function(e){if(e!=null&&e.length>0){$("#"+StStoreAddr._CONS_.SEND_FORM_ID+" input[name=name]").val(e[0].name).trigger("keyup");
a._loadSendPhone(e[0].id);}}};var c=new EmployeesSelect();c.init(d);});},isValid:function(){$(".nav.nav-tabs li").eq(0).find("a").trigger("click");if(!$("#"+StStoreAddr._CONS_.RECEIVE_FORM_ID).valid()){return false;
}$(".nav.nav-tabs li").eq(1).find("a").trigger("click");if(!$("#"+StStoreAddr._CONS_.SEND_FORM_ID).valid()){return false;}return true;}};