$(function(){try{CapsLockUtils.listen($('input[name="password"]'));}catch(c){console.log("Error:CapsLockUtils is not difine!");}$("input[name='account']").focus();
d();$(document).on("keyup",function(e){if(e.keyCode=="13"){$(".login_btn").trigger("click");}});if(errorTime>=3){$("#verifyContainer").slideVerify({type:1,vOffset:5,barSize:{width:"348px",height:"40px",},ready:function(){$("body").data("verify",false);
$(".login_btn").css("cursor","not-allowed");},success:function(){$("body").data("verify",true);if(errorTime<10){$(".login_btn").css("cursor","pointer");
}},error:function(){$("body").data("verify",false);$(".login_btn").css("cursor","not-allowed");}});}function a(g){var e='<div id="loginErrorInfo" class="errorinfo" style="display:none;"><i class="iconfont icon-warn"></i>&nbsp;提示：<span>'+g+"</span></div>";
if($("#loginErrorInfo").length==0){$(".crm-register-layer").append(e).find("#loginErrorInfo").slideDown("fast");}else{$("#loginErrorInfo").find("span").empty().text(g);
}}$(".login_btn").on("click",function(){var g=$("input[name='account']").val();var e=$("input[name='password']").val();var h=$("input[name='userExt']").val();
window.localStorage.setItem("userMenuStr","");window.localStorage.setItem("loginTime",new Date().getTime());window.localStorage.removeItem("openIndexCount");
if(!g){$("#accountContainer").removeClass("actived");$("#accountContainer").addClass("error");$("#accountErrorContainer").show();$("input[name='account']").focus();
a("账号不能为空！");return false;}if(!e){$("#passwordContainer").removeClass("actived");$("#passwordContainer").addClass("error");$("#passwordErrorContainer").show();
$("input[name='password']").focus();a("密码不能为空！");return false;}if(errorTime>=3&&!$("body").data("verify")){return false;}$("#loginForm").submit();});$(document).on("click",".set_ext_btn",function(){$("#userExtContainerLi").stop().slideDown("fast");
$(".set_ext_btn").removeClass("set_ext_btn").addClass("hide_set_ext_btn").children("span").text("隐藏分机");});$(document).on("click",".hide_set_ext_btn",function(){$("#userExtContainerLi").stop().slideUp("fast");
$(".hide_set_ext_btn").removeClass("hide_set_ext_btn").addClass("set_ext_btn").children("span").text("设置分机");$("input[name='userExt']").val("");$("#extErrorInfo").empty().hide();
});$(document).on("focus","input[name='userExt']",function(){$("#loginErrorInfo").empty().hide();});$("input[name='account']").on("change",function(){var e=$(this).val();
if(e){$("#accountContainer").removeClass("error");$("#accountContainer").addClass("actived");$("#accountErrorContainer").hide();}else{$("#accountContainer").removeClass("actived");
$("#accountContainer").addClass("error");$("#accountErrorContainer").show();$(this).focus();}});$("input[name='password']").on("change",function(){var e=$(this).val();
if(e){$("#passwordContainer").removeClass("error");$("#passwordContainer").addClass("actived");$("#passwordErrorContainer").hide();}else{$("#passwordContainer").removeClass("actived");
$("#passwordContainer").addClass("error");$("#passwordErrorContainer").show();$(this).focus();}});function d(){if(loginLimit!=""&&loginLimit!=null){$(".loginLimitTip").show();
var g=new Date(loginLimit.startTime);var e=new Date(loginLimit.endTime);$("#loginStartTime").empty().append(f(g)+" 至 "+f(e));var i=(loginLimit.endTime-loginLimit.now)/1000;
$("#loginLeftTime").empty().append(i+"秒");$("#loginedPerson").empty().append("已登录"+loginLimit.loginedPerson+"人/本周期总可登录"+loginLimit.loginPerson+"人");var h=setInterval(function(){i=i-1;
$("#loginLeftTime").empty().append(i+"秒");if(i<=0){clearTimeout(h);$(".loginLimitTip").hide();}},1000);}}function f(e){return b(e.getHours())+":"+b(e.getMinutes())+":"+b(e.getSeconds());
}function b(e){if(e<10){return"0"+e;}else{return e;}}});(function(){var a=function(c,b){this.$element=c,this.defaults={type:1,vOffset:5,vSpace:5,imgName:["1.jpg","2.jpg"],imgSize:{width:"400px",height:"200px",},blockSize:{width:"50px",height:"50px",},barSize:{width:"400px",height:"40px",},ready:function(){},success:function(){},error:function(){}},this.options=$.extend({},this.defaults,b);
};a.prototype={init:function(){var b=this;this.loadDom();this.options.ready();this.$element[0].onselectstart=document.body.ondrag=function(){return false;
};this.htmlDoms.move_block.on("touchstart",function(c){b.start(c);});this.htmlDoms.move_block.on("mousedown",function(c){b.start(c);});window.addEventListener("touchmove",function(c){b.move(c);
});window.addEventListener("mousemove",function(c){b.move(c);});window.addEventListener("touchend",function(){b.end();});window.addEventListener("mouseup",function(){b.end();
});b.$element.find(".verify-refresh").on("click",function(){b.refresh();});},loadDom:function(){this.img_rand=Math.floor(Math.random()*this.options.imgName.length);
var b="";var c="";if(this.options.type!=1){b+='<div class="verify-img-panel"><div  class="verify-refresh"><i class="iconfont icon-refresh"></i></div><div class="verify-gap"></div></div>';
c='<div  class="verify-sub-block"></div>';}b+='<div class="verify-bar-area"><span  class="verify-msg">向右滑动完成验证</span><div class="verify-left-bar"><span  class="verify-msg"></span><div  class="verify-move-block"><i  class="verify-icon iconfont icon-right"></i>'+c+"</div></div></div>";
this.$element.append(b);this.htmlDoms={gap:this.$element.find(".verify-gap"),sub_block:this.$element.find(".verify-sub-block"),img_panel:this.$element.find(".verify-img-panel"),bar_area:this.$element.find(".verify-bar-area"),move_block:this.$element.find(".verify-move-block"),left_bar:this.$element.find(".verify-left-bar"),msg:this.$element.find(".verify-msg"),icon:this.$element.find(".verify-icon"),refresh:this.$element.find(".verify-refresh")};
this.status=false;this.setSize=this.resetSize(this);this.htmlDoms.gap.css({"width":this.options.blockSize.width,"height":this.options.blockSize.height});
this.htmlDoms.sub_block.css({"width":this.options.blockSize.width,"height":this.options.blockSize.height});this.htmlDoms.img_panel.css({"width":this.setSize.img_width,"height":this.setSize.img_height,"background":"url(images/"+this.options.imgName[this.img_rand]+")","background-size":this.setSize.img_width+" "+this.setSize.img_height});
this.htmlDoms.bar_area.css({"width":this.setSize.bar_width,"height":this.options.barSize.height,"line-height":this.options.barSize.height});this.htmlDoms.move_block.css({"width":this.options.barSize.height,"height":this.options.barSize.height});
this.htmlDoms.left_bar.css({"width":this.options.barSize.height,"height":this.options.barSize.height});this.randSet();},start:function(b){this.htmlDoms.msg.text("");
this.htmlDoms.move_block.css("background-color","#2196F3");this.htmlDoms.left_bar.css({"border-color":"#2196F3","background":"rgba(33, 150, 243, .25)"});
this.htmlDoms.icon.css("color","#fff");b.stopPropagation();this.status=true;},move:function(f){if(this.status){if(!f.touches){var b=f.clientX;}else{var b=f.touches[0].pageX;
}var d=a.prototype.getLeft(this.htmlDoms.bar_area[0]);var c=b-d;if(this.options.type!=1){if(c>=this.htmlDoms.bar_area[0].offsetWidth-parseInt(parseInt(this.options.blockSize.width)/2)-2){c=this.htmlDoms.bar_area[0].offsetWidth-parseInt(parseInt(this.options.blockSize.width)/2)-2;
}}else{if(c>=this.htmlDoms.bar_area[0].offsetWidth-parseInt(parseInt(this.options.barSize.height)/2)+3){this.$element.find(".verify-msg:eq(1)").text("松开验证");
c=this.htmlDoms.bar_area[0].offsetWidth-parseInt(parseInt(this.options.barSize.height)/2)+3;}else{this.$element.find(".verify-msg:eq(1)").text("");}}if(c<=0){c=parseInt(parseInt(this.options.blockSize.width)/2);
}this.htmlDoms.move_block.css("left",c-parseInt(parseInt(this.options.blockSize.width)/2)+"px");this.htmlDoms.left_bar.css("width",c-parseInt(parseInt(this.options.blockSize.width)/2)+"px");
}},end:function(){var c=this;if(this.status){if(this.options.type!=1){var b=parseInt(this.options.vOffset);if(parseInt(this.htmlDoms.gap.css("left"))>=(parseInt(this.htmlDoms.move_block.css("left"))-b)&&parseInt(this.htmlDoms.gap.css("left"))<=(parseInt(this.htmlDoms.move_block.css("left"))+b)){this.htmlDoms.move_block.css("background-color","#5cb85c");
this.htmlDoms.left_bar.css({"border-color":"#5cb85c","background-color":"#fff"});this.htmlDoms.icon.css("color","#fff");this.htmlDoms.icon.removeClass("icon-right");
this.htmlDoms.icon.addClass("icon-check");this.htmlDoms.refresh.hide();this.htmlDoms.move_block.unbind("mousedown touchstart");this.options.success();}else{this.htmlDoms.move_block.css("background-color","#d9534f");
this.htmlDoms.left_bar.css("border-color","#d9534f");this.htmlDoms.icon.css("color","#fff");this.htmlDoms.icon.removeClass("icon-right");this.htmlDoms.icon.addClass("icon-close");
setTimeout(function(){c.htmlDoms.move_block.animate({"left":"0px"},"fast");c.htmlDoms.left_bar.animate({"width":"40px"},"fast");c.htmlDoms.left_bar.css({"border-color":"#ddd"});
c.htmlDoms.move_block.css("background-color","#fff");c.htmlDoms.icon.css("color","#000");c.htmlDoms.icon.removeClass("icon-close");c.htmlDoms.icon.addClass("icon-right");
c.$element.find(".verify-msg:eq(0)").text("向右滑动完成验证");},400);this.options.error();}}else{if(parseInt(this.htmlDoms.move_block.css("left"))>=(parseInt(this.setSize.bar_width)-parseInt(this.options.barSize.height)-parseInt(this.options.vOffset))){this.htmlDoms.move_block.css("background-color","#1ab394");
this.htmlDoms.left_bar.css({"color":"#fff","border-color":"#1ab394","background-color":"rgba(26, 179, 148, .25)"});this.htmlDoms.icon.css("color","#fff");
this.htmlDoms.icon.removeClass("icon-right");this.htmlDoms.icon.addClass("icon-check");this.htmlDoms.refresh.hide();this.htmlDoms.move_block.unbind("mousedown");
this.htmlDoms.move_block.unbind("touchstart");this.$element.find(".verify-msg:eq(1)").text("验证成功");this.htmlDoms.bar_area.css({"border-color":"#1ab394"});
this.options.success();}else{this.htmlDoms.move_block.css("background-color","#d9534f");this.htmlDoms.left_bar.css({"border-color":"#d9534f","background":"rgba(217, 83, 79, .25)"});
this.htmlDoms.icon.css("color","#fff");this.htmlDoms.icon.removeClass("icon-right");this.htmlDoms.icon.addClass("icon-close");setTimeout(function(){c.htmlDoms.move_block.animate({"left":"0px"},"fast");
c.htmlDoms.left_bar.animate({"width":"40px"},"fast");c.htmlDoms.left_bar.css({"border-color":"#ddd"});c.htmlDoms.move_block.css("background-color","#fff");
c.htmlDoms.icon.css("color","#000");c.htmlDoms.icon.removeClass("icon-close");c.htmlDoms.icon.addClass("icon-right");c.$element.find(".verify-msg:eq(0)").text("向右滑动解锁");
},400);this.options.error();}}this.status=false;}},resetSize:function(f){var b,h,g,e;var d=f.$element.parent().width()||$(window).width();var c=f.$element.parent().height()||$(window).height();
if(f.options.imgSize.width.indexOf("%")!=-1){b=parseInt(f.options.imgSize.width)/100*d+"px";}else{b=f.options.imgSize.width;}if(f.options.imgSize.height.indexOf("%")!=-1){h=parseInt(f.options.imgSize.height)/100*c+"px";
}else{h=f.options.imgSize.height;}if(f.options.barSize.width.indexOf("%")!=-1){g=parseInt(f.options.barSize.width)/100*d+"px";}else{g=f.options.barSize.width;
}if(f.options.barSize.height.indexOf("%")!=-1){e=parseInt(f.options.barSize.height)/100*c+"px";}else{e=f.options.barSize.height;}return{img_width:b,img_height:h,bar_width:g,bar_height:e};
},randSet:function(){var c=Math.floor(Math.random()*9+1);var b=Math.floor(Math.random()*9+1);var e=c*parseInt(this.setSize.img_height)/15+parseInt(this.setSize.img_height)*0.1;
var d=b*parseInt(this.setSize.img_width)/15+parseInt(this.setSize.img_width)*0.1;this.$element.find(".verify-img-panel").css("margin-bottom",this.options.vSpace+"px");
this.$element.find(".verify-gap").css({"top":e,"left":d});this.$element.find(".verify-sub-block").css({"top":"-"+(parseInt(this.setSize.img_height)-e+this.options.vSpace+2)+"px","background-image":"url(images/"+this.options.imgName[this.img_rand]+")","background-size":this.setSize.img_width+" "+this.setSize.img_height,"background-position-y":"-"+e+"px","background-position-x":"-"+d+"px"});
},refresh:function(){this.randSet();this.img_rand=Math.floor(Math.random()*this.options.imgName.length);this.$element.find(".verify-img-panel").css({"background":"url(images/"+this.options.imgName[this.img_rand]+")","background-size":this.setSize.img_width+" "+this.setSize.img_height});
this.$element.find(".verify-sub-block").css({"background-image":"url(images/"+this.options.imgName[this.img_rand]+")","background-size":this.setSize.img_width+" "+this.setSize.img_height});
},getLeft:function(b){var c=$(b).offset().left;return c;}};$.fn.slideVerify=function(c,d){var b=new a(this,c);b.init();};})(jQuery,window,document);