function CustomerSelect(){this.hadInit=false;this.isEdit=false;this.layerIndex;this.options={callBack:null,partyId:null,selectedMulti:false,type:"self"};
if(typeof CustomerSelect.initialized=="undefined"){CustomerSelect.initialized=true;CustomerSelect.prototype.init=function(param){var self=this;if(param){if(!param.callBack){param.callBack=self.options.callBack;
}if(!param.selectedMulti){param.selectedMulti=self.options.selectedMulti;}if(!param.type){param.type=self.options.type;}}else{param=self.options;}self._openSelectCustomerDialog(param);
self._bindEventHander();};CustomerSelect.prototype._openSelectCustomerDialog=function(param){var self=this;var contentSB=new StringBuffer();contentSB.append("<div class='wrapper'>");
contentSB.append('<div id="searchFormContainer" class="row" style="margin-top: 5px;margin-right:0px;">');contentSB.append("<div class='col-sm-12'>");contentSB.append("<form role='form' class='form-inline searchCsForm'>");
contentSB.append("<div class='form-group'>");contentSB.append("<input id='searchValue' name='searchValue' class='form-control' placeholder='请输入查询条件'>");
contentSB.append("<div class='radio radio-info radio-inline'><input type='radio' id='csCode' value='csCode' name='searchParam' checked><label for='csCode'>客户编码</label></div>");
contentSB.append("<div class='radio radio-info radio-inline'><input type='radio' id='csName' value='csName' name='searchParam'><label for='csName'>真实姓名</label></div>");
contentSB.append("<div class='radio radio-info radio-inline'><input type='radio' id='phone' value='phone' name='searchParam'><label for='phone'>联系电话</label></div>");
contentSB.append("</div>");contentSB.append("<button style='margin-left: 5px;' class='btn btn-sm btn-outline csSearchBtn btn-primary' type='button'><i class='fa fa-search'></i>搜索</button>");
contentSB.append("</form>");contentSB.append("</div>");contentSB.append("</div>");contentSB.append("<div class='row' style='margin-top: 5px;margin-right:0px;'>");
contentSB.append('<div class="col-sm-12">');contentSB.append('<table id="selectCustomerGridLayer"></table><div id="selectCustomerPagerLayer"></div></div></div>');
contentSB.append("</div>");self.layerIndex=layer.open({type:1,title:"选择客户",maxmin:false,shadeClose:false,btn:["确定","关闭"],area:["700px","400px"],scrollbar:false,content:""+contentSB,success:function(layero,index){self._initJqgrid(param);
},yes:function(index,layero){if(param.callBack){var list=[];var idArr=[];if(param.selectedMulti){idArr=$(CustomerSelect.GRID).jqGrid("getGridParam","selarrrow");
}else{idArr=[$(CustomerSelect.GRID).jqGrid("getGridParam","selrow")];}if(idArr){for(var i=0;i<idArr.length;i++){var rowData=$(CustomerSelect.GRID).jqGrid("getRowData",idArr[i]);
list.push(rowData);}}var res=param.callBack(list);if(res==null||res==""||res==undefined){layer.close(self.layerIndex);}else{return false;}}layer.close(self.layerIndex);
}});};CustomerSelect.prototype._initJqgrid=function(params){var self=this;$.jgrid.defaults.styleUI="Bootstrap";var height=$(".layui-layer-content").height()-$(".ui-jqgrid-pager").outerHeight()-$(".layui-layer-btn").outerHeight()-50;
$(CustomerSelect.GRID).jqGrid({datatype:"json",url:ctx+"/crm/cs/csEntity/listSearchData.htm",height:190,autowidth:true,shrinkToFit:true,rowNum:20,mtype:"POST",viewrecords:true,multiselect:params.selectedMulti,rowList:[10,20,30],colNames:["ID","客户姓名","客户编号","归属工号"],colModel:[{name:"id",width:120,hidedlg:true,hidden:true},{name:"name",width:120},{name:"code",width:120},{name:"employeeAid",width:120,formatter:function(cellvalue,options,rowObject){return rowObject.employeeAid+"："+rowObject.employeeName;
}}],pager:CustomerSelect.PAGER,hidegrid:false,ondblClickRow:function(rowid,iRow,iCol,e){if(params.callBack){var rowData=$(CustomerSelect.GRID).jqGrid("getRowData",rowid);
var list=[{id:rowid,name:rowData["name"]}];var listJson=eval(list);var res=params.callBack(listJson);if(res==null||res==""||res==undefined){layer.close(self.layerIndex);
}else{return false;}}layer.close(self.layerIndex);}});};CustomerSelect.prototype._bindEventHander=function(){var self=this;$(document).on("click",".csSearchBtn",function(){var params=$(this).closest("form").serialize();
JTJqgridUtils.reloadJqgrid(CustomerSelect.GRID,params);});$(document).on("keypress","form.searchCsForm",function(e){if(e.keyCode==13){$(".csSearchBtn").trigger("click");
return false;}});};}}CustomerSelect.GRID="#selectCustomerGridLayer";CustomerSelect.PAGER="#selectCustomerPagerLayer";