function ProdTypeSelect(){this.hadInit=false;this.layerIndex;this.callBack;this.changeTree=true;this.isInputSelect=false;this.isInitTree=false;this.options={selectedMulti:false,userId:"",cateTypeKey:"product_catalog",rootKey:"category",};
if(typeof ProdTypeSelect.initialized=="undefined"){ProdTypeSelect.initialized=true;ProdTypeSelect.prototype.init=function(b){var a=this;if(b){a.callBack=b.callBack;
if(b.options!=null){if(b.options.cateTypeKey!=undefined){a.options.cateTypeKey=b.options.cateTypeKey;}if(b.options.rootKey!=undefined){a.options.rootKey=b.options.rootKey;
}}}a._openSelectDialog();};ProdTypeSelect.prototype._openSelectDialog=function(){var a=this;a.layerIndex=layer.open({type:1,title:"选择产品分类",maxmin:false,shadeClose:false,btn:["确定","关闭"],area:["350px","410px"],content:'<ul id="productTypeSelTree" class="ztree" style="width:260px; overflow:auto;"></ul>',success:function(b,c){a._selectTree();
},yes:function(f,c){var d=$.fn.zTree.getZTreeObj("productTypeSelTree");var b=d.getCheckedNodes(true);var j=[];for(var h=0;h<b.length;h++){var e={id:b[h].id,name:b[h].name};
j.push(e);}if(a.callBack){var g=a.callBack(j);if(g==null||g==""||g==undefined){layer.close(a.layerIndex);}}layer.close(a.layerIndex);}});};ProdTypeSelect.prototype._selectTree=function(){var b=this;
if(b.isInitTree){$.fn.zTree.destroy("productTypeSelTree");}var e=null;if(b.changeTree){b.changeTree=false;b.isInputSelect=false;e={async:{enable:true,url:ctx+"/gl/cate/cate/loadCateTreeData.htm",contentType:"application/json",dataType:"json",type:"get",autoParam:["id"],otherParam:{cateTypeKey:b.options.cateTypeKey,rootKey:b.options.rootKey,userId:b.options.userId,type:b.options.type?b.options.type:""}},callback:{onClick:d,onDblClick:c,onAsyncSuccess:a},data:{simpleData:{enable:true,idKey:"id",pIdKey:"parentId"}},view:{selectedMulti:b.options.selectedMulti},check:{enable:true,chkStyle:b.options.selectedMulti==true?"checkbox":"radio",chkboxType:{"Y":"","N":""},radioType:"all"},};
}else{return false;}$.fn.zTree.init($("#productTypeSelTree"),e);b.isInitTree=true;function a(){var k=$.fn.zTree.getZTreeObj("productTypeSelTree");var n=k.getNodes();
if(n&&n.length){var m=k.getNodes()[0];k.expandNode(m,true,false,true);}if(b.options.noShowIds!=null&&b.options.noShowIds!==""){var f=$.fn.zTree.getZTreeObj("productTypeSelTree");
var o=b.options.noShowIds.split(",");for(var l=0;l<o.length;l++){var h=f.getNodeByParam("id",o[l]);if(h!=null){f.setChkDisabled(h,true);}}}if(b.isInputSelect==true){var j=$.fn.zTree.getZTreeObj("productTypeSelTree");
var g=j.getNodes();for(var l=0;l<g.length;l++){var h=g[l];h.isParent=false;j.updateNode(h);}}}function d(g,j,i){var h=i.getCheckStatus().checked;var f=$.fn.zTree.getZTreeObj("productTypeSelTree");
f.checkNode(i,!h,false);}function c(h,k,j){var i=[];var f={id:j.id,name:j.name};i.push(f);if(b.callBack){var g=b.callBack(i);if(g==null||g==""||g==undefined){layer.close(b.layerIndex);
}}else{layer.close(b.layerIndex);}}};}}