function CascadeCate(b,a,c){if(!(this instanceof CascadeCate)){return new CascadeCate(b,a,c);}if(b==null||b==undefined||!b){throw new Error("cateType不能为空");
}if(a==null||typeof a==undefined||!a){throw new Error("containerId不能为空");}this.cateType=b;this.topCateKey="";this.loadedTopCateFlag=false;this.hadBindChangeHandler=false;
this.containerId="#"+a;this.selectLabelList=c;this.selectedOptions=[];this.cacheMap=new Map();}CascadeCate.prototype={bindEventHandler:function(){var a=this;
if(a.hadBindChangeHandler){return;}a.hadBindChangeHandler=true;$(a.containerId).off("change");$(a.containerId).on("change","select",function(){var b=$(this).val();
var c=$(this).parent().nextAll().remove();if(b){a.loadCate(b);}});},init:function(){this.bindEventHandler();$(this.containerId).empty().append("<label class='col-sm-1 control-label'>所在地区</label>");
if(this.selectedOptions.length==0){this.loadCate("");}else{this.loadCascade();}},setSelectedOptions:function(a){this.selectedOptions=[];this.selectedOptions=this.selectedOptions.concat(a);
},getCascadeParams:function(){var a=[];$(this.containerId).find("select").each(function(){var c=$(this).val();var b=$(this).find("option[value='"+c+"']");
a.push({id:b.attr("idValue"),value:c,name:b.text()});});return a;},checkCascadeParamsHaveVal:function(){var a=true;$(this.containerId).find("select").each(function(){var b=$(this).val();
if(b==null||b==""){a=false;}});return a;},loadCascade:function(){this._recurLoadCate(0);},_recurLoadCate:function(c){var a=this;if(c<a.selectedOptions.length){var b="";
if(c!=0){b=a.selectedOptions[c-1];}a.loadCate(b,function(){c++;if(c<a.selectedOptions.length){a._recurLoadCate(c);}else{var d=0;$(a.containerId).find("select").each(function(){$(this).find("option[value='"+a.selectedOptions[d++]+"']").attr("selected","selected");
});}});}},loadCate:function(d,e){var a=this;var c=this.cacheMap.get(d);if(c!=null){$(a.containerId).append(c);if(e!=null){e();}return;}var b=ctx+"/gl/cate/cate/getCateByCateTypeAndParentId.htm";
b+="?cateType="+a.cateType+"&parentKey="+d;FormUtils.loadData(b,function(j){if(j.success){if(j.msg!=null&&j.msg!=""){var k=new StringBuffer();var h=JSON.parse(j.msg);
if(h&&h.length>0){var f=$(a.containerId).find("select").length;if(f==0){k.append("<div class='col-sm-2' style='display:none;'>");}else{k.append("<div class='col-sm-2' >");
}k.append("<select class='form-control'>");k.append("<option value=''>请选择</option>");for(var g=0;g<h.length;g++){a.topCateKey=h[g].value;if(f==0&&g==0){k.append("<option idValue='"+h[g].id+"' value='"+h[g].value+"'  selected=selected>"+h[g].name+"</option>");
}else{k.append("<option idValue='"+h[g].id+"' value='"+h[g].value+"'>"+h[g].name+"</option>");}}k.append("</select>");k.append("</div>");$(a.containerId).append(k.toString());
if(a.selectedOptions.length==0&&!a.loadedTopCateFlag){a.loadedTopCateFlag=true;a.loadCate(a.topCateKey);}a.cacheMap.put(d,k.toString());if(e!=null){console.log(e);
e();}}}}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}};