function ForcePw(){}ForcePw._CONS_={CHANGE_PASSWORD_URL:ctx+"/crm/ou/user/forcePw.htm",FORM_ID:"forcePwForm"};ForcePw.prototype={init:function(){this._openForcePwView();
this._bindEventHanlder();CapsLockUtils.listen($("#forcePwForm input[name='oldPassword']"));CapsLockUtils.listen($("#forcePwForm input[name='newPassword']"));
},_bindEventHanlder:function(){var a=this;$(document).on("click","#forceChangePwBtn",function(){var b=$("#forcePwForm input[name='oldPassword']").val();
var c=$("#forcePwForm input[name='newPassword']").val();if(b==null||b==""){$("#forcePwForm").find(".errorinfo").empty().append("新密码不能为空");return false;
}if(c==null||c==""){$("#forcePwForm").find(".errorinfo").empty().append("重复确认密码不能为空");return false;}if(b!=c){$("#forcePwForm").find(".errorinfo").empty().append("两次密码不相同！请重新确认");
return false;}if(b.length<5||c.length<5){$("#forcePwForm").find(".errorinfo").empty().append("密码位数不能小于5！");return false;}$("#forcePwForm").find(".errorinfo").empty();
a._changePw(b,c);});$(document).unbind("keyCode");$(document).on("keyup",function(b){if(b.keyCode=="13"){$("#forceChangePwBtn").trigger("click");}});},_changePw:function(b,d){var a=this;
$("#forcePwForm input[name='userId']").val(currentUserId);var c=$("#"+ForcePw._CONS_.FORM_ID).serialize();FormUtils.submit(ForcePw._CONS_.CHANGE_PASSWORD_URL,c,function(e){if(e.success){a._openReLoginTipView();
}else{DialogUtils.error("失败",e.msg);}},function(){DialogUtils.error("错误","后台异常，请稍后重试");});},_openForcePwView:function(){var c=document.body.clientWidth;
var a=document.body.clientHeight;var b=this;b.layerIndex=layer.open({type:1,title:"",shade:0.8,shadeClose:false,closeBtn:0,btn:"",area:[document.body.clientWidth+"px",document.body.clientHeight+"px"],content:$(".forcePwTip"),success:function(d,e){$("#forcePwForm input[name='oldPassword']").val("");
$("#forcePwForm input[name='newPassword']").val("");},yes:function(e,d){},cancel:function(){}});},_openReLoginTipView:function(){var a=this;a.layerIndex=layer.open({type:1,title:"",shadeClose:false,scrollbar:false,closeBtn:0,btn:["确定"],area:["350px","200px"],content:$(".forcePwSuccessTip"),success:function(b,c){$(document).unbind("keyCode");
$(document).on("keyup",function(d){if(d.keyCode=="13"){window.location.href=ctx+"/logout.htm";}});},yes:function(c,b){window.location.href=ctx+"/logout.htm";
},cancel:function(){}});},};