var actionCode={CREATE:"CREATE",DELETE:"DELETE",UPDATE:"UPDATE"};var createLoadingFunc=function(){if($("#loading").length===0){var a="<div id='loading'>            <span></span>            <span></span>            <span></span>            <span></span>            <span></span>        </div>";
$("body").append(a);window.loadingCount=1;}else{window.loadingCount+=1;}};var removeLoadingFunc=function(){if(window.loadingCount>1){window.loadingCount-=1;
}else{window.loadingCount=0;$("#loading").remove();}};var msgCode={DELETE_MSG:"删除成功",UPDATE_MSG:"更新成功",CREATE_MSG:"添加成功",ERROR_MSG:"后台异常，请稍候重试",SUCCESS_MSG:"操作成功",FAIL_MSG:"失败",INFO:"提示",DANGER:"严重",WARING:"警告",ERROR:"错误",SUCCESS:"成功",MESSAGE:"信息",DELETE_TITLE:"您确定要删除这条信息吗",DELETE_TEXT:"删除后将无法恢复，请谨慎操作！",ERROR_EDIT_MUL_RECORD:"不能同时编辑多条记录",ERROR_DETAIL_MUL_RECORD:"不能同时查看多条记录明细",ERROR_NO_SELECT_EDIT:"请选择要编辑的记录",ERROR_NO_SELECT_DETAIL:"请选择要查看明细的记录",ERROR_NO_SELECT_DELETE:"请选择要删除的记录",EXIT_WARNING_TITLE:"您确定要取消吗",EXIT_WARNING_TEXT:"取消后，修改的数据将无效",EXIT_BTN_TEXT:"退出",CANCEL_BTN_TEXT:"取消",CONFIRM_BTN_TEXT:"确认",EDIT_BTN_TEXT:"编辑",CREATE_BTN_TEXT:"添加",DETAIL_BTN_TEXT:"明细",DELETE_BTN_TEXT:"删除",SHOW_MORE_LOG:"显示更多日志",NO_DATA:"没有数据，请稍候重试"};
function StringBuffer(){this.strs=[];if(typeof StringBuffer._initialized=="undefined"){StringBuffer._initalized=true;StringBuffer.prototype.append=function(a){this.strs.push(a);
return this;};StringBuffer.prototype.toString=function(a){if(!a){a="";}return this.strs.join(a);};}}function Map(){this.elements=new Array();if(typeof Map._initialized=="undefined"){Map._initialized=true;
Map.prototype.size=function(){return this.elements.length;};Map.prototype.isEmpty=function(){return this.elements.length==0;};Map.prototype.clear=function(){this.elements=new Array();
};Map.prototype.put=function(b,d){if(b==null||d==null){throw TypeError();}var c=false;if(this.isEmpty()){this.elements.push({"key":b,"value":d});}else{for(var a=0;
a<this.elements.length;a++){if(this.elements[a].key==b){this.elements[a].value=d;c=true;}}if(!c){this.elements.push({"key":b,"value":d});}}};Map.prototype.get=function(b){if(b==null){throw TypeError();
}if(this.isEmpty()){return null;}for(var a=0;a<this.elements.length;a++){if(this.elements[a].key==b){return this.elements[a].value;}}return null;};Map.prototype.remove=function(b){if(b==null){throw TypeError();
}if(this.isEmpty()){return false;}for(var a=0;a<this.elements.length;a++){if(this.elements[a].key==b){this.elements.splice(a,1);return true;}}return false;
};Map.prototype.containsKey=function(b){if(b==null){throw TypeError();}if(this.isEmpty()){return false;}for(var a=0;a<this.elements.length;a++){if(this.elements[a].key==b){return true;
}}return false;};Map.prototype.containsValue=function(b){if(b==null){throw TypeError();}if(this.isEmpty()){return false;}for(var a=0;a<this.elements.length;
a++){if(this.elements[a].value==b){return true;}}return false;};Map.prototype.keys=function(){if(this.isEmpty()){return[];}var b=new Array();for(var a=0;
a<this.elements.length;a++){b.push(this.elements[a].key);}return b;};Map.prototype.values=function(){if(this.isEmpty()){return[];}var a=new Array();for(var b=0;
b<this.elements.length;b++){a.push(this.elements[b].value);}return a;};Map.prototype.toString=function(){if(this.isEmpty()){return"[{}]";}var b=new StringBuffer();
b.append("[");for(var a=0;a<this.elements.length;a++){b.append("{").append(this.elements[a].key).append(",").append(this.elements[a].value).append("}");
if(a!=this.elements.length-1){b.append(",");}}b.append("]");return b.toString();};}}function Collection(){this.elements=new Array();if(typeof Collection._initialized=="undefined"){Collection._initialized=true;
Collection.prototype.add=function(a){if(a==null){throw TypeError();}this.elements.push(a);return true;};Collection.prototype.addAll=function(a){if(a==null){throw TypeError();
}this.elements=this.elements.concat(a);return true;};Collection.prototype.get=function(a){this._checkIndex(a);if(this.isEmpty()){return null;}return this.elements[a];
};Collection.prototype.removeIndex=function(a){this._checkIndex(a);this.elements.splice(a,1);};Collection.prototype.removeObj=function(b){if(this.isEmpty()){return false;
}for(var a=0;a<this.elements.length;a++){if(this.elements[a]==b){this.elements.splice(a-1,1);}}};Collection.prototype.contains=function(b){if(b==null){throw TypeError();
}if(this.isEmpty()){return false;}for(var a=0;a<this.elements.length;a++){if(this.elements[a]==b){return true;}}return false;};Collection.prototype.containsAll=function(b){if(b==null){throw TypeError();
}if(b.length>this.elements.length){return false;}for(var a=0;a<b.length;a++){if(this.contains(b[a])==false){return false;}}return true;};Collection.prototype.size=function(){return this.elements.length;
};Collection.prototype.isEmpty=function(){return this.elements.length==0;};Collection.prototype.clear=function(){this.elements=new Array();};Collection.prototype.indexOf=function(b){if(b==null){throw TypeError();
}for(var a=0;a<this.elements.length;a++){if(this.elements[a]==b){return a;}}return -1;};Collection.prototype._checkIndex=function(a){if(a<0||a>=this.elements.length){throw new Error("index must be in [0, "+this.elements.length+")");
}};Collection.prototype.toString=function(b){if(this.isEmpty()){return"";}if(b!=null){return this.elements.join(b);}else{var c=new StringBuffer();c.append("[");
for(var a=0;a<this.elements.length;a++){c.append(this.elements[a]);if(a!=this.elements.length-1){c.append(",");}}c.append("]");return c.toString();}};}}function List(){this.elements=new Array();
if(typeof List._initialized=="undefined"){List._initialized=true;List.prototype.set=function(a,b){this._checkIndex(a);this.elements.splice(a,0,b);return true;
};List.prototype.subList=function(e,b){this._checkIndex(e);this._checkIndex(b);if(e>=b){throw new Error("start must be less than end.");}var a=new Array();
var c=0;for(var d=e;d<b;d++){a[c++]=this.elements[e];}return a;};}}List.prototype=new Collection();function Set(){this.elements=new Array();if(typeof Set._initialized=="undefined"){Set._initialized=true;
Set.prototype.add=function(a){if(this.contains(a)){return false;}else{this.elements.push(a);return true;}};Set.prototype.addAll=function(b){if(b==null){throw new TypeError("objs can't be null");
}for(var a=0;a<b.length;a++){if(this.contains(b[a])){continue;}else{this.elements.push(b[a]);}}};Set.prototype.set=function(a,b){this._checkIndex(a);if(this.contains(b)){return false;
}else{this.elements.splice(a,0,b);return true;}};}}Set.prototype=new Collection();String.prototype.isEmpty=function(){return(this==null||this==undefined||this=="");
};String.prototype.trim=function(){return this.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"");};String.prototype.lTrim=function(){return this.replace(/(^\s*)/g,"");
};String.prototype.rTrim=function(){return this.replace(/(\s*$)/g,"");};String.prototype.endWith=function(c,b){if(c==null||c==""||this.length==0||c.length>this.length){return false;
}var a=this.substring(this.length-c.length);if(b==undefined||b){return a==c;}else{return a.toLowerCase()==c.toLowerCase();}};String.prototype.startWith=function(c,b){if(c==null||c==""||this.length==0||c.length>this.length){return false;
}var a=this.substr(0,c.length);if(b==undefined||b){return a==c;}else{return a.toLowerCase()==c.toLowerCase();}};String.prototype.leftPad=function(f,e){if(!isNaN(e)){var b="";
for(var d=this.length;d<e;d++){b=b.concat(f);}b=b.concat(this);return b;}return null;};String.prototype.rightPad=function(f,e){if(!isNaN(e)){var b=this;
for(var d=this.length;d<e;d++){b=b.concat(f);}return b;}return null;};String.prototype.htmlEncode=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&#34;").replace(/\'/g,"&#39;");
};String.prototype.htmlDecode=function(){return this.replace(/\&amp\;/g,"&").replace(/\&gt\;/g,">").replace(/\&lt\;/g,"<").replace(/\&quot\;/g,"'").replace(/\&\#39\;/g,"'");
};String.prototype.jsonEscape=function(){return this.replace(/\"/g,"&quot;").replace(/\n/g,"&nuot;");};String.prototype.jsonUnescape=function(){return this.replace(/&quot;/g,'"').replace(/&nuot;/g,"\n");
};String.prototype.replaceAll=function(b,a){return this.replace(new RegExp(b,"gm"),a);};String.prototype.getArgs=function(){var a={};if(this.indexOf("?")>-1){var j=this.split("?")[1],d=j.split("&");
for(var b=0,h;h=d[b++];){var g=h.indexOf("=");if(g==-1){continue;}var f=h.substring(0,g),e=h.substring(g+1);e=decodeURIComponent(e);a[f]=e;}}return a;};
String.prototype.format=function(){var b=arguments[0];var a=arguments;var c=b.replace(/\{(\d+)\}/g,function(d,f){var e=parseInt(f)+1;return a[e];});return c;
};Array.prototype.remove=function(b){for(var a=0;a<this.length;a++){if(this[a]===b){this.splice(a,1);a--;}}return this;};Array.prototype.insert=function(a,b){this.splice(a,0,b);
return this;};Array.prototype.unique=function(g){if(!jQuery.isArray(this)){return this;}var c=g||function(k,j){var i=true;for(var h in k){if(!j[h]){return false;
}if(typeof(k[h])==="object"){i=c(k[h],j[h]);}else{if(k[h]!==j[h]){return false;}}}return i;};var b,f=this.slice(0);this.length=0;for(var e=0;e<f.length;
e++){var a=f[e];b=true;for(var d=0;d<this.length;d++){y=this[d];if(c(a,y)){b=false;break;}}if(b){this[this.length]=a;}}return this;};Date.prototype.current=function(){var d=this.getFullYear();
var e=(this.getMonth()+1)<10?(0+""+(this.getMonth()+1)):(this.getMonth()+1);var b=this.getDate()<10?(0+""+this.getDate()):this.getDate();var a=this.getHours()<10?(0+""+this.getHours()):this.getHours();
var c=this.getMinutes()<10?(0+""+this.getMinutes()):this.getMinutes();var f=this.getSeconds()<10?(0+""+this.getSeconds()):this.getSeconds();return d+"-"+e+"-"+b+" "+a+":"+c+":"+f;
};Date.prototype.currentDate=function(){var b=this.getFullYear();var c=this.getMonth()+1;if(c<10){c="0"+c;}var a=this.getDate()<10?(0+""+this.getDate()):this.getDate();
return b+"-"+c+"-"+a;};if(!String.prototype.startWith){String.prototype.startWith=function(f,d){if(f==null||f==""||this.length==0||f.length>this.length){return false;
}var e=this.substr(0,f.length);if(d==undefined||d){return e==f;}else{return e.toLowerCase()==f.toLowerCase();}};}if(!String.prototype.startsWith){String.prototype.startsWith=function(f,d){if(f==null||f==""||this.length==0||f.length>this.length){return false;
}var e=this.substr(0,f.length);if(d==undefined||d){return e==f;}else{return e.toLowerCase()==f.toLowerCase();}};}if(!String.prototype.endWith){String.prototype.endWith=function(a){var b=this.length-a.length;
return b>=0&&this.indexOf(a,b)===b;};}if(!String.prototype.endsWith){String.prototype.endsWith=function(a){var b=this.length-a.length;return b>=0&&this.indexOf(a,b)===b;
};}var ButtonUtils={enableBtn:function(a){this._getBtnEle(a).attr("disabled",false);},disableBtn:function(a){this._getBtnEle(a).attr("disabled",true);},_getBtnEle:function(a){var b=jQuery("#"+a);
if(b.length==0){jQuery("button").each(function(){if($(this).hasClass(a)){b=$(this);return false;}});if(b.length==0){throw new Error(a+"指定的按钮不存在");}}return b;
}};var LocalStorageUtils={set:function(a,b){window.localStorage.setItem(a,b);},get:function(a){return window.localStorage.getItem(a);},remove:function(a){window.localStorage.removeItem(a);
}};var DateUtils={timeRangeJudge:function(c,f){var d=c.split(":");if(d.length!=2){DialogUtils.error("提示","禁止下单时段参数格式有误！");return false;}var i=f.split(":");
if(i.length!=2){DialogUtils.error("提示","禁止下单时段参数格式有误！");return false;}var a=new Date();var g=new Date();var h=new Date();a.setHours(d[0]);a.setMinutes(d[1]);
a.setSeconds("59");g.setHours(i[0]);g.setMinutes(i[1]);g.setSeconds("59");if(d[0]<i[0]){if(h.getTime()-a.getTime()>0&&h.getTime()-g.getTime()<0){return true;
}else{console.log("当前时间是："+h.getHours()+":"+h.getMinutes()+"，不在该时间范围内！");return false;}}else{if(d[0]>i[0]){if(h.getTime()-a.getTime()>0){return true;}else{if(h.getTime()-g.getTime()<0){return true;
}else{console.log("当前时间是："+h.getHours()+":"+h.getMinutes()+"，不在该时间范围内！");return false;}}}else{if(h.getTime()-a.getTime()>0){return false;}else{return true;
}}}},format:function(a,b){function c(d,f){var e={"M":d.getMonth()+1,"d":d.getDate(),"H":d.getHours(),"m":d.getMinutes(),"s":d.getSeconds(),"q":Math.floor((d.getMonth()+3)/3),};
f=f.replace(/([yMdHmsqS])+/g,function(i,h){var g=e[h];if(g!==undefined){if(i.length>1){g="0"+g;g=g.substr(g.length-2);}return g;}else{if(h==="y"){return(d.getFullYear()+"").substr(4-i.length);
}else{if(h==="S"){g=d.getMilliseconds();g="00"+g;g=g.substr(g.length-3);return g;}}}return i;});return f;}switch(arguments.length){case 0:return c(new Date(),DateUtils._CONS_.DEFAULT_DATE_TIME_PATTERN);
case 1:if(arguments[0] instanceof Date){return c(arguments[0],DateUtils._CONS_.DEFAULT_DATE_TIME_PATTERN);}else{return c(DateUtils._CONS_.DEFAULT_DATE_TIME_PATTERN,arguments[0]);
}case 2:return c(arguments[0],arguments[1]);}},getChineseWeeks:function(b){if(b===null||b===undefined){b=new Date();}var c=b.getDay()-1;var a="星期";switch(c){case 0:a+="一";
break;case 1:a+="二";break;case 2:a+="三";break;case 3:a+="四";break;case 4:a+="五";break;case 5:a+="六";break;case 6:a+="日";break;}return a;},getEnglishWeeks:function(a){if(a===null||a===undefined){a=new Date();
}var b=a.getDay()-1;switch(b){case 0:return"Monday";case 1:return"Tuesday";case 2:return"Wensday";case 3:return"Thursday";case 4:return"Friday";case 5:return"Saturday";
case 6:return"Sunday";}},getDateDiff:function(e,d,c){if(!c){c="second";}c=c.toLowerCase();var b=new Date(e);var f=new Date(d);var a=1;switch(c){case"second":a=1000;
break;case"minute":a=1000*60;break;case"hour":a=1000*3600;break;case"day":a=1000*3600*24;break;default:break;}return parseInt((f.getTime()-b.getTime())/parseInt(a));
},toChineseTime:function(d){if(d<60){d=d+"秒";return d;}else{if(d>=60&&d<60*60){d=parseInt(d/60)+"分钟"+parseInt(d%60)+"秒";return d;}else{var b=d%60+"秒";var a=parseInt(d/3600)+"小时";
var c=parseInt(parseInt(d%3600)/60)+"分钟";d=a+c+b;return d;}}},toDurationDefaultTime:function(d){if(d<60){if(d<10){d="00:00:0"+d;}else{d="00:00:"+d;}return d;
}else{if(d>=60&&d<60*60){var c=parseInt(d%60);var b=parseInt(d/60);d="00:";if(b<10){d=d+"0"+b+":";}else{d=d+b+":";}if(c<10){d=d+"0"+c;}else{d=d+c;}return d;
}else{var b=d%60;var a=parseInt(d/3600)+":";var c=parseInt(parseInt(d%3600)/60)+":";if(a<10){d="0"+a+":";}else{d=a+":";}if(b<10){d=d+"0"+b+":";}else{d=d+b+":";
}if(c<10){d=d+"0"+c;}else{d=d+c;}return d;}}},getBeforeDate:function(c,a){var b=null;if(!a){b=new Date();}else{b=new Date(a);}b.setDate(b.getDate()-c);
return DateUtils.format(b,DateUtils._CONS_.DEFAULT_DATE_PATTERN);},getBeforeMonth:function(c,a){var b=null;if(!a){b=new Date();}else{b=new Date(a);}b.setMonth(b.getMonth()-c);
return DateUtils.format(b,DateUtils._CONS_.DEFAULT_DATE_PATTERN);},getAfterDate:function(c,a){var c=c;var b=null;if(!a){b=new Date();}else{b=new Date(a);
}b.setDate(b.getDate()+c);return DateUtils.format(b,DateUtils._CONS_.DEFAULT_DATE_PATTERN);},getWeekStartDate:function(){var c=new Date();var f=c.getDay();
var b=c.getDate();var e=c.getMonth();var d=c.getFullYear();var a=new Date(d,e,b-f);return a;},getWeekEndDate:function(){var c=new Date();var f=c.getDay();
var b=c.getDate();var e=c.getMonth();var d=c.getFullYear();var a=new Date(d,e,b+(6-f));return a;},getBeforeDate:function(c,a){var c=c;var b=null;if(!a){b=new Date();
}else{b=new Date(a);}b.setDate(b.getDate()-c);return DateUtils.format(b,DateUtils._CONS_.DEFAULT_DATE_PATTERN);},getCurrentMonthFirst:function(a){var b=null;
if(!a){b=new Date();}else{b=new Date(a);}b.setDate(1);return b;},getCurrentYearPrevDay:function(c,a){var b=new Date();b.setFullYear(b.getFullYear()-c);
b.setDate(b.getDate()+a);return DateUtils.format(b,DateUtils._CONS_.DEFAULT_DATE_PATTERN);},getCurrentMonthLast:function(a){var c=null;if(!a){c=new Date();
}else{c=new Date(a);}var f=c.getMonth();var e=++f;var b=new Date(c.getFullYear(),e,1);var d=1000*60*60*24;return new Date(b-d);},getMonthFirst:function(a,b){return new Date(a,b-1,1);
},getMonthLast:function(a,b){return new Date(a,b,0,23,59,59);},getQuarterFirst:function(a,b){return new Date(a,this.getQuarterStartMonth(b)-1,1);},getQuarterLast:function(a,b){return new Date(a,this.getQuarterStartMonth(b)+2,0,23,59,59);
},getQuarterStartMonth:function(a){switch(a){case 1:return 1;case 2:return 4;case 3:return 7;case 4:return 10;default:return 1;}},getYearFirst:function(a){return new Date(a,0,1);
},getYearLast:function(a){return new Date(a,12,0,23,59,59);},getTimeOptions:function(o){function b(q,i,p){var r="<option value='"+q+"' "+(p?"selected='selected'":"")+" >"+i+"</option>";
return r;}var d=o.selected;var l=o.type;var g=o.noNeedEmptyOption;var n=o.caption?o.caption:"请选择";var f;if(o.container){f=$("#"+o.container);if(f.length==0){f=$("select."+o.container);
if(f.length==0){f=$("select[name='"+o.container+"']");if(f.length==0){throw new Error(o.container+"下拉列表容器不能为空");}}}}var m=new StringBuffer();if(!g){m.append("<option value=''>"+n+"</option>");
}if(l=="year"){var a=new Date();var h=DateUtils.format(a,"yyyy");if(d){if(d/1<=h/1&&d>h/1-10){for(var e=0;e<10;e++){var k=h/1-e;var j=b(k,k+"年",k==d/1);
m.append(j);}}else{for(var e=h/1;e>=d/1;e--){var j=b(e,e+"年",e==d/1);m.append(j);}}}else{for(var e=0;e<10;e++){var k=h/1-e;var j=b(k,k+"年");m.append(j);
}}}else{for(var e=1;e<13;e++){var c=(e<10)?("0"+e):e;m.append('<option value="'+c);m.append('"');if(c==d){m.append(' selected="selected" ');}m.append(" >");
m.append(e+"月");m.append("</option>");}}f.empty().append(m.toString());},miniTime:function(a){if(a){if(a.length>16){return"<span title='"+a+"'>"+a.substring(2,16)+"</span>";
}else{return"<span title='"+a+"'>"+a+"</span>";}}else{return"无";}},mini2Time:function(a){if(a){if(a.length>16){return"<span title='"+a+"'>"+a.substring(5,16)+"</span>";
}else{return"<span title='"+a+"'>"+a+"</span>";}}else{return"无";}},mini3Time:function(a){if(a){if(a.length>16){return"<span title='"+a+"'>"+a.substring(11,16)+"</span>";
}else{return"<span title='"+a+"'>"+a+"</span>";}}else{return"无";}},mini4Time:function(a){if(a){if(a.length>16){return"<span title='"+a+"'>"+a.substring(5,10)+"</span>";
}else{return"<span title='"+a+"'>"+a+"</span>";}}else{return"无";}},getHourMinuteSecond:function(b){var a=b.substring(0,2);var c=b.substring(3,5);if(c>0){if(c>10){c=c-1;
}else{c="0"+(c-1);}}else{c=59;if(a>10){a=a-1;}else{a="0"+(a-1);}}return a+":"+c+":59";},};DateUtils._CONS_={DEFAULT_DATE_PATTERN:"yyyy-MM-dd",DEFAULT_DATE_TIME_PATTERN:"yyyy-MM-dd HH:mm:ss",DEFAULT_TIME_PATTERN:"HH:mm:ss",DEFAULT_MON_DAY_HOU_MIN_PATTERN:"MM-dd HH:mm",DEFAULT_MON_DAY_PATTERN:"MM-dd",DEFAULT_HOU_MIN_PATTERN:"HH:mm"};
var ResUtils={canShow:function(b){if(!b){return false;}if(window.top.userResList==null||window.top.userResList.length==0){return false;}for(var a=0;a<window.top.userResList.length;
a++){if(window.top.userResList[a]==b){return true;}}return false;},createResTableStr:function(a){var g=new StringBuffer();if(a&&a.length){$("input[name='rootRes']").val(a[0].id);
for(var e=0;e<a[0].subs.length;e++){var h=true;var m=a[0].subs[e];if(m.subs.length){for(var d=0;d<m.subs.length;d++){var l=true;var c=m.subs[d];if(c.type=="menu"){for(var b=0;
b<c.subs.length;b++){var f=c.subs[b];if(h){g.append("<tr>");g.append("<td width='10%' rowspan='"+this._getDeepRowSpan(m)+"'>"+this._createResCheckbox(m)+"</td>");
h=false;}else{g.append("<tr>");}if(l){g.append("<td width='10%' rowspan='"+this._getDeepRowSpan(c)+"'>"+this._createResCheckbox(c)+"</td>");l=false;}g.append("<td width='10%'>"+this._createResCheckbox(f));
if(f.subs.length){g.append("<div>");g.append("<div class='col-sm-1' style='padding:0px;'><i class='glyphicon glyphicon-minus'></i><i class='glyphicon glyphicon-minus'></i></div>");
g.append("<div class='col-sm-11'>");g.append(this._createResButtonCheckbox(f.subs));g.append("</div>");g.append("</div>");}g.append("</td>");g.append("</tr>");
}}else{if(c.type=="url"){if(h){g.append("<tr>");g.append("<td width='10%' rowspan='"+this._getDeepRowSpan(m)+"'>"+this._createResCheckbox(m)+"</td>");h=false;
}else{g.append("<tr>");}g.append("<td width='10%'>"+this._createResCheckbox(c)+"</td>");if(c.subs.length){g.append("<td width='70%'>");g.append(this._createResButtonCheckbox(c.subs));
g.append("</td>");}g.append("</tr>");}}}}}}return g.toString();},_getDeepRowSpan:function(b){if(b.type=="url"){return 1;}else{if(b.subs&&b.subs.length){var c=0;
for(var a=0;a<b.subs.length;a++){if(b.subs[a].type=="menu"){c+=this._getDeepRowSpan(b.subs[a]);}else{if(b.subs[a].type=="url"){c+=1;}}}return c;}}},_createResButtonCheckbox:function(b){var e=new StringBuffer();
e.append('<table style="width:100%">');for(var a=0;a<b.length;a++){if(a%5==0){e.append("<tr>");}e.append('<td width="16%" style="padding:0px;">');if(window.top.resConfigList!=null){var d=0;
var c=window.top.resConfigList;$.each(c,function(f,g){if(b[a].code==c[f]){e.append('<div class="checkbox checkbox-success checkbox-inline '+(b[a].type=="button"?"":"")+'" style="padding-right:0px;margin-right:0px;">');
e.append('<input disabled="disabled" '+(b[a].checked?"checked='checked'":"")+' class="checkRes" parentIdVal="'+b[a].parentId+'" type="checkbox" id="'+b[a].id+'" value="'+b[a].id+'" >');
e.append('<label style="color:#7030A0" checkLable="'+b[a].parentId+'" for="'+b[a].id+'">'+b[a].name+"</label>");e.append('<button class="btn btn-sm btn-primary selectRes" data-id="'+b[a].id+'" style="margin:0 10px; font-weight:bold;">查</button></div>');
d++;}});if(d==0){e.append('<div class="checkbox checkbox-success checkbox-inline '+(b[a].type=="button"?"":"")+'" style="padding-right:0px;margin-right:0px;">');
e.append('<input disabled="disabled" '+(b[a].checked?"checked='checked'":"")+' class="checkRes" parentIdVal="'+b[a].parentId+'" type="checkbox" id="'+b[a].id+'" value="'+b[a].id+'" >');
e.append('<label checkLable="'+b[a].parentId+'" for="'+b[a].id+'">'+b[a].name+"</label>");e.append("</div>");}}else{e.append('<div class="checkbox checkbox-success checkbox-inline '+(b[a].type=="button"?"":"")+'" style="padding-right:0px;margin-right:0px;">');
e.append('<input disabled="disabled" '+(b[a].checked?"checked='checked'":"")+' class="checkRes" parentIdVal="'+b[a].parentId+'" type="checkbox" id="'+b[a].id+'" value="'+b[a].id+'" >');
e.append('<label checkLable="'+b[a].parentId+'" for="'+b[a].id+'">'+b[a].name+"</label>");e.append("</div>");}e.append("</td>");if((a+1)%5==0){e.append("</tr>");
}}e.append("</table>");return e.toString();},_createResCheckbox:function(a){var b=new StringBuffer();b.append('<div class="checkbox checkbox-success checkbox-inline '+(a.type=="button"?"col-sm-2":"")+'" style="padding-right:0px;margin-right:0px;">');
b.append('<input disabled="disabled" '+(a.checked?"checked='checked'":"")+' class="checkRes" parentIdVal="'+a.parentId+'" type="checkbox" id="'+a.id+'" value="'+a.id+'" >');
b.append('<label class="lableOfRes" lableId="'+a.parentId+'"  for="'+a.id+'">'+a.name+"</label>");b.append("</div>");return b.toString();}};FormUtils={submit:function(a,c,j,g,d){var b=null;
if(!d){createLoadingFunc();}var f=function(){if(!d){removeLoadingFunc();}if(g){g();}};var k=function(l){if(!d){removeLoadingFunc();}if(l.security=="filter"&&!l.success){if(l.error=="nologin"){window.top.location=ctx+"/login.htm";
}else{if(l.error=="noauth"){DialogUtils.error(msgCode.ERROR,"您无权限访问");}}return;}if(j){j(l);}};if(c){if(jQuery.type(c)==="object"){var h=new StringBuffer();
var i=true;for(var e in c){if(c[e]){if(i){h.append(e+"="+c[e]);i=false;}else{h.append("&"+e+"="+c[e]);}}}c=h.toString();}}else{c="";}jQuery.post(a,c,k,"json").error(f);
},submitByFormId:function(b,e,d,a,c){FormUtils.submit(b,jQuery("#"+e).serialize(),d,a,c);},del:function(b,c,e,a){var d=jQuery.isArray(c)?c.join(","):c;
FormUtils.submit(b,{ids:d},e,a);},loadData:function(e,g,c,d){var b=e.lastIndexOf("?");var f="";var a=e;if(b!=-1){a=e.substring(0,b);f=e.substring(b+1,e.length);
}FormUtils.submit(a,f,g,c,d);},clear:function(c){var a=null;if(jQuery.type(c)=="string"){if(c.charAt(0)=="#"){a=$(c);}else{a=$("#"+c);}}else{a=c;}if(a.length<=0){console.log(c+"不存在");
return;}a.find("input[type='input']").val("");a.find("input[type='hidden']").val("");a.find(".select2-selection__rendered").text("");a.find("textarea").val("");
a.find("select").val("");a[0].reset();for(var b=0;b<a[0].elements.length;b++){$(document).find("span[data-toggle='tooltip']").each(function(){$(this).tooltip("hide");
});this._clearValidate($(a[0].elements[b]));}},bindFormValidation:function(d,b,c){var a=this;jQuery.validator.setDefaults({highlight:function(g,e,f){if(jQuery(g).is(":radio")||jQuery(g).is(":checkbox")){jQuery(g).parent().parent().addClass("validate_input_error");
}else{jQuery(g).addClass("validate_input_error");if(jQuery(g).attr("validateType")!="default"){jQuery(g).next().next().show();jQuery(g).addClass("validate_grid_input_width");
}}},unhighlight:function(g,e,f){if(jQuery(g).is(":radio")||jQuery(g).is(":checkbox")){jQuery(g).parent().parent().removeClass("validate_input_error");jQuery(g).parent().parent().attr("aria-describedby","");
}else{jQuery(g).attr("aria-describedby","");jQuery(g).removeClass("validate_input_error");jQuery(g).next().tooltip("hide");if(jQuery(g).attr("validateType")!="default"){if(jQuery(g).hasClass("validate_grid_input_width")){jQuery(g).removeClass("validate_grid_input_width");
jQuery(g).next().tooltip("hide");jQuery(g).next().remove();}}}},errorElement:"span",errorPlacement:function(e,f){if(f.attr("validateType")=="default"){a._defErroPlacement(e,f);
}else{a._gridErroPlacement(e,f);}},errorClass:"help-block m-b-none validate_input_span_hide",validClass:"help-block m-b-none"});if(jQuery.type(d)=="string"||jQuery.type(d)=="number"){jQuery("#"+d,c?c:document).validate(b);
}else{d.validate(b);}},_clearValidate:function(a){if(a.is(":radio")||a.is(":checkbox")){a.parent().parent().tooltip("hide");a.parent().parent().removeClass("validate_input_error");
}else{if(a.attr("validateType")=="default"){a.tooltip("hide");a.removeClass("validate_input_error");}else{if(a.next().next().attr("data-toggle")=="validateGridtip"){a.next().next().tooltip("hide");
a.next().next().hide();}if(a.hasClass("validate_input_error")){a.removeClass("validate_input_error");a.addClass("validate_grid_input_width");}}}},_defErroPlacement:function(a,b){if(b.is(":radio")||b.is(":checkbox")){if(a[0].innerHTML){b.parent().parent().attr("data-toggle","validatetip");
b.parent().parent().attr("data-trigger","manual");b.parent().parent().attr("data-placement","bottom");b.parent().parent().attr("data-original-title",a[0].innerHTML);
b.parent().parent().tooltip({template:"<div style='z-index: 9999;' class='tooltip'>"+"<div class='tooltip-arrow' style='left: 50%;'>"+"</div><div class='tooltip-inner validate_erro'></div></div>"}).tooltip("show");
}else{$(b).parent().parent().tooltip("hide");}}else{if(a[0].innerHTML){b.attr("data-toggle","validatetip");b.attr("data-trigger","manual");b.attr("data-placement","bottom");
b.attr("data-original-title",a[0].innerHTML);b.tooltip({template:"<div style='z-index: 9999;' class='tooltip'>"+"<div class='tooltip-arrow' style='left: 50%;'></div>"+"<div class='tooltip-inner validate_erro'></div></div>"}).tooltip("show");
}else{$(b).tooltip("hide");}}},_gridErroPlacement:function(a,b,d){if(b.is(":radio")||b.is(":checkbox")){}else{if(a[0].innerHTML){b.next().tooltip("hide");
b.next().remove();var c=$("<span data-toggle='validateGridtip' data-trigger='manual' data-placement='bottom' data-clickf='false' title='"+a[0].innerHTML+"' style='width:12px;height:12px;display:inline;top:2px;' class='glyphicon glyphicon-question-sign'></span>");
c.appendTo(b.parent());b.addClass("validate_grid_input_width");c.tooltip({template:'<div class="tooltip"><div class="toltip-arrow"></div><div class="tooltip-inner validate_erro" ></div></div>'});
$("[data-toggle='validateGridtip']").click(function(){$(this).tooltip("toggle");});}}},disableForm:function(a){this._getForm(a).find("input,select,textarea").attr("disabled","disabled");
},enableForm:function(a){this._getForm(a).find("input,select,textarea").removeAttr("disabled");},_getForm:function(b){var a;if(b.charAt(0)==="#"){a=jQuery(b);
}else{a=jQuery("#"+b);}if(a.length==0){a=jQuery("form[name='"+b+"']");if(a.length==0){a=jQuery("form."+b);if(a.length==0){throw new Error(b+"指定的表单不存在");
}}}return a;}};var FileUtils={offEventHander:function(){this.hadInit=false;$(document).off("click",".file-box .file");$(document).off("click",".file .deleteFile");
},bindEventHandler:function(a){if(this.hadInit){return;}this.hadInit=true;$(document).on("click",".file-box .file",function(d){var e=$(this).attr("urlVal");
var b=$(this).attr("nameVal");if(e){var c={title:"下载《"+b+"吗》",text:"点击确认，下载该附件",confirmButtonText:"确认",yesFunc:function(){window.location.href=ctx+"/crm/components/upload/download.htm?dname="+b+"&durl="+e;
}};DialogUtils.confirmWithOptions(c);}});$(document).on("click",".file .deleteFile",function(d){d.stopPropagation();var c=this;var b=$(this).attr("idVal");
DialogUtils.confirm(function(){$(c).parent().parent().remove();if(a){a(b);}});});},createFileDivStr:function(b,n){if(!jQuery.isArray(b)){throw new Error("files参数必须为数组");
}this.bindEventHandler();if(b&&b.length>0){var q=new StringBuffer();for(var k=0;k<b.length;k++){var c=b[k].id?b[k].id:"";var t=b[k].url;if(!t){t=b[k].path;
}var a=b[k].name;var r=b[k].createTime;var g=b[k].byteCount;if(!r){var f=new Date();var o=f.getDate();var e=f.getMonth()+1;var p=f.getFullYear();var l=f.getHours();
var i=f.getMinutes();var u=f.getSeconds();r=p+"-"+e+"-"+o+" "+l+":"+i+":"+u;}q.append("<div class='file-box'>").append("<div class='file' nameVal='"+a+"' urlVal='"+t+"'>");
if(!n){q.append("<div idVal='"+c+"' class='jt-file-delete deleteFile' alt='删除按钮'/>");}q.append("<a class='downLoadFile' nameVal='").append(a).append("' urlVal='").append(t).append("' byteCountVal='").append(g).append("' href='javascript:void(0);'>").append("<div class='icon'>").append("<img src='"+ImageUtils.getFileCoverUrl(a)+"'>").append("</div>").append("<div class='file-name' style='padding-top: 10px; padding-bottom:10px; padding-left:3px; padding-right: 3px;'>").append("<span title ='"+a+"' style='display: inline-block; overflow: hidden; height:20px; '>");
if(a.length>12){q.append(a.substring(0,8)+"...."+a.substring(a.lastIndexOf(".")+1,a.length));}else{q.append(a);}q.append("</span>").append("<br>").append("<small>添加时间：").append(r).append("</small>").append("</div>").append("</a>").append("</div>").append("</div>");
}return q.toString();}else{return"";}},createFileDivStrSmall:function(c,n){if(!jQuery.isArray(c)){throw new Error("files参数必须为数组");}this.bindEventHandler();
if(c&&c.length>0){var q=new StringBuffer();for(var k=0;k<c.length;k++){var e=c[k].id?c[k].id:"";var t=c[k].url;var a=c[k].byteCount;if(!t){t=c[k].path;
}var b=c[k].name.replaceAll(" ","");var r=c[k].createTime;if(!r){var g=new Date();var o=g.getDate();var f=g.getMonth()+1;var p=g.getFullYear();var l=g.getHours();
var i=g.getMinutes();var u=g.getSeconds();r=p+"-"+f+"-"+o+" "+l+":"+i+":"+u;$nbsp$nbsp$nbsp;}q.append("<div class='file-box' style='width:151px;margin-right:10px;margin-bottom:10px;'>").append("<div class='file' nameVal='"+b+"' urlVal='"+t+"' style='margin:0px;'>");
q.append("<a class='downLoadFile' nameVal='").append(b).append("' urlVal='").append(t).append("' href='javascript:void(0);'>").append("<div class='file-name' style='padding:5px;width:130px;margin:0px;'>").append("<span style='display: inline-block; overflow: hidden; height:18px;'>").append(b).append("</span>").append("</div>").append("</a>").append("</div>").append("<div style='text-align:center;margin-top:3px;'>").append("<button class='btn btn-white btn-xs kmCopyPath' data-clipboard-text="+t+";"+b+";"+a+"><i class='fa fa-copy'></i>&nbsp;复制</button>&nbsp;&nbsp;").append("<button class='btn btn-white btn-xs previewFile' data-clipboard-text="+t+" fileName="+b+">预览附件</button></div>").append("</div>");
}return q.toString();}else{return"";}},selectFile:function(a,b){layer.open({type:2,title:"选择附件",maxmin:false,shadeClose:true,area:["95%","95%"],scrollbar:false,btn:["确定","取消"],content:ctx+"/gl/systemfile/systemFile/selectSystemFile.htm?isMultiple="+a,yes:function(f,e){var d=layer.getChildFrame("body",f);
var c=[];$(".photo-item-edit",d).each(function(){if($(this).hasClass("photo-item-shadow-red")){var g={};g.id=$(this).attr("value");g.url=$(this).attr("imageUrl");
g.name=$(this).attr("imageName");g.isZoom=$(this).attr("imageIsZoom");g.byteCount=$(this).attr("imageByteCount");c.push(g);}});if(c.length==0){showError("抱歉","您还未选择任何图片");
return;}else{if(b){layer.close(f);b(c);}}}});},};var CateUtils={addOption:function(b){if(b.error==null){b.error=function(){DialogUtils.error("错误","网络连接错误，请稍候重试");
};}var a={typeKey:b.typeKey,key:b.key,pKey:b.pKey,name:b.name,iconUrl:b.iconUrl?b.iconUrl:"",userId:b.userId?b.userId:"",supportColor:b.supportColor?b.supportColor:"",};
FormUtils.submit(ctx+"/gl/cate/cate/addOption.htm",a,function(c){if(c.success){b.success(c);}},b.error);},updateOption:function(c){if(c.error==null){c.error=function(){DialogUtils.error("错误","网络连接错误，请稍候重试");
};}var b={typeKey:c.typeKey,key:c.key,name:c.name,id:c.id,parentId:c.parentId,iconUrl:c.iconUrl?c.iconUrl:"",userId:c.userId?c.userId:""};var a=c.error?c.error:function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
};FormUtils.submit(ctx+"/gl/cate/cate/updateOption.htm",b,function(d){if(c.success){c.success(d);}},a);},deleteOption:function(b){if(b.error==null){b.error=function(){DialogUtils.error("错误","网络连接错误，请稍候重试");
};}var a={typeKey:b.typeKey,key:b.key,};FormUtils.submit(ctx+"/gl/cate/cate/deleteOption.htm",a,function(c){if(b.success){b.success(c);}},b.error);},loadOption:function(b,a){FormUtils.loadData(ctx+"/gl/cate/cate/load.htm?id="+b,function(c){if(a){a(c);
}});},getOptions:function(e){var c=this;var f=e.typeKey+"-"+e.pKey;function b(j,i,k){if(i&&i.length>0){if(j.fn){j.fn(i,k,j);}else{if(k&&k.length){k.empty().append(c._buildOption(j.caption,i,j.selectedOption));
if(j.callBack&&typeof j.callBack=="function"){j.callBack();}}}}else{window.sessionStorage.removeItem(f);DialogUtils.error("错误","该业务健指定的下拉列表没有数据，请前往数据字典中添加数据");
}}if($.isArray(e)){return this._getOptionsArr(e);}else{var h=this._getAndcheckContainer(e);var g=window.sessionStorage.getItem(f);if(g){var a=JSON.parse(g);
b(e,a,h);return;}var d=ctx+"/gl/cate/cate/getOptions.htm";d=d+"?typeKey="+e.typeKey+"&pKey="+e.pKey;FormUtils.loadData(d,function(i){window.sessionStorage.setItem(f,JSON.stringify(i));
b(e,i,h);});}},findCatePos:function(e){var c=this;var f=e.typeKey+"-"+e.pKey;function b(j,i){if(i&&i.length>0){if(j.fn){j.fn(i);}else{if(j.container){h.empty().append(c._buildCateOption(j.caption,i,j.selectedOption));
if(j.callBack&&typeof j.callBack=="function"){j.callBack();}}}}else{window.sessionStorage.removeItem(f);DialogUtils.error("错误","该业务健指定的下拉列表没有数据，请前往数据字典中添加数据");
}}var h=this._getAndcheckContainer(e);var g=window.sessionStorage.getItem(f);if(g){var a=JSON.parse(g);b(e,a);return;}var d=ctx+"/gl/cate/cate/findCatePos.htm";
d=d+"?typeKey="+e.typeKey+"&pKey="+e.pKey;FormUtils.loadData(d,function(i){window.sessionStorage.setItem(f,JSON.stringify(i));b(e,i);});},_getAndcheckContainer:function(a){var b=null;
if(a.container){b=$("#"+a.container);if(b.length==0){b=$("select."+a.container);if(b.length==0){b=$("select[name='"+a.container+"']");if(b.length==0){throw Error(a.container+"容器不存在");
}}}}return b;},_generateCode:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1);};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a());
},_getOptionsArr:function(m){var k=this;var a=[];var g=new Map();for(var h=0;h<m.length;h++){var f=m[h];var i=CateUtils._generateCode();var l=CateUtils._getAndcheckContainer(f);
f["uniqueCode"]=i;f["containerElement"]=l;if(l){var j=f.typeKey+"-"+f.pKey;var d=window.sessionStorage.getItem(j);if(d){g.put(i,JSON.parse(d));}else{var c={uniqueCode:i,typeKey:f.typeKey,key:f.pKey,};
a.push(c);}}}if(!a.length){k._buildOpts(m,g);return;}var e="options="+JSON.stringify(a);var b=ctx+"/gl/cate/cate/getOptionsArr.htm?"+e;FormUtils.loadData(b,function(n){if(n){for(var p in n){g.put(p,n[p]);
}for(var o=0;o<a.length;o++){var q=a[o].typeKey+"-"+a[o].key;var r=n[a[o].uniqueCode];if(q&&r){window.sessionStorage.setItem(q,JSON.stringify(r));}}}k._buildOpts(m,g);
});},_buildOpts:function(d,b){var c=this;for(var e=d.length-1;e>=0;e--){var f=d[e];var a=b.get(f.uniqueCode);if(!a){a=[];}if(f.fn){f.fn(a);}else{if(f.container){f.containerElement.empty().append(c._buildOption(f.caption,a,f.selectedOption,f.emptyOption,f.isMultiple));
if(f.callBack&&typeof f.callBack=="function"){f.callBack();}}}}},_buildOption:function(i,f,c,b,e){var g=new StringBuffer();if(e){g.append("<option value='null'>未填写</option>");
}else{if(b=="noInterests"){g.append("<option value='"+b+"' style='color:red;'>").append("无意向").append("</option>");}else{if(b=="noBizTypes"){g.append("<option value='null' style='color:red;'>").append("无分类").append("</option>");
}else{if(!i){g.append("<option value=''>请选择</option>");}else{g.append("<option value=''>"+i+"</option>");}}}}if(b&&b!="noInterests"&&b!="noBizTypes"){g.append("<option value='"+b+"'>").append("").append("</option>");
}for(var d=0;d<f.length;d++){var h=f[d].value;var a=f[d].name;if(c&&c==h){g.append("<option value='"+h+"' selected='selected'>"+a+"</option>");}else{g.append("<option value='"+h+"'>"+a+"</option>");
}}return g.toString();},_buildCateOption:function(b,a,e){var g=new StringBuffer();if(!b){g.append("<option value=''>请选择</option>");}else{if(b=="noSoType"){}else{g.append("<option value=''>"+b+"</option>");
}}for(var d=0;d<a.length;d++){var f=a[d].key;var c=a[d].name;if(e&&e==f){g.append("<option value='"+f+"' selected='selected'>"+c+"</option>");}else{g.append("<option value='"+f+"'>"+c+"</option>");
}}return g.toString();},selectTreeBox:function(f){var h=f.isMultiple,k=f.selectedIds,p=f.isSelectRoot,g=f.otherParam,d=f.isSmsConfigHtml,c=$("#"+f.container).length>0?$("#"+f.container):$("."+f.container),j=f.treeId,l,o=this,m=function(){var i={edit:{enable:false,showRemoveBtn:false,showRenameBtn:false,},view:{dblClickExpand:false,showLine:true,selectedMulti:false},async:{enable:true,url:f.url,contentType:"application/json",dataType:"json",type:"get",otherParam:g,autoParam:["id"],dataFilter:(f.dataFilter)?f.dataFilter:undefined,},check:{enable:true,chkStyle:h==1?"checkbox":"radio",chkboxType:{"Y":"s","N":"s"},radioType:"all"},data:{simpleData:{enable:true,idKey:"id",pIdKey:"parentId"}},callback:{onAsyncSuccess:function(v,x,w,z){if(f.onAsyncSuccess){f.onAsyncSuccess(v,x,w,z);
}else{if(w==null){var u=l.getNodes()[0];l.expandNode(u,true,false,true);if(k){var w=l.getNodeByParam("id",k);if(w!=null){l.checkNode(w,true,h?true:false,true);
}}}}},beforeClick:function(v,u){if(h&&!d){l.setChkDisabled(u,false,false,true);}l.checkNode(u,!u.checked,h?true:false,true);return false;},beforeCheck:function(v,u){if(h&&u.checked&&!d){l.setChkDisabled(u,false,false,true);
}return true;},onCheck:function(z,x,w){if(h&&!d){l.setChkDisabled(w,w.checked,false,true);l.setChkDisabled(w,false,false,false);}q=l.getCheckedNodes(true),names="",values="",keys="";
for(var v=0,u=q.length;v<u;v++){names+=q[v].name+",";values+=q[v].id+",";keys+=q[v].key+",";}if(names.length>0){names=names.substring(0,names.length-1);
values=values.substring(0,values.length-1);keys=keys.substring(0,keys.length-1);$("#"+f.container).val(names);}else{$("#"+f.container).val("请选择");f.fn("");
}if(f.fn){f.fn(values,keys,names);}}}};l=$.fn.zTree.init($("#"+j),i);};if(c.css("cursor")!="pointer"){c.css("cursor","pointer");}if(!c.attr("title")){c.attr("title","请选择部门");
}if(!c.length){throw new Error("找不到id为"+f.container+"的<input>");}if(!$("#"+j).length){var b=new StringBuffer();b.append('<div id="'+j+'Container" class="ztree-select-layer" style="display:none; position: absolute; background: #fff; border: 1px solid #6394BB;">');
b.append('<ul id="'+j+'" class="ztree" style="margin-top:0; width: 250px;"></ul>');b.append("</div>");$("body").append(b.toString());m();}else{if(f.reinit){$.fn.zTree.destroy(j);
m();}l=$.fn.zTree.getZTreeObj(j);var q=l.getNodesByFilter(function(v){if(k){if(!jQuery.isArray(k)){k=k.split(",");}for(var u=0;u<k.length;u++){if(k[u]==v.id){return true;
}}}else{if(p&&v.level==0){return true;}}return false;},!f.isMultiple);var r=l.getNodes();if(!f.isReDisabled){l.setChkDisabled(r[0],false,false,true);}l.checkAllNodes(false);
if(jQuery.isArray(q)&&q.length){for(var s=0;s<q.length;s++){l.checkNode(q[s],true,f.isMultiple?true:false,true);}}else{if(!jQuery.isArray(q)&&q){l.checkNode(q,true,false);
}else{var a=l.getCheckedNodes(true);if(a&&a.length){for(var s=0;s<a.length;s++){l.checkNode(a[s],false,f.isMultiple?true:false,true);}}}}}(function n(){var v=c.offset();
var u={left:v.left+"px",top:v.top+c.outerHeight()+1+"px","z-index":"1000000000","max-height":"150px","overflow":"auto",};if(f.isEqWidth){var i=c.outerWidth()-1;
if(c<250){i=250;}u["width"]=i+"px";}if(f.isAutoHeight){u["min-height"]="150px";u["max-height"]="350px";u["height"]="auto";}$("#"+j+"Container").css(u).slideDown("fast");
$("body").bind("mousedown",e);})();function t(){$("#"+j+"Container").fadeOut("fast");$("body").unbind("mousedown",e);}function e(i){if(!(i.target.id==f.container||i.target.id==(j+"Container")||$(i.target).parents("#"+j+"Container").length>0)){t();
}}},selectCateTreeBox:function(a){var a={otherParam:{cateTypeKey:a.typeKey,rootKey:a.pKey,selectedCateIds:a.selectedCateIds},reinit:a.reinit,container:a.container,selectedIds:jQuery.isArray(a.selectedCateIds)?a.selectedCateIds.toString():a.selectedCateIds,isMultiple:a.isMultiple,treeId:a.treeId?a.treeId:"menuContentForCate",url:(a.url===null||a.url===""||a.url===undefined)?(ctx+"/gl/cate/cate/loadCateTreeData.htm"):a.url,fn:a.fn,dataFilter:a.dataFilter,};
this.selectTreeBox(a);},selectCate:function(c){var g=c.isMultiple;var a=c.selectedCateIds;var e=c.fn;var f=c.typeKey;var d=c.pKey;var b=layer.open({type:1,title:"选择分类",maxmin:false,shadeClose:true,area:["50%","80%"],btn:["确定","取消"],content:"<ul id='cateTree' class='ztree'></ul>",yes:function(k,h){var n=$.fn.zTree.getZTreeObj("cateTree").getCheckedNodes(true);
var j=[];for(var l=0;l<n.length;l++){var m={id:n[l].id,name:n[l].name,key:n[l].key};j.push(m);}if(e){e(j);}layer.close(k);},success:function(h,j){var i=g==1?"checkbox":"radio";
var k={edit:{enable:true,showRemoveBtn:false,showRenameBtn:false,},view:{dblClickExpand:false,showLine:true,selectedMulti:false},async:{enable:true,url:ctx+"/gl/cate/cate/loadCateTreeData.htm",contentType:"application/json",dataType:"json",type:"get",otherParam:{cateTypeKey:f,rootKey:d,selectedCateIds:a},autoParam:["id"]},check:{enable:true,chkStyle:i,chkboxType:{"Y":"","N":""},radioType:"all"},data:{simpleData:{enable:true,idKey:"id",pIdKey:"parentId"}},callback:{onAsyncSuccess:function(n,p,o,q){if(c.onAsyncSuccess){c.onAsyncSuccess(n,p,o,q);
}else{if(o==null){var m=$.fn.zTree.getZTreeObj("cateTree");var l=m.getNodes()[0];m.expandNode(l,true,false,true);}}}}};$.fn.zTree.init($("#cateTree"),k);
}});}};DialogUtils={confirm:function(b,a){swal({title:msgCode.DELETE_TITLE,text:msgCode.DELETE_TEXT,type:"warning",cancelButtonText:msgCode.CANCEL_BTN_TEXT,showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:msgCode.DELETE_BTN_TEXT,closeOnConfirm:false},function(c){if(c){if(b){b();
swal.close();}}else{if(a){a();swal.close();}}});},confirmWithOptions:function(a){swal({title:a.title==null?msgCode.DELETE_TITLE:a.title,text:a.text==null?msgCode.DELETE_TEXT:a.text,type:a.type==null?"warning":a.type,cancelButtonText:a.cancelButtonText==null?msgCode.CANCEL_BTN_TEXT:a.cancelButtonText,showCancelButton:a.showCancelButton==null?true:a.showCancelButton,confirmButtonColor:a.confirmButtonColor==null?"#DD6B55":a.confirmButtonColor,confirmButtonText:a.confirmButtonText==null?msgCode.DELETE_BTN_TEXT:a.confirmButtonText,closeOnConfirm:a.closeOnConfirm==null?false:a.closeOnConfirm,},function(c){if(c){if(a.yesFunc){a.yesFunc();
var b=(a.isNeedAutoClose==null||a.isNeedAutoClose==undefined)?true:a.isNeedAutoClose;if(b){swal.close();}}}else{if(a.noFunc){a.noFunc();swal.close();}}});
},warning:function(b,a){if(b==null){b=function(){};}if(a==null){a=function(){};}swal({title:msgCode.EXIT_WARNING_TITLE,text:msgCode.EXIT_WARNING_TEXT,type:"warning",cancelButtonText:msgCode.CANCEL_BTN_TEXT,showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:msgCode.EXIT_BTN_TEXT,closeOnConfirm:false},function(c){if(c){if(b){b();
swal.close();}}else{if(a){a();swal.close();}}});},error:function(c,b,a){toastr.options={"closeButton":true,"debug":false,"progressBar":true,"positionClass":"toast-top-right","showDuration":"3000","hideDuration":"500","timeOut":"2000","extendedTimeOut":"1000","showEasing":"swing","hideEasing":"linear","showMethod":"fadeIn","hideMethod":"fadeOut"};
if(a){toastr.options.target=a;}if(!b){b=msgCode.SUCCESS_MSG;}if(!c){c=msgCode.INFO;}toastr.error(b,c);},success:function(d,c,b,a){toastr.options={"closeButton":true,"debug":false,"progressBar":true,"positionClass":"toast-top-right","showDuration":a?a*1000:"3000","hideDuration":"500","timeOut":"2000","extendedTimeOut":"1000","showEasing":"swing","hideEasing":"linear","showMethod":"fadeIn","hideMethod":"fadeOut"};
if(!c){c=msgCode.SUCCESS_MSG;}if(!d){d=msgCode.INFO;}if(b){toastr.options.target=b;}toastr.success(c,d);},warning:function(c,b,a){toastr.options={"closeButton":true,"debug":false,"progressBar":true,"positionClass":"toast-top-right","showDuration":"2000","hideDuration":"500","timeOut":"2000","extendedTimeOut":"1000","showEasing":"swing","hideEasing":"linear","showMethod":"fadeIn","hideMethod":"fadeOut"};
if(!b){b=msgCode.SUCCESS_MSG;}if(!c){c=msgCode.INFO;}if(a){toastr.options.target=a;}toastr.warning(b,c);},notice:function(e,c,d,b){var a={"closeButton":true,"debug":false,"progressBar":true,"positionClass":"toast-bottom-right","showDuration":"300","hideDuration":"1000","timeOut":"-1","extendedTimeOut":"1000","showEasing":"swing","hideEasing":"linear","showMethod":"fadeIn","hideMethod":"fadeOut"};
var b=jQuery.extend(a,b);b.onclick=function(){if(d){d();}};toastr.options=b;c="内容："+c;e="标题："+e;if(b&&b.msgType&&b.msgType==msgCode.ERROR){toastr.error(c,e);
}else{if(b&&b.showType&&"warning"==b.showType){toastr.warning(c,e);}else{toastr.success(c,e);}}},};var ImageUtils={offEventHander:function(){$(document).off("click",".icon .viewImageDetail");
$(document).off("click",".file .deleteImage");this.hadInit=false;},bindEventHandler:function(a){if(this.hadInit){return;}this.hadInit=true;$(document).on("click",".icon .viewImageDetail",function(d){d.stopPropagation();
var c=$(this).attr("srcImgUrlVal");var e=$(this).attr("titleVal");$.fancybox.open([{href:c,title:e}]);});var b=ctx+"/gl/image/image/renameImage.htm";$(document).on("dblclick",".renameImage",function(e){var c=this;
var g=$(c).attr("idVal");var f=$(c).attr("imgName");var d={title:"输入名称",content:'<div id="" class="layui-layer-content"><input name="imageNewName" type="text" class="layui-layer-input" value="'+f+'"></div>',yes:function(i,h){var k=$("[name=imageNewName]").val();
if(k==f){layer.close(i);return;}var j={id:g,newName:k};FormUtils.submit(b,j,function(l){if(l.success){$(c).attr("imgName",k);$(c).text(k);layer.close(i);
}else{DialogUtils.error(msgCode.FAIL_MSG,l.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}};layer.open(d);});$(document).on("click",".file .deleteImage",function(d){d.stopPropagation();
var c=this;DialogUtils.confirm(function(){var e=$(c).attr("idVal");if($(c).parents("ul.dragsort").length>0){$(c).parent().parent().parent().remove();}else{$(c).parent().parent().remove();
}if(a){a(e);}});});},createImageDivStr:function(k,i,e,c,b){if(!jQuery.isArray(k)){throw new Error("images参数必须为数组");}this.bindEventHandler();if(k&&k.length>0){var a=new StringBuffer();
for(var r=0;r<k.length;r++){var x=ImageUtils.getUrl(k[r]);var f=ImageUtils.getUrl(k[r]);var v=k[r].name;var o=k[r].createTime;var n=k[r].id?k[r].id:"";
if(!o){var w=new Date();var u=w.getDate();var p=w.getMonth()+1;var g=w.getFullYear();var t=w.getHours();var p=w.getMinutes();var l=w.getSeconds();o=g+"-"+p+"-"+u+" "+t+":"+p+":"+l;
}var q=k[r].path;if(!q){q=k[r].url;}if(i){a.append("<div class='file-box' style='width:150px;'>");}else{a.append("<div class='file-box'>");}a.append("<div class='file' nameVal='"+v+"' urlVal='"+q+"'>").append("<img idVal='"+n+"' class='deleteImage "+(c?"hide":"")+"' src='").append(ctx).append("/img/jt/delete.png' style='display: block; cursor: pointer; position: absolute; right: 0px; width: 30px; height: 30px;' alt='删除按钮'/>").append("<a class='downLoadFile' rel='group' nameVal='").append(v).append("' urlVal='").append(q).append("' href='javascript:void(0);'>").append("<div style='height:auto;' class='icon'>");
if(i){if(b){a.append("<img srcImgUrlVal='"+f+"' style='width:100px; height:100px;' src='"+x+"?dm=_mm'>");}else{a.append("<img class='viewImageDetail' srcImgUrlVal='"+f+"' style='width:100px; height:100px;' src='"+x+"?dm=_mm'>");
}}else{if(b){a.append("<img srcImgUrlVal='"+f+"' style='width:100px; height:100px;' src='"+x+"?dm=_mm'>");}else{a.append("<img class='viewImageDetail' srcImgUrlVal='"+f+"' style='width:100px; height:100px;' src='"+x+"?dm=_mm'>");
}}a.append("</div>");if(e){a.append('<div title="'+v+'" imgName="'+v+'" idVal="'+n+'" class="renameImage" style="position:absolute;width:100%;text-align:center;bottom:0px;padding:0px;marging:0px;background-color:#FFFACD;">');
if(v.length>12){a.append(v.substring(0,8)+"...."+v.substring(v.lastIndexOf(".")+1,v.length));}else{a.append(v);}a.append("</div>");}a.append("</a>");a.append("</div>");
a.append("</div>");}return a.toString();}else{return"";}},getUrl:function(d){this.bindEventHandler();var b=d.path;if(!b){b=d.url;}if(!b){return ctx+"/img/jt/defaulTouXiang.png";
}if(b.indexOf("?")!=-1){b=b.substring(0,b.indexOf("?"));}var a=b.lastIndexOf(".");var c=b.substring(a+1);b=b.replace(/\\/ig,"/");if(b.startsWith("http")){b=b;
}else{b=ctx+b;}return b;},getTrueUrl:function(a){if(a.startsWith("http")){a=a;}else{a=ctx+a;}return a;},getFileCoverUrl:function(b){this.bindEventHandler();
var a="";switch(this._filetype(b)){case"apk":a=ctx+"/img/jt/systemfile/apk.PNG";break;case"cad":a=ctx+"/img/jt/systemfile/cad.PNG";break;case"doc":a=ctx+"/img/jt/systemfile/doc.PNG";
break;case"exe":a=ctx+"/img/jt/systemfile/exe.PNG";break;case"ipa":a=ctx+"/img/jt/systemfile/ipa.PNG";break;case"mm":a=ctx+"/img/jt/systemfile/mm.PNG";
break;case"mmap":a=ctx+"/img/jt/systemfile/mmap.PNG";break;case"pdf":a=ctx+"/img/jt/systemfile/pdf.PNG";break;case"txt":a=ctx+"/img/jt/systemfile/txt.PNG";
break;case"vsd":a=ctx+"/img/jt/systemfile/vsd.PNG";break;case"xls":a=ctx+"/img/jt/systemfile/xls.PNG";break;case"xmind":a=ctx+"/img/jt/systemfile/xmind.PNG";
break;case"zip":a=ctx+"/img/jt/systemfile/zip.PNG";break;case"xlsx":a=ctx+"/img/jt/systemfile/xls.PNG";break;case"mp4":a=ctx+"/img/jt/systemfile/mp4.PNG";
break;case"MP4":a=ctx+"/img/jt/systemfile/mp4.PNG";break;case"mp3":a=ctx+"/img/jt/mp3.png";break;case"amr":a=ctx+"/img/jt/mp3.png";break;case"MP3":a=ctx+"/img/jt/mp3.png";
break;default:a=ctx+"/img/jt/systemfile/txt.PNG";}return a;},_filetype:function(a){if(!a){return"txt";}var b=a.substring(a.lastIndexOf(".")+1,a.length);
return b;},selectImage:function(a,b){layer.open({type:2,title:"选择图片",maxmin:false,shadeClose:true,btn:["确定","取消"],scrollbar:false,area:["90%","85%"],content:ctx+"/gl/image/image/selectImage.htm?isMultiple="+a,yes:function(e,d){var c=layer.getChildFrame("body",e);
var f=[];$(".photo-item-edit",c).each(function(){if($(this).hasClass("photo-item-shadow-red")){var g={};g.id=$(this).attr("value");g.url=$(this).attr("imageUrl");
g.name=$(this).attr("imageName");f.push(g);}});if(f.length==0){showError("抱歉","您还未选择任何文件");return;}else{if(b){layer.close(e);b(f);}}}});},};var JTJqgridUtils={reloadJqgrid:function(d,e,a){var h={};
if(e&&jQuery.type(e)=="string"){e=decodeURIComponent(e,true);var l=e.split("&");if(l.length){for(var g=0;g<l.length;g++){var f=l[g].split("=");if(f.length==2){if(h.hasOwnProperty(f[0])){if(jQuery.type(h[f[0]])=="string"){var c=[];
c.push(h[f[0]]);f[1]=f[1].replaceAll("\\+"," ");c.push(f[1]);h[f[0]]=c;}else{if(jQuery.type(h[f[0]])=="array"){f[1]=f[1].replaceAll("\\+"," ");h[f[0]].push(f[1]);
}}}else{f[1]=f[1].replaceAll("\\+"," ");h[f[0]]=f[1];}}else{if(f.length>2){h[f[0]]=l[g].substring(l[g].indexOf("=")+1).replaceAll("\\+"," ");}}}}}else{h=e;
}var b=$(d).jqGrid("getGridParam","postData");for(var k in b){if(k=="_search"||k=="rows"||k=="page"||k=="sidx"||k=="sord"){continue;}delete b[k];}var j=1;
if(a){j=$(d).getGridParam("page");}b=$.extend(b,h);$(d).jqGrid("setGridParam",{postData:b}).trigger("reloadGrid",[{page:j}]);}};var EnumUtils={getEnumOptions:function(a){a.url=ctx+"/gl/enum/enumopt/getOptions.htm";
return OptionsBaseUtils.getOptions(a);}};JTSubGridUtils={addRowButtons:function(a,d,c){var e=$("#"+a).jqGrid("getDataIDs");for(var b=0;b<e.length;b++){var f=$("#"+a).jqGrid("getRowData",e[b]);
if(f["button"]==""){var g=this.gridButtons(a,e[b],d);if(c){g=c(g,f,a,e[b]);}$("#"+a).jqGrid("setRowData",e[b],{button:g});}}},gridButtons:function(b,d,c){var g="<input  type='button'  value='编辑'   class='"+b+"_rowedit_"+d+" btn btn-primary'  style='margin: 0px 3px 0px 0px;'  onclick='JTSubGridUtils.gridRowEvent(\"edit\",\""+b+'","'+d+"\");'  > ";
var f="<input  type='button'  value='删除'   class='"+b+"_rowdel_"+d+" btn btn-warning'   style='margin: 0px 3px 0px 0px;'    onclick='JTSubGridUtils.gridRowEvent(\"del\",\""+b+'","'+d+"\");'  >";
var e="<input  type='button'  value='确认修改' class='"+b+"_rowcom_"+d+' btn btn-primary\'   onclick=\'JTSubGridUtils.gridRowEvent("save","'+b+'","'+d+"\");' style='margin: 0px 3px 0px 0px;display:none;'   >";
var a="<input  type='button'  value='取消修改' class='"+b+"_rowcanl_"+d+' btn btn-primary\'   onclick=\'JTSubGridUtils.gridRowEvent("cancel","'+b+'","'+d+"\");' style='margin: 0px 3px 0px 0px;display:none;' >";
if(c==true){return f;}else{return g+e+a+f;}},gridRowEvent:function(comm_eventType,comm_gridId,comm_gridRowId){if(comm_eventType=="edit"){$("#"+comm_gridId).editRow(comm_gridRowId);
$("#"+comm_gridId).jqGrid("setRowData",comm_gridRowId,{isGridRowEdit:"Y"});$("."+comm_gridId+"_rowedit_"+comm_gridRowId).css("display","none");$("."+comm_gridId+"_rowdel_"+comm_gridRowId).css("display","none");
$("."+comm_gridId+"_rowcom_"+comm_gridRowId).css("display","inline");$("."+comm_gridId+"_rowcanl_"+comm_gridRowId).css("display","inline");inputChange();
}else{if(comm_eventType=="save"){try{var gridId=comm_gridId.substring(0,1).toUpperCase()+comm_gridId.substring(1);var method=eval("new "+gridId.substring(0,gridId.length-4)+"().validate"+gridId);
if(method(comm_gridId,comm_gridRowId)){$("#"+comm_gridId).jqGrid("saveRow",comm_gridRowId,false);$("#"+comm_gridId).jqGrid("setRowData",comm_gridRowId,{isGridRowEdit:"N"});
$("."+comm_gridId+"_rowedit_"+comm_gridRowId).css("display","inline");$("."+comm_gridId+"_rowdel_"+comm_gridRowId).css("display","inline");$("."+comm_gridId+"_rowcom_"+comm_gridRowId).css("display","none");
$("."+comm_gridId+"_rowcanl_"+comm_gridRowId).css("display","none");}}catch(exception){try{var method=eval("validate"+gridId);if(method(comm_gridId,comm_gridRowId)){$("#"+comm_gridId).jqGrid("saveRow",comm_gridRowId,false);
$("#"+comm_gridId).jqGrid("setRowData",comm_gridRowId,{isGridRowEdit:"N"});$("."+comm_gridId+"_rowedit_"+comm_gridRowId).css("display","inline");$("."+comm_gridId+"_rowdel_"+comm_gridRowId).css("display","inline");
$("."+comm_gridId+"_rowcom_"+comm_gridRowId).css("display","none");$("."+comm_gridId+"_rowcanl_"+comm_gridRowId).css("display","none");}}catch(exception){$("#"+comm_gridId).jqGrid("saveRow",comm_gridRowId,false);
$("#"+comm_gridId).jqGrid("setRowData",comm_gridRowId,{isGridRowEdit:"N"});$("."+comm_gridId+"_rowedit_"+comm_gridRowId).css("display","inline");$("."+comm_gridId+"_rowdel_"+comm_gridRowId).css("display","inline");
$("."+comm_gridId+"_rowcom_"+comm_gridRowId).css("display","none");$("."+comm_gridId+"_rowcanl_"+comm_gridRowId).css("display","none");}}}else{if(comm_eventType=="cancel"){$("#"+comm_gridId).restoreRow(comm_gridRowId);
$("#"+comm_gridId).jqGrid("setRowData",comm_gridRowId,{isGridRowEdit:"N"});$("."+comm_gridId+"_rowedit_"+comm_gridRowId).css("display","inline");$("."+comm_gridId+"_rowdel_"+comm_gridRowId).css("display","inline");
$("."+comm_gridId+"_rowcom_"+comm_gridRowId).css("display","none");$("."+comm_gridId+"_rowcanl_"+comm_gridRowId).css("display","none");}else{if(comm_eventType=="del"){DialogUtils.confirm(function(){$("#"+comm_gridId).delRowData(comm_gridRowId);
hadEdit();});}else{if(comm_eventType=="add"){$("#"+comm_gridId).editRow(comm_gridRowId);$("."+comm_gridId+"_rowedit_"+comm_gridRowId).css("display","none");
$("."+comm_gridId+"_rowdel_"+comm_gridRowId).css("display","inline");$("."+comm_gridId+"_rowcom_"+comm_gridRowId).css("display","inline");$("."+comm_gridId+"_rowcanl_"+comm_gridRowId).css("display","none");
inputChange();}}}}}},addRow:function(a,d){var e=$("#"+a);var c=e.jqGrid().getGridParam("colModel");var b=JSON.stringify(c);if(typeof(d)=="number"){d=d+1;
}e.setGridParam({cellEdit:false});e.jqGrid("addRowData",d,b,"last");gridRowEvent("add",a,d);return d;},delRows:function(a,c){if(c.length<1){DialogUtils.error("提示","请选择要删除的记录");
return;}for(var b=0;b<c.length;b++){$("#"+a).delRowData(c[b]);}}};JTOtherUtils={freeAndshrinkDiv:function(b,c,a){if($("#"+b).size()==0){throw new Error(b+"不存在");
}$("#"+b).slideToggle();var d=$("#"+c).children("i").eq(0);if(d.hasClass("fa-angle-double-down")){d.removeClass("fa-angle-double-down").addClass("fa-angle-double-up");
}else{d.removeClass("fa-angle-double-up").addClass("fa-angle-double-down");}},getcheckValue:function(b){var d=document.getElementsByName(b);var a="";for(var c=0;
c<d.length;c++){if(d[c].checked==true){a+=d[c].value+",";}}if(a!=""){a=a.substring(0,a.length-1);}return a;},listToTree:function(b,g,f){function h(l,m){for(var k=0;
k<l.length;k++){if(l[k][b]==m){return true;}}return false;}var a=[];for(var e=0;e<f.length;e++){var j=f[e];if(!h(f,j[g])){a.push(j);}}var d=[];for(var e=0;
e<a.length;e++){d.push(a[e]);}while(d.length){var c=d.shift();for(var e=0;e<f.length;e++){var j=f[e];if(j[g]==c[b]){if(c.children){c.children.push(j);}else{c.children=[j];
}d.push(j);}}}return a;}};function OptionsBaseUtils(){}OptionsBaseUtils.getOptions=function(options){function _buildOpt(options,datas){if(options.fn){options.fn(datas,selectEle);
}else{if(options.container){var sb=new StringBuffer();if(!options.caption){sb.append("<option value=''>请选择</option>");}else{sb.append("<option value=''>"+options.caption+"</option>");
}for(var i=0;i<datas.length;i++){var value="";var name="";if(options.key&&options.keyName){name=eval("datas[i]."+options.keyName);value=eval("datas[i]."+options.key);
}else{name=datas[i].name;value=datas[i].value;}if(options.selectedOption&&options.selectedOption==value){sb.append("<option value='"+value+"' selected='selected'>"+name+"</option>");
}else{sb.append("<option value='"+value+"'>"+name+"</option>");}}selectEle.empty().append(sb.toString());}}if(options.endFn){options.endFn(selectEle,datas);
}}var selectEle;if(options.container){selectEle=$("#"+options.container);if(selectEle.length==0){selectEle=$("select."+options.container);if(selectEle.length==0){selectEle=$("select[name='"+options.container+"']");
if(selectEle.length==0){throw new Error(options.container+"下拉列表容器不能为空");}}}}var url=(options&&options.url)?options.url:ctx+"/gl/cate/cate/getOptions.htm";
url=url+"?typeKey="+options.typeKey+"&pKey="+options.pKey;var key=options.url+(options.typeKey?options.typeKey:"")+(options.pKey?options.pKey:"");var storageData=window.sessionStorage.getItem(key);
if(storageData){var datas=JSON.parse(storageData);_buildOpt(options,datas);return;}FormUtils.loadData(url,function(datas){if(options.fn){window.sessionStorage.setItem(key,JSON.stringify(datas));
_buildOpt(options,datas);}else{if(datas&&datas.length>0){window.sessionStorage.setItem(key,JSON.stringify(datas));_buildOpt(options,datas);}else{var emptyErrorMsg=options.emptyErrorMsg?options.emptyErrorMsg:"该业务健指定的下拉列表没有数据，请前往数据字典中添加数据";
DialogUtils.error("错误",emptyErrorMsg);}}});};var PhoneEncryptUtils={encryptPhone:function(a){if(a){if(a.length>=11){return a.substring(0,3)+"******"+a.substring(9,a.length);
}else{if(a.length>6&&a.length<11){return a.substring(0,1)+"******"+a.substring(7,a.length);}else{if(a.length>3&&a.length<=6){return a.substring(0,1)+"***"+a.substring(4,a.length);
}}}}return"";}};JTTabUtils={bindEventHandler:function(){var a=this;$("div.page-tabs-content",a._getTopDocument()).on("contextmenu","a.J_menuTab",function(c){if(3==c.which){a.onContextMenuTab=$(this).attr("data-id");
var b=c.clientX-$(".navbar-static-side",a._getTopDocument()).outerWidth(true)-15;var d=c.clientY-$(".navbar-static-top",a._getTopDocument()).outerHeight(true);
if($(this).nextAll("a.J_menuTab").size()>0){$("#context-menu",a._getTopDocument()).find("li[data-action='tab-close-right']").removeClass("disabled");}else{$("#context-menu",a._getTopDocument()).find("li[data-action='tab-close-right']").addClass("disabled");
}if($(this).prevAll("a.J_menuTab").size()>1){$("#context-menu",a._getTopDocument()).find("li[data-action='tab-close-left']").removeClass("disabled");}else{$("#context-menu",a._getTopDocument()).find("li[data-action='tab-close-left']").addClass("disabled");
}if($("a.J_menuTab",a._getTopDocument()).size()>1){$("#context-menu",a._getTopDocument()).find("li[data-action='tab-close-all']").removeClass("disabled");
}else{$("#context-menu",a._getTopDocument()).find("li[data-action='tab-close-all']").addClass("disabled");}if($("a.J_menuTab").size()>3){$("#context-menu",a._getTopDocument()).find("li[data-action='tab-close-other']").removeClass("disabled");
}else{$("#context-menu",a._getTopDocument()).find("li[data-action='tab-close-other']").addClass("disabled");}$("#context-menu",a._getTopDocument()).css({top:d+"px",left:(b+20)+"px",display:"block",});
return false;}});$("div.page-tabs-content",a._getTopDocument()).on("click","a.J_menuTab",function(b){$("#context-menu",a._getTopDocument()).hide();a.showActiveTab($(this).attr("data-id"));
});$("div.page-tabs-content",a._getTopDocument()).on("click",".fa-times-circle",function(b){a.closeTab($(this).parent().attr("data-id"));b.stopPropagation();
});$(".content-tabs",a._getTopDocument()).on("click",".J_tabLeft",function(){a.scrollTabLeft();});$(".content-tabs",a._getTopDocument()).on("click",".J_tabRight",function(){a.scrollTabRight();
});$("div.page-tabs-content",a._getTopDocument()).on("dblclick","a.J_menuTab",function(){a.refreshTab($(this).attr("data-id"));});$(".J_tabShowActive",a._getTopDocument()).on("click",function(){a.showActiveTab($("div.page-tabs-content").find(".active").attr("data-id"));
});$(".J_tabCloseAll",a._getTopDocument()).on("click",function(){a.closeAllTabs();});$(".J_tabCloseOther",a._getTopDocument()).on("click",function(){a.closeOtherTabs();
});$("#context-menu",a._getTopDocument()).on("click","li",function(){if($(this).hasClass("disabled")){return;}var b=$(this).attr("data-action");switch(b){case"tab-refresh":a.refreshTab(a.onContextMenuTab);
break;case"tab-close-right":a.closeRightTabs();break;case"tab-close-left":a.closeLeftTabs();break;case"tab-close-other":a.closeOtherTabs();break;case"tab-close-all":a.closeAllTabs();
break;case"tab-close":a.closeTab(a.onContextMenuTab);break;}$("#context-menu",a._getTopDocument()).hide();});},calTabSumWidth:function(b){var a=0;$(b).each(function(){a+=$(this).outerWidth(true);
});return a;},scrollToTab:function(d){var e=this.calTabSumWidth($(d).prevAll()),g=this.calTabSumWidth($(d).nextAll());var b=this.calTabSumWidth($("div.content-tabs",this._getTopDocument()).children().not("nav.J_menuTabs"));
var a=$("div.content-tabs",this._getTopDocument()).outerWidth(true)-b;var f=0;if($("div.page-tabs-content",this._getTopDocument()).outerWidth()<a){f=0;
}else{if(g<=(a-$(d).outerWidth(true)-$(d).next().outerWidth(true))){if((a-$(d).next().outerWidth(true))>g){f=e;var c=d;while((f-$(c).outerWidth())>($("div.page-tabs-content",this._getTopDocument()).outerWidth()-a)){f-=$(c).prev().outerWidth();
c=$(c).prev();}}}else{if(e>(a-$(d).outerWidth(true)-$(d).prev().outerWidth(true))){f=e-$(d).prev().outerWidth(true);}}}$("div.page-tabs-content",this._getTopDocument()).animate({marginLeft:0-f+"px"},"fast");
},scrollTabLeft:function(){var e=Math.abs(parseInt($("div.page-tabs-content",this._getTopDocument()).css("margin-left")));var b=this.calTabSumWidth($("div.content-tabs",this._getTopDocument()).children().not("nav.J_menuTabs"));
var a=$("div.content-tabs",this._getTopDocument()).outerWidth(true)-b;var f=0;if($("div.page-tabs-content",this._getTopDocument()).width()>a){var c=$("a.J_menuTab:first",this._getTopDocument());
var d=0;while((d+$(c).outerWidth(true))<=e){d+=$(c).outerWidth(true);c=$(c).next();}d=0;if(this.calTabSumWidth($(c).prevAll())>a){while((d+$(c).outerWidth(true))<(a)&&c.length>0){d+=$(c).outerWidth(true);
c=$(c).prev();}f=this.calTabSumWidth($(c).prevAll());}}$("div.page-tabs-content",this._getTopDocument()).animate({marginLeft:0-f+"px"},"fast");},scrollTabRight:function(){var e=Math.abs(parseInt($("div.page-tabs-content",this._getTopDocument()).css("margin-left")));
var b=this.calTabSumWidth($("div.content-tabs",this._getTopDocument()).children().not("nav.J_menuTabs"));var a=$("div.content-tabs",this._getTopDocument()).outerWidth(true)-b;
var f=0;if($("div.page-tabs-content",this._getTopDocument()).width()<a){return false;}else{var c=$("a.J_menuTab:first",this._getTopDocument());var d=0;
while((d+$(c).outerWidth(true))<=e){d+=$(c).outerWidth(true);c=$(c).next();}d=0;while((d+$(c).outerWidth(true))<(a)&&c.length>0){d+=$(c).outerWidth(true);
c=$(c).next();}f=this.calTabSumWidth($(c).prevAll());if(f>0){$("div.page-tabs-content",this._getTopDocument()).animate({marginLeft:0-f+"px"},"fast");}}},showActiveTab:function(c,b){var d=$("div.page-tabs-content",this._getTopDocument()).find("a.J_menuTab[data-id='"+c+"']").eq(0);
if(!d){return;}$("a.J_menuTab",this._getTopDocument()).removeClass("active");d.addClass("active");this.scrollToTab(d);$("div.J_mainContent",this._getTopDocument()).find("iframe.J_iframe").hide();
$("div.J_mainContent",this._getTopDocument()).find("iframe.J_iframe[data-id='"+c+"']").show();if(b){$("div.page-tabs-content",this._getTopDocument()).find("a.J_menuTab[data-id='"+c+"']").empty().append(b+"&nbsp;&nbsp;<i class='fa fa-times-circle'></i>");
}var a=$("div.J_mainContent",this._getTopDocument()).find("iframe.J_iframe[data-id='"+c+"']").contents();if(!a.find(".jt-pager-layer:visible").closest(".ui-jqgrid").is(".behind-grider-checked")){a.find(".jt-pager-layer:visible").closest(".ui-jqgrid").addClass("behind-grider-checked").find(".jt-grid-resizing").trigger("click");
}},refreshTab:function(b,a){this.showActiveTab(b,a);$("div.J_mainContent iframe:visible",this._getTopDocument()).attr("src",b).load();},resetTab:function(b,d,a){this.showActiveTab(b,a);
var c=$("div.page-tabs-content",this._getTopDocument()).find("a.J_menuTab[data-id='"+b+"']").eq(0);c.attr("data-id",d);$("div.J_mainContent iframe:visible",this._getTopDocument()).attr("src",d).attr("data-id",d).load();
},addOrRefreshTab:function(d,c,e,b){if(this._existsTab(d)){if(!$("a.J_menuTab[data-id='"+d+"']",this._getTopDocument()).hasClass("active")){$("a.J_menuTab[data-id='"+d+"']",this._getTopDocument()).addClass("active");
}if(b){this.showActiveTab(d,c);}else{this.refreshTab(d,c);}}else{var f=this._createTabStr(d,c,e);$("a.J_menuTab",this._getTopDocument()).removeClass("active");
$("div.page-tabs-content",this._getTopDocument()).append(f);this.scrollToTab($("a.J_menuTab.active",this._getTopDocument()));var a=$(this._createIframeStr(d));
$(".J_mainContent",this._getTopDocument()).find("iframe.J_iframe",this._getTopDocument()).hide().parents(".J_mainContent").append(a);a.attr("src",a.attr("data-id"));
}},refreshTable:function(b,a,c){if(c){var d=$("iframe[data-id='"+b+"']",this._getTopDocument())[0].contentWindow;this.pn(d,c);}},pn:function(c,b){var a=this;
c[b]();},tbTab:function(b,c){var a=this;},closeTab:function(d,b){if(!d){return;}var g=$("a.J_menuTab[data-id='"+d+"']",this._getTopDocument());if(!g){return;
}var c=g.width();var e=g.hasClass("active");if(e){if(!b){if(g.nextAll("a.J_menuTab",this._getTopDocument()).size()>0){var a=g.next();a.addClass("active");
this.showActiveTab(a.attr("data-id"));var f=parseInt($("div.page-tabs-content",this._getTopDocument()).css("margin-left"));if(f<0){$("div.page-tabs-content",this._getTopDocument()).animate({marginLeft:(f+c)+"px"},"fast");
}g.remove();$('.J_iframe[data-id="'+g.attr("data-id")+'"]',this._getTopDocument()).remove();}else{if(g.prevAll("a.J_menuTab",this._getTopDocument()).size()>0){var a=g.prev();
a.addClass("active");this.showActiveTab(a.attr("data-id"));g.remove();$('.J_iframe[data-id="'+g.attr("data-id")+'"]',this._getTopDocument()).remove();}}}else{g.remove();
$('.J_iframe[data-id="'+g.attr("data-id")+'"]',this._getTopDocument()).remove();}}else{g.remove();$('.J_iframe[data-id="'+g.attr("data-id")+'"]',this._getTopDocument()).remove();
this.scrollToTab($("a.J_menuTab.active",this._getTopDocument()));}},closeAllTabs:function(){$("div.page-tabs-content",this._getTopDocument()).find("a.J_menuTab:gt(0)").remove();
$("div.J_mainContent",this._getTopDocument()).find(".J_iframe:gt(0)").remove();$("div.J_mainContent",this._getTopDocument()).find(".J_iframe:eq(0)").show();
var a=$("div.page-tabs-content",this._getTopDocument()).find("a.J_menuTab").eq(0);a.addClass("active");this.scrollToTab(a);},closeOtherTabs:function(){$("div.page-tabs-content",this._getTopDocument()).find("a.J_menuTab:gt(0)").each(function(){if(!$(this).hasClass("active")){$(this).remove();
}});$("div.J_mainContent",this._getTopDocument()).find(".J_iframe:gt(0)").each(function(){if(!$(this).is(":visible")){$(this).remove();}});},closeLeftTabs:function(){var b=this;
var a=$("div.page-tabs-content",this._getTopDocument());a.find(".active").prevAll("a.J_menuTab").each(function(){if($(this).index()!=0){$("div.J_mainContent",b._getTopDocument()).find(".J_iframe[data-id='"+$(this).attr("data-id")+"']").remove();
$(this).remove();}});},closeRightTabs:function(){var b=this;var a=$("div.page-tabs-content",this._getTopDocument());a.find(".active").nextAll("a.J_menuTab").each(function(){$("div.J_mainContent",b._getTopDocument()).find(".J_iframe[data-id='"+$(this).attr("data-id")+"']").remove();
$(this).remove();});},_existsTab:function(a){return $("a.J_menuTab[data-id='"+a+"']",this._getTopDocument()).length>0;},_createTabStr:function(c,b,d){if(!c){throw new Error("tab的url不能为空");
}if(!d){d="";}var a=new StringBuffer();a.append("<a href='javascript:;' title='"+d+"' class='active J_menuTab' data-id='").append(c).append("'>").append(b).append("&nbsp;&nbsp;<i style='font-size: 16px;' class='fa fa-times-circle'></i></a>");
return a.toString();},_createIframeStr:function(a){if(!a){throw new Error("tab的url不能为空");}var b=new StringBuffer();b.append("<iframe class='J_iframe' name='iframe' width='100%' height='100%' frameborder='0' data-id='").append(a).append("' seamless").append("></iframe>");
return b.toString();},_getTopDocument:function(){return window.top.document;},renameForTab:function(b,a){$(this._getTopDocument()).find('a.J_menuTab[data-id="'+b+'"]').empty().append(a+"&nbsp; &nbsp;<i class='fa fa-times-circle'></i>");
},renameForActiveTab:function(a){$(this._getTopDocument()).find("a.J_menuTab.active").empty().append(a+"&nbsp; &nbsp;<i class='fa fa-times-circle'></i>");
},reSetDataId:function(a,b){$(this._getTopDocument()).find('a.J_menuTab[data-id="'+a+'"]').attr("data-id",b);},};var IframeUtils={resizeHeight:function(c,a){var b=c.height();
if(a+10>b){a=b;}else{a=a+10;}if(!$("#desktopColumnContainer",window.parent.document).length){c.height(a);}}};$(function(){$.validator.addMethod("byteRangeLength",function(value,element,param){var length=value.length;
for(var i=0;i<value.length;i++){if(value.charCodeAt(i)>127){length++;}}return this.optional(element)||(length>=param[0]&&length<=param[1]);},$.validator.format("请确保输入的值在{0}-{1}个字节之间(一个中文字算2个字节)"));
$.validator.addMethod("minByteLength",function(value,element,param){var length=value.length;for(var i=0;i<value.length;i++){if(value.charCodeAt(i)>127){length++;
}}return this.optional(element)||length>=param;},$.validator.format("长度少于{0}个字节(一个中文字算2个字节)"));$.validator.addMethod("maxByteLength",function(value,element,param){var length=value.length;
for(var i=0;i<value.length;i++){if(value.charCodeAt(i)>127){length++;}}return this.optional(element)||length<=param;},$.validator.format("长度超过{0}个字节(一个中文字算2个字节)"));
$.validator.addMethod("phone",function(value,element,param){var paramE=/^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/;if(param){paramE=new RegExp(eval(param));
}return this.optional(element)||(paramE.test(value));},"电话号码格式错误");$.validator.addMethod("qqNum",function(value,element,param){var paramE=/^[1-9]\d{4,9}$/;
if(param){paramE=new RegExp(eval(param));}return this.optional(element)||(paramE.test(value));},"qq号码格式错误");$.validator.addMethod("chrnum",function(value,element,param){var paramE=/^([a-zA-Z0-9]+)$/;
if(param){paramE=new RegExp(eval(param));}return this.optional(element)||(paramE.test(value));},"只能输入数字和字母(字符A-Z, a-z, 0-9)");$.validator.addMethod("chineseStr",function(value,element,param){var paramE=/^[\u4e00-\u9fa5]+$/;
if(param){paramE=new RegExp(eval(param));}return this.optional(element)||(paramE.test(value));},"只能输入中文");$.validator.addMethod("mobile",function(value,element,param){var paramE=/^(((16[0-9]{1})|(14[0-9]{1})|(13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/;
if(param&&param!=true){paramE=new RegExp(eval(param));}return this.optional(element)||(paramE.test(value));},"手机号码格式错误");$.validator.addMethod("email",function(value,element,param){var paramE=/^\w+([\.-]?\w+\*?)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
if(param&&param!=true){paramE=new RegExp(eval(param));}return this.optional(element)||(paramE.test(value));},"邮件地址格式错误");$.validator.addMethod("zipcode",function(value,element){var tel=/^[0-9]{6}$/;
return this.optional(element)||(tel.test(value));},"请正确填写您的邮政编码");$.validator.addMethod("isExistsMob",function(value,element,param){var id=$("input[name='"+param+"']").val();
var flag=false;if(value){$.ajax({type:"GET",url:ctx+"/crm/ou/user/checkIsExistsUserByMob.htm?mobile="+value+"&id="+id,contentType:"application/x-www-form-urlencoded",dataType:"json",async:false,success:function(msg){flag=(!msg);
},error:function(msg){alert("校验失败");}});}else{flag=true;}return this.optional(element)||flag;},"手机号码已存在");$.validator.addMethod("isExistsAccount",function(value,element,param){var id=$("input[name='"+param+"']").val();
var flag=false;if(value){$.ajax({type:"GET",url:ctx+"/crm/ou/user/checkIsExistsUserByAccount.htm?account="+value+"&id="+id,contentType:"application/x-www-form-urlencoded",dataType:"json",async:false,success:function(msg){flag=(!msg);
},error:function(msg){alert("校验失败");}});}else{flag=true;}return this.optional(element)||flag;},"账号已存在");});(function(d,c,b,e){function a(g,f){this.$element=g;
this.rT=true;this.bT=true;this.tw=150;this.endaction=false;this.ns4=b.layers;this.ns6=b.getElementById&&!b.all;this.ie4=b.all;this.toolTipSTYLE="";this.isNotShowImage=false;
this.imageGroup=[];if(f){this.isNotShowImage=f.isNotShowImage;this.imageGroup=f.imageGroup;}}a.prototype={init:function(){this.initToolTips();this.bindEventHanlder();
},getScrollTop:function(){if(c.pageYOffset){return c.pageYOffset;}else{if(b.documentElement&&b.documentElement.scrollTop){return b.documentElement.scrollTop;
}else{if(b.body){return b.body.scrollTop;}}}},getScrollLeft:function(){if(c.pageXOffset){return c.pageXOffset;}else{if(b.documentElement&&b.documentElement.scrollLeft){return b.documentElement.scrollLeft;
}else{if(b.body){return b.body.scrollLeft;}}}},initToolTips:function(){var f=b.getElementById("toolTipLayer");if(f){f.parentNode.removeChild(f);}f=b.createElement("div");
f.id="toolTipLayer";f.style.position="absolute";f.style.display="none";b.body.appendChild(f);if(this.ns4||this.ns6||this.ie4){if(this.ns4){this.toolTipSTYLE=b.toolTipLayer;
}else{if(this.ns6){this.toolTipSTYLE=b.getElementById("toolTipLayer").style;}else{if(this.ie4){this.toolTipSTYLE=b.all.toolTipLayer.style;}}}if(this.ns4){b.captureEvents(Event.MOUSEMOVE);
}else{this.toolTipSTYLE.visibility="visible";this.toolTipSTYLE.display="none";}}},toolTip:function(j,f,g){try{if(arguments.length<1){if(this.ns4){this.toolTipSTYLE.visibility="hidden";
}else{if(!this.endaction){this.toolTipSTYLE.display="none";}if(this.rT){b.all("msg1").filters[1].Apply();}if(this.bT){b.all("msg1").filters[2].Apply();
}b.all("msg1").filters[0].opacity=0;if(this.rT){b.all("msg1").filters[1].Play();}if(this.bT){b.all("msg1").filters[2].Play();}if(this.rT){if(b.all("msg1").filters[1].status==1||b.all("msg1").filters[1].status==0){this.toolTipSTYLE.display="none";
}}if(this.bT){if(b.all("msg1").filters[2].status==1||b.all("msg1").filters[2].status==0){this.toolTipSTYLE.display="none";}}if(!this.rT&&!this.bT){this.toolTipSTYLE.display="none";
}}}else{if(!f){f="#777777";}if(!g){g="#eeeeee";}var h='<table id="msg1" name="msg1" border="0" cellspacing="0" cellpadding="1" bgcolor="'+f+'" class="trans_msg"><td>'+'<table border="1" bordercolor="#9E9E9E" cellspacing="2" cellpadding="3" style="background-color: #fff;" bgcolor="'+g+'"><td><font face="Arial" color="'+f+'" size="-2">'+j+"</font></td></table></td></table>";
if(this.ns4){this.toolTipSTYLE.document.write(h);this.toolTipSTYLE.document.close();this.toolTipSTYLE.visibility="visible";}if(this.ns6){b.getElementById("toolTipLayer").innerHTML=h;
this.toolTipSTYLE.display="block";}if(this.ie4){b.all("toolTipLayer").innerHTML=h;this.toolTipSTYLE.display="block";var k=b.all("msg1").filters[0].opacity;
b.all("msg1").filters[0].opacity=0;if(this.rT){b.all("msg1").filters[1].Apply();}if(this.bT){b.all("msg1").filters[2].Apply();}b.all("msg1").filters[0].opacity=k;
if(this.rT){b.all("msg1").filters[1].Play();}if(this.bT){b.all("msg1").filters[2].Play();}}}}catch(i){}},bindEventHanlder:function(){var h=this,g=d(c).height(),f=d(c).width();
if(!this.hasInit){this.hasInit=true;this.$element.on("mouseenter",function(l){l.stopPropagation();if(!h.isNotShowImage){var k=d(l.target).offset().left,j=d(l.target).offset().top,m=d("#toolTipLayer").outerHeight(),i=d("#toolTipLayer").outerWidth();
if(j+d("#toolTipLayer").outerHeight()>g){j=g-m-10;}else{j=j-m/2;if(j<0){j=10;}}if(k+i>f){k=f-10;}h.toolTipSTYLE.left=(k+50)+"px";h.toolTipSTYLE.top=j+"px";
h.toolTip("<img style='width: 300px; height: 300px;' src='"+d(this).attr("src")+"' alt='原图'>");}else{var k=d(l.target).offset().left+150,j=d(l.target).offset().top,m=d("#toolTipLayer").outerHeight(),i=d("#toolTipLayer").outerWidth();
if(k+i>f){j=j+130;k=k-200;}h.toolTipSTYLE.left=k+"px";h.toolTipSTYLE.top=j+"px";h.toolTip("<img style='width: 300px; height: 300px;' src='"+d(this).attr("src")+"' alt='原图'>");
}}).on("mouseout",function(i){h.toolTip();}).on("click",function(i){if(!h.isNotShowImage){i.stopPropagation();var j=d(this).attr("src");if(j.indexOf("&dm=_mm")!=-1){j=j.substring(0,j.indexOf("&dm=_mm"));
}else{if(j.indexOf("?dm=_mm")!=-1){j=j.substring(0,j.indexOf("?dm=_mm"));}}d.fancybox.open([{href:j,title:""}]);}else{d.fancybox.open(h.imageGroup);}});
}}};d.fn["ImageEnlarge"]=function(g){var f=new a(this,g);return f.init();};})(jQuery,window,document);(function(g,e,a,h){var c=(function(){var i=new StringBuffer();
i.append("<div class='btn-group btn-group-xs'>").append("<button type='button' class='btn btn-primary dropdown-toggle operatorBtn' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>").append("<span class='caret'></span>").append("<span class='sr-only'>Toggle Dropdown</span>").append("</button>").append("</div>");
return i.toString();})();var b={createContextMenuBtn:function(k,l,j,n){var m=new StringBuffer();var i=b.formatBtnClass(l);l=l.replace(i,"");if(l.indexOf("btn")==-1){l+=" btn";
}if(l.indexOf("btn-outline")==-1){l+=" btn-outline";}if(l.indexOf("button-sm")==-1){l+=" btn-sm";}m.append("<li class='").append(i).append("' idVal='").append(n).append("' data-item='edit'>").append("<a href='javascript:void(0);' class='"+l+"'><i class='").append(j).append("'></i>").append(k).append("</a></li>");
return m.toString();},formatBtnClass:function(i){if(!i){return"";}i=i.replace("btn","");i=i.replace("btn-primary","");i=i.replace("btn-success","");i=i.replace("btn-danger","");
i=i.replace("btn-info","");i=i.replace("btn-warning","");i=i.replace("btn-default","");i=i.replace("btn-lg","");i=i.replace("btn-sm","");i=i.replace("btn-xs","");
i=i.replace("btn-outline","");i=i.replace("btn-link","");return i.trim();},createContextMenu:function(o,m,p){var u=m.colModel.formatoptions;var A=new StringBuffer();
A.append("<ul id='jqgrid-context-menu-").append(p.id).append("' class='dropdown-menu rowContextMenu' style='position: absolute; z-index: 199106021; border: 1px solid #1ab394;'>");
for(var t=0;t<u.length;t++){var C=u[t];if(C.switchCol==null){var w=C.btnClasses;var x=C.lable;var z=C.iconClasses;A.append(b.createContextMenuBtn(x,w,z,p.id));
}else{var s=C.switchCol;var B=s.colName;var n=p[B];for(var q=0;q<s.colVals.length;q++){if(n==s.colVals[q]){if(g.type(s.btnClasses[q])=="string"){var l=s.btnClasses?s.btnClasses[q]:"";
var x=s.colLables?s.colLables[q]:"";var z=s.iconClasses?s.iconClasses[q]:"";A.append(b.createContextMenuBtn(x,l,z,p.id));}else{if(g.type(s.btnClasses[q])=="array"&&s.btnClasses[q].length>0){for(var r=0;
r<s.btnClasses[q].length;r++){var l=s.btnClasses?s.btnClasses[q][r]:"";var x=s.colLables?s.colLables[q][r]:"";var z=s.iconClasses?s.iconClasses[q][r]:"";
A.append(b.createContextMenuBtn(x,l,z,p.id));}}}}}}}A.append("</ul>");g("body").append(A.toString());}};g.extend(g.fn.fmatter,{manage:function(k,i,j){b.createContextMenu(k,i,j);
return c;}});var f="JTJqgrid";function d(o,w){var v=this;this.$gridId=o;this._name=f;this._isResize=false;this.autoHideCols=[];this.autoHideCols_1024=[];
this.noDataMsg="没有动态";this.isSearch=false;this.pager=w.pager;w.pager=null;this.minBodyHeight=300;if(w.noDataMsg){this.noDataMsg=w.noDataMsg;}for(var p=0;
p<w.colModel.length;p++){var k=w.colModel[p];var l=k.classes&&k.classes.split(" ");if(l&&l.length){for(var n=0;n<l.length;n++){if(l[n]=="autoHideCol"){w.colModel[p].classes=w.colModel[p].classes.replace("autoHideCol","").trim();
this.autoHideCols.push(k.name);}else{if(l[n]=="autoHideCol_1024"){w.colModel[p].classes=w.colModel[p].classes.replace("autoHideCol_1024","").trim();this.autoHideCols_1024.push(k.name);
}}}}if(w.colModel[p].name==="__manage"){w.colModel[p].hidden=true;}}this._cons={MINI_WIDTH:500,MINI_HEIGHT:300};this.defaults={datatype:"json",mtype:"post",autowidth:true,shrinkToFix:true,multiselect:true,multiselectWidth:30,pagerpos:"center",rownumbers:true,rowNum:50,rowList:[10,20,30,40,50,,100,200,,500,1000,1500],viewrecords:true,hidegrid:false,};
this.options=g.extend({},this.defaults,w);this.rowList=this.options.rowList;var r=null;if(v.options.simplify){r=new ListUtil({"grid":v.$gridId,"options":v.options});
var s=r.readConfig();if(s){g.each(v.options.colModel,function(j,x){if(g.inArray(this.name,s)!=-1){this.hidden=true;}});}}if(g(e).width()>1280){this.options.shrinkToFit=true;
this.options.autoScroll=false;}if(w.loadError){this.options.loadError=function(x,i,j){w.loadError(x,i,j);removeLoadingFunc();};}else{this.options.loadError=function(x,i,j){DialogUtils.error(msgCode.ERROR,"加载失败，请稍后重试");
removeLoadingFunc();};}var m=function(){var C=v.$gridId.closest(".ui-jqgrid");var j=C.find(".ui-jqgrid-pager");var x=C.find(".ui-jqgrid-sdiv");var B=C.hasClass("init");
if(j.length==0||x.length==0){return false;}if(C.find(".jt-pager-layer").length==0){j.prepend("<div class='jt-pager-layer' style='display:none;'></div>");
}C.find(".jt-pager-layer").removeClass("jt-pager-flexed");C.find(".jt-pager-layer").find(".ui-jqgrid-sdiv").remove();j=C.find(".ui-jqgrid-pager");x=C.find(".ui-jqgrid-sdiv");
C.find(".jt-pager-layer").prepend(x.clone().addClass("jt-tb-left"));if(!B){C.find(".jt-pager-layer").append(j.find(".ui-pager-control").clone(true).addClass("jt-tb-right"));
C.addClass("init");}j.find(".jt-tb-left").find("tr.footrow").children("td").each(function(){if(g.trim(g(this).text())==""){g(this).hide();}if(g(this).find("#itemPoSum").length>0){var I=g(this).find("#itemPoSum").clone().hide();
g(this).find("#itemPoSum").remove();g(this).attr("title",g(this).text());g(this).append(I);}});if(x.find("#itemPoSum").length>0){C.find(".jt-pager-layer").append(x.clone().addClass("jt-tb-goodlist").show());
var z=C.find(".jt-tb-goodlist").find("#itemPoSum").clone();C.find(".jt-tb-goodlist").find("#itemPoSum").parent().empty().append(z).attr("title",z.text());
}var E=x.outerHeight()+j.outerHeight();x.hide();j.children(".ui-pager-control").hide();C.find(".jt-pager-layer").show();if(x.find("#itemPoSum").length>0){var A=x.find("#itemPoSum").attr("data-hide");
if(A=="true"){C.find(".jt-pager-layer").find(".jt-tb-goodlist").hide();}}var D=C.find(".jt-pager-layer").parent();var i=D.children(".jt-pager-layer").outerHeight();
var F=D.children(".jt-pager-layer").outerWidth();if(i<=0){i=D.attr("data-height");}else{i+=5;}if(F<=0){F=D.attr("data-width");}else{F-=2;}D.css({"height":i+"px","padding":0}).attr("data-height",i).attr("data-width",F);
C.find(".jt-pager-layer").addClass("jt-pager-flexed");setTimeout(function(){C.find(".jt-pager-layer").width(D.attr("data-width"));},1);var G=(g(e).height()-C.find(".ui-jqgrid-bdiv").offset().top)-j.outerHeight()-2;
if(C.closest(".panel-body").length>0){G-=10;}if(C.height()<=0){G=C.attr("data-height");}if(G<v.minBodyHeight&&!C.parent().is(".jt-grid-panel")){G=v.minBodyHeight;
}if(G>(g(e).height-C.find(".jt-pager-layer").outerHeight())){G=g(e).height-C.find(".jt-pager-layer").outerHeight();}C.find(".ui-jqgrid-bdiv").height(G);
C.attr("data-height",G);var H=C.find(".jt-pager-layer").find(".jt-grid-resizing");if(H.length==0){C.find(".jt-pager-layer").append("<div class='jt-grid-resizing' data-grid-id='"+v.$gridId.attr("id")+"'></div>");
g(a).on("click",".jt-grid-resizing",function(K){var J=g("#"+g(this).attr("data-grid-id")).closest(".ui-jqgrid");var L=J.find(".ui-jqgrid-pager");L.find(".jt-pager-layer").removeClass("jt-pager-flexed");
g("#"+g(this).attr("data-grid-id")).setGridWidth(J.parent().width());L.find(".jt-pager-layer").width(J.outerWidth());var I=(g(e).height()-J.find(".ui-jqgrid-bdiv").offset().top)-L.outerHeight()-2;
if(J.closest(".panel-body").length>0){I-=10;}if(I<v.minBodyHeight&&!J.parent().is(".jt-grid-panel")){I=v.minBodyHeight;}if(I>(g(e).height-J.find(".jt-pager-layer").outerHeight())){I=g(e).height-J.find(".jt-pager-layer").outerHeight();
}J.find(".ui-jqgrid-bdiv").css({"height":I});J.attr("data-height",I);L.find(".jt-pager-layer").addClass("jt-pager-flexed");g(this).removeClass("resizing-locker");
});g(a).on("click","#seniorSearch",function(J){var I=g(this);if(g(".jt-pager-layer:visible").length==0){return false;}setTimeout(function(){if(I.text().indexOf("展开")>=0){g(".jt-pager-layer:visible").closest(".ui-jqgrid").find(".jt-grid-resizing").trigger("click");
}},250);});g(a).on("click","#seniorSearch2,.hideSearch",function(I){if(g(".jt-pager-layer:visible").length==0){return false;}setTimeout(function(){g(".jt-pager-layer:visible").closest(".ui-jqgrid").find(".jt-grid-resizing").trigger("click");
},250);});}};var u=function(){var x=v.$gridId.closest(".ui-jqgrid");var z=x.find(".ui-jqgrid-pager");var j=x.find(".ui-jqgrid-sdiv");var A=x.hasClass("init");
if(z.length==0||j.length==0){return false;}var i=(g(e).height()-x.find(".ui-jqgrid-bdiv").offset().top)-z.outerHeight()-j.outerHeight()-2;if(x.closest(".panel-body").length>0){i-=10;
}if(x.height()<=0){i=x.attr("data-height");}if(i<v.minBodyHeight&&!x.parent().is(".jt-grid-panel")){i=v.minBodyHeight;}if(i>(g(e).height-x.find(".ui-jqgrid-pager").outerHeight())){i=g(e).height-x.find(".ui-jqgrid-pager").outerHeight();
}x.find(".ui-jqgrid-bdiv").height(i);x.attr("data-height",i);};var q=function(){if(!v._isResize){v.resizeGridSize();v._isResize=true;}v.$gridId.find("img").not(".jt-video").not(".no").ImageEnlarge();
removeLoadingFunc();var A=v.$gridId.find("tr.jqgrow").eq(0).find("td").eq(0);if(A&&A.text().length>4){var z=37+(A.text().length-4)*7.5;v.$gridId.parents("div.ui-jqgrid-bdiv").prev().find("tr").eq(0).find("th").eq(0).width(z);
v.$gridId.find("tr").each(function(){g(this).find("td").eq("0").width(z);});}var j=v.$gridId.jqGrid("getGridParam","records");if(j<=0){if(!v.$gridId.parent().parent().find(".norecords").html()){v.$gridId.parent().parent().append("<div class='norecords'><img src='"+ctx+"/img/jt/coffee3.png' style='width:100px;height:100px;margin-bottom:20px;'></img><br>"+v.noDataMsg+"</div>");
v.$gridId.parent().parent().find(".norecords").show();}else{v.$gridId.parent().parent().find(".norecords").show();}}else{v.$gridId.parent().parent().find(".norecords").hide();
}var C=v.$gridId.jqGrid("getGridParam","records"),B=v.$gridId.jqGrid("getGridParam","rowNum"),x=v.$gridId.jqGrid("getGridParam","page");g(v.pager).JTPager({grid:v.$gridId,pager:{rowList:v.rowList,pageSize:B,total:C,},args:{pageCount:Math.ceil(C/B),current:x,backFn:function(D){}}});
var i=v.$gridId.closest(".ui-jqgrid");if(v.options.simplify&&i.find("."+v.$gridId.attr("id")+"-grid-simplify").length==0){r.init();}};if(w.gridComplete){this.options.gridComplete=function(){q();
w.gridComplete();};}else{this.options.gridComplete=function(){q();};}if(w.loadComplete){this.options.loadComplete=function(){w.loadComplete();};}else{this.options.loadComplete=function(){};
}if(this.options.beforeRequest){var t=this.options.beforeRequest;this.options.beforeRequest=function(){t();createLoadingFunc();g(".dropdown-menu.rowContextMenu").remove();
};}else{this.options.beforeRequest=function(){createLoadingFunc();g(".dropdown-menu.rowContextMenu").remove();};}this.jqgrid=null;}d.prototype={init:function(){this._initGrid();
this._bindEventHandler();return this;},_bindEventHandler:function(){var i=this;g("body").on("click",".operatorBtn",function(l){l.stopPropagation();var m=g(this).parents("tr").attr("id");
var n=g(this)[0].getBoundingClientRect().bottom;i.$gridId.jqGrid("setSelection",m);var k=g(this)[0].getBoundingClientRect().left;i._showContextMenu(m,k,n);
});g("body").on("click",function(){if(g(i.contextMenuId).is(":visible")){g(i.contextMenuId).hide();}});g(".list_wrapper table, .jt-grid-panel table").on("contextmenu","tr[role='row']",function(l){if(l.which==3){var k=l.clientX;
var n=l.clientY;var m=g(this).attr("id");i._showContextMenu(m,k,n);return false;}});var j=this.$gridId.closest(".jt-grid-marker");if(j.length==0){j=this.$gridId.closest(".ui-jqgrid").parent();
}j.on("resize",function(){i._toggleAutoHideCols();i.resizeGridSize();});this.$gridId.closest(".ui-jqgrid").onPositionChanged(function(){i.resizeGridSize();
});},_toggleAutoHideCols:function(){var i=g(e).width();var j=g(".navbar-default.navbar-static-side",e.top.document).outerWidth();if(i<=1024-j){this.$gridId.jqGrid("hideCol",this.autoHideCols);
}else{if(i<=1280-j){this.$gridId.jqGrid("hideCol",this.autoHideCols_1024);this.$gridId.jqGrid("hideCol",this.autoHideCols);}else{this.$gridId.jqGrid("showCol",this.autoHideCols);
}}},_showContextMenu:function(j,i,k){this.contextMenuId="#jqgrid-context-menu-"+j;$contextmenu=g("#jqgrid-context-menu-"+j);$contextmenu.siblings("ul.dropdown-menu.rowContextMenu").hide();
if(!$contextmenu.find("li").length){return;}if(k+$contextmenu.height()>g(a).height()){k=g(a).height()-g("#jqgrid-context-menu-"+j).height()-20;}$contextmenu.css({top:k}).show();
if(i+$contextmenu.outerWidth()+10>=g(a).width()){i=g(a).width()-$contextmenu.outerWidth()-20;}$contextmenu.css({left:i});},_initGrid:function(){g.jgrid.defaults.styleUI="Bootstrap";
g.jgrid.styleUI.Bootstrap.base.rowTable="table table-bordered table-striped";this.jqgrid=this.$gridId.jqGrid(this.options);if(g(e).width()<=1280&&!this.options.shrinkToFit){}this._toggleAutoHideCols();
return this;},resizeGridSize:function(j,i){this.resizeGridHeight(i);this.resizeGridWidth(j);this.resizePager();return this;},resizeGridHeight:function(i){if(this.jqgrid.is(":hidden")){return this;
}var i=this._cons.MINI_HEIGHT;var l=this.jqgrid.closest(".ui-jqgrid");i=g(e).height()-l.offset().top;if(l.find(".ui-jqgrid-titlebar").is(":visible")){i-=l.find(".ui-jqgrid-titlebar").outerHeight();
}i-=l.find(".ui-jqgrid-hdiv").height();i-=l.find(".ui-jqgrid-sdiv").outerHeight();i-=3;if(this.pager){i-=g(this.pager).outerHeight();}var k=parseInt(l.parent().css("padding-bottom").replace("px",""));
i-=k;if(i<this._cons.MINI_HEIGHT){i=this._cons.MINI_HEIGHT;}this.jqgrid.jqGrid("setGridHeight",i);return this;var j=g(".list_wrapper .nav.nav-tabs").length>0;
if(j){if(g(".list_wrapper .tab-content .tab-pane.active").find(".panel.panel-default").length){i=g(e).height()-g(".list_wrapper .nav.nav-tabs").outerHeight()-g(".list_wrapper .tab-pane.active .panel.panel-default").outerHeight()-g(".tab-pane.active .ui-jqgrid-hdiv").outerHeight()-g(".tab-pane.active .ui-jqgrid-sdiv").outerHeight()-g(".list_wrapper .tab-pane.active .ui-jqgrid-pager").outerHeight()-(g(".list_wrapper .tab-pane.active .ui-jqgrid-caption").is(":hidden")?0:(g(".ui-jqgrid-caption").outerHeight()+5))-15-6;
}else{i=g(e).height()-g(".list_wrapper .panel.panel-default").outerHeight()-g(".list_wrapper .nav.nav-tabs").outerHeight()-g(".tab-pane.active .ui-jqgrid-hdiv").outerHeight()-g(".list_wrapper .tab-pane.active .ui-jqgrid-pager").outerHeight()-15-6-10;
}}else{if(!i){i=g(e).height()-g(this.options.pager).outerHeight()-this.$gridId.parents(".ui-jqgrid-bdiv").prev().outerHeight()-g(".list_wrapper .panel.panel-default").parents(".col-sm-12").outerHeight()-8;
}}if(g("#jt-crumbs").length){i-=g("#jt-crumbs").height();}if(g(".jt-wx-nav-tab").length){i-=g(".jt-wx-nav-tab").outerHeight()+10;}if(g("#soShipmentFooter").length){i-=g("#soShipmentFooter").outerHeight();
}if(this.options.footerrow){}if(this.options.hasBreadcrumb){i-=g(".breadcrumb").parent().outerHeight();}if(i<this._cons.MINI_HEIGHT){i=this._cons.MINI_HEIGHT;
}this.jqgrid.jqGrid("setGridHeight",i);return this;},resizeGridWidth:function(i){if(this.jqgrid.is(":hidden")){return this;}var j=this.jqgrid.closest(".ui-jqgrid");
if(j.closest(".jt-grid-marker").length==0){this.jqgrid.jqGrid("setGridWidth",j.parent().width());}else{this.jqgrid.jqGrid("setGridWidth",j.closest(".jt-grid-marker").width());
}return this;if(g(".list_wrapper .nav.nav-tabs").length){if(g(".list_wrapper .tab-content .tab-pane.active").find(".panel.panel-default").length){i=g(".list_wrapper .tab-content .tab-pane.active").find(".panel.panel-default").width();
}else{i=g(".list_wrapper").find(".panel.panel-default").width()-10;}}else{if(g(".list_wrapper").is(":visible")){i=g(".list_wrapper .panel.panel-default").width();
}else{i=g(".form_wrapper .panel.panel-default").width();}}if(i<=0||i==Number.NaN){console.log("error happen,the width is "+i);}else{if(i<this._cons.MINI_WIDTH){i=this._cons.MINI_WIDTH;
}this.jqgrid.jqGrid("setGridWidth",i);}return this;},resizePager:function(){}};g.fn[f]=function(i){var j=new d(this,i);return j.init();};})(jQuery,window,document);
$.extend({log:function(g){var b=new Date(),j=b.getFullYear(),a=b.getMonth()+1,i=b.getDate(),f=b.getHours(),c=b.getMinutes(),e=b.getSeconds();console.log("[jt:"+j+"-"+a+"-"+i+" "+f+":"+c+":"+e+"] "+g+"");
}});$(function(){$(document).on("click",function(){window.sessionStorage.setItem("activeTime",new Date().getTime());});});var LockTimer={start:function(){if(!this._hadBindEventHanlder){this._bindEventHanlder();
}this._hadBindEventHanlder=true;var a=this;window.sessionStorage.setItem("activeTime",new Date().getTime());lockTimer=setInterval(function(){var b=window.sessionStorage.getItem("activeTime");
if(b){var c=new Date().getTime();var d=c-parseInt(b);if(lockTime*1000<d){a.lock();}}},5000);},stop:function(){clearInterval(lockTimer);window.sessionStorage.removeItem("activeTime");
},lock:function(){var a=this;$.ajax({type:"GET",url:ctx+"/lockScreen.htm",contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(b){$.log("发起锁屏请求");
},error:function(b){$.log(b);}});},unlock:function(c,d,b){var a=this;var e={"account":c,"password":d};jQuery.post(ctx+"/unlock.htm",e,function(f){if(f.success){a.start();
}b(f);},"json");},openLockScreenView:function(){var c=document.body.clientWidth;var a=document.body.clientHeight;var b=this;b.stop();var d=window.localStorage.getItem("csAccount");
$("#unlockForm").find("[name='account']").val(d);$(".lockScreenTip").width(c).height(a);CapsLockUtils.listen($("input[name='password']"));b.layerIndex=layer.open({type:1,title:"",shade:0.8,shadeClose:false,closeBtn:0,btn:"",skin:"lock-screen-layer",area:[document.body.clientWidth+"px",document.body.clientHeight+"px"],content:$(".lockScreenTip"),success:function(e,f){$("#unlockForm").find("[name='password']").focus();
},yes:function(f,e){},cancel:function(){}});},closeLockScreenView:function(){var a=this;layer.close(a.layerIndex);},_bindEventHanlder:function(){$("#unlockForm").on("click",".unlock",function(){var a=$("#unlockForm").find("[name=account]").val();
var b=$("#unlockForm").find("[name=password]").val();if(!b){$("#unlockForm").find(".errorinfo").text("请输入密码");return;}LockTimer.unlock(a,b,function(c){if(c.success){$("#unlockForm").find("[name=account]").val("");
$("#unlockForm").find("[name=password]").val("");$("#unlockForm").find(".errorinfo").text("");LockTimer.closeLockScreenView();}else{$("#unlockForm").find(".errorinfo").text(c.msg);
}});});window.onbeforeunload=function(){if($(".lockScreenTip").is(":visible")){return"刷新页面将无法保存当前工作页面！";}};$(document).on("keyup",function(a){if(a.keyCode=="13"&&$(".lockScreenTip").is(":visible")){$("#unlockBtn").trigger("click");
}});$(document).on("keydown",function(a){if(a.keyCode=="116"&&$(".lockScreenTip").is(":visible")){return false;}});$(document).on("contextmenu",function(a){if($(".lockScreenTip").is(":visible")){return false;
}});$("body").on("click",".lockScreen",function(){LockTimer.lock();});$(".exitBtn").on("click",function(){CommonCtiUtils.logout(currentUserAid);window.localStorage.removeItem("openIndexCount");
window.sessionStorage.clear();window.top.forceLogout="y";window.location.href=ctx+"/logout.htm";});},openErrorTipView:function(b){var a=this;window.sessionStorage.clear();
window.top.forceLogout="y";a.forceLogout();window.localStorage.removeItem("openIndexCount");CommonCtiUtils.logout(currentUserAid);$("#forceLogoutTip").text(b);
a.layerIndex=layer.open({type:1,title:"",shadeClose:false,scrollbar:false,closeBtn:0,btn:["确定"],area:["350px","200px"],content:$(".forceLogoutTip"),success:function(c,d){},yes:function(d,c){window.location.href=ctx+"/login.htm";
window.top.forceLogout="y";},cancel:function(){}});},forceLogout:function(){$.ajax({type:"GET",url:ctx+"/logoutAsyn.htm",contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(a){},error:function(a){}});
}};var HotKeyHandler={currentMainKey:null,currentValueKey:null,init:function(a){HotKeyHandler.Register(a.tag,a.value,function(){LockTimer.lock();});},Register:function(a,d,c){var b="";
switch(a){case"Ctrl":b=17;break;case"Shift":b=16;break;case"Alt":b="18";break;}document.onkeyup=function(f){HotKeyHandler.currentMainKey=null;};document.onkeydown=function(e){var g=e.keyCode;
var f=String.fromCharCode(e.keyCode);if(HotKeyHandler.currentMainKey!=null){if(f==d){HotKeyHandler.currentMainKey=null;if(c!=null){c();}}}if(g==b){HotKeyHandler.currentMainKey=g;
}};}};var ConfigUtils={findByKey:function(b,c){var a="config-findByKey-"+b;var d=window.sessionStorage.getItem(a);if(d){if(c){var e=JSON.parse(d);c(e);
}}else{FormUtils.submit(ctx+"/gl/config/config/findByKey.htm",{configKey:b},function(f){if(c){c(f);}window.sessionStorage.setItem(a,JSON.stringify(f));
});}}};var JTEncoder={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(j){var m="";var d,b,g,p,c,l,k;var h=0;
j=JTEncoder._utf8_encode(j);while(h<j.length){d=j.charCodeAt(h++);b=j.charCodeAt(h++);g=j.charCodeAt(h++);p=d>>2;c=(d&3)<<4|b>>4;l=(b&15)<<2|g>>6;k=g&63;
if(isNaN(b)){l=k=64;}else{if(isNaN(g)){k=64;}}m=m+this._keyStr.charAt(p)+this._keyStr.charAt(c)+this._keyStr.charAt(l)+this._keyStr.charAt(k);}return m;
},decode:function(j){var m="";var d,b,g;var p,c,l,k;var h=0;j=j.replace(/[^A-Za-z0-9+/=]/g,"");while(h<j.length){p=this._keyStr.indexOf(j.charAt(h++));
c=this._keyStr.indexOf(j.charAt(h++));l=this._keyStr.indexOf(j.charAt(h++));k=this._keyStr.indexOf(j.charAt(h++));d=p<<2|c>>4;b=(c&15)<<4|l>>2;g=(l&3)<<6|k;
m=m+String.fromCharCode(d);if(l!=64){m=m+String.fromCharCode(b);}if(k!=64){m=m+String.fromCharCode(g);}}m=JTEncoder._utf8_decode(m);return m;},_utf8_encode:function(c){c=c.replace(/rn/g,"n");
var a="";for(var d=0;d<c.length;d++){var b=c.charCodeAt(d);if(b<128){a+=String.fromCharCode(b);}else{if(b>127&&b<2048){a+=String.fromCharCode(b>>6|192);
a+=String.fromCharCode(b&63|128);}else{a+=String.fromCharCode(b>>12|224);a+=String.fromCharCode(b>>6&63|128);a+=String.fromCharCode(b&63|128);}}}return a;
},_utf8_decode:function(c){var a="";var d=0;var b=c1=c2=0;while(d<c.length){b=c.charCodeAt(d);if(b<128){a+=String.fromCharCode(b);d++;}else{if(b>191&&b<224){c2=c.charCodeAt(d+1);
a+=String.fromCharCode((b&31)<<6|c2&63);d+=2;}else{c2=c.charCodeAt(d+1);c3=c.charCodeAt(d+2);a+=String.fromCharCode((b&15)<<12|(c2&63)<<6|c3&63);d+=3;}}}return a;
}};var NumberFormat={format:function(b,a){if(a==undefined){a=2;}return(((b+"").indexOf(".")==-1)?b:b.toFixed(a));}};var JTDecoder={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(j){var m="";
var d,b,g,p,c,l,k;var h=0;j=JTDecoder._utf8_encode(j);while(h<j.length){d=j.charCodeAt(h++);b=j.charCodeAt(h++);g=j.charCodeAt(h++);p=d>>2;c=(d&3)<<4|b>>4;
l=(b&15)<<2|g>>6;k=g&63;if(isNaN(b)){l=k=64;}else{if(isNaN(g)){k=64;}}m=m+this._keyStr.charAt(p)+this._keyStr.charAt(c)+this._keyStr.charAt(l)+this._keyStr.charAt(k);
}return m;},decode:function(j){var m="";var d,b,g;var p,c,l,k;var h=0;j=j.replace(/[^A-Za-z0-9+/=]/g,"");while(h<j.length){p=this._keyStr.indexOf(j.charAt(h++));
c=this._keyStr.indexOf(j.charAt(h++));l=this._keyStr.indexOf(j.charAt(h++));k=this._keyStr.indexOf(j.charAt(h++));d=p<<2|c>>4;b=(c&15)<<4|l>>2;g=(l&3)<<6|k;
m=m+String.fromCharCode(d);if(l!=64){m=m+String.fromCharCode(b);}if(k!=64){m=m+String.fromCharCode(g);}}m=JTDecoder._utf8_decode(m);return m;},_utf8_encode:function(c){c=c.replace(/rn/g,"n");
var a="";for(var d=0;d<c.length;d++){var b=c.charCodeAt(d);if(b<128){a+=String.fromCharCode(b);}else{if(b>127&&b<2048){a+=String.fromCharCode(b>>6|192);
a+=String.fromCharCode(b&63|128);}else{a+=String.fromCharCode(b>>12|224);a+=String.fromCharCode(b>>6&63|128);a+=String.fromCharCode(b&63|128);}}}return a;
},_utf8_decode:function(c){var a="";var d=0;var b=c1=c2=0;while(d<c.length){b=c.charCodeAt(d);if(b<128){a+=String.fromCharCode(b);d++;}else{if(b>191&&b<224){c2=c.charCodeAt(d+1);
a+=String.fromCharCode((b&31)<<6|c2&63);d+=2;}else{c2=c.charCodeAt(d+1);c3=c.charCodeAt(d+2);a+=String.fromCharCode((b&15)<<12|(c2&63)<<6|c3&63);d+=3;}}}return a;
}};var CryptoUtils={encrypt:function(g,a){if(a.length<16){var b=new StringBuffer();b.append(a);for(var e=0;e<16-a.length;e++){b.append("0");}a=b.toString();
}else{if(a.length()>16){a=a.substring(0,16);}}var c=CryptoJS.enc.Latin1.parse("1234567812345678");var d=CryptoJS.enc.Latin1.parse(a);var f=CryptoJS.AES.encrypt(g,d,{iv:c,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.ZeroPadding});
return f.toString();},decrypt:function(g,a){if(a.length<16){var b=new StringBuffer();b.append(a);for(var e=0;e<16-a.length;e++){b.append("0");}a=b.toString();
}else{if(a.length()>16){a=a.substring(0,16);}}var c=CryptoJS.enc.Latin1.parse("1234567812345678");var d=CryptoJS.enc.Latin1.parse(a);var f=CryptoJS.AES.decrypt(g,d,{iv:c,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.ZeroPadding});
return f.toString(CryptoJS.enc.Utf8);}};var DecryptHelper={decrypt:function(i){var c=i.number;var e=new Date().getTime()+"";var h=CryptoUtils.encrypt(c,e);
var f=JTEncoder.encode(h);var b={number:c,randomCode:e,code1:encodeURIComponent(h),code2:encodeURIComponent(f),};var a=i.url;var g=i.callback;var d=a?a:ctx+"/crm/cs/csEntity/queryToken.htm";
FormUtils.submit(d,b,function(m){var k=CryptoUtils.decrypt(m.token,e);var j=m.coder;var l=encodeURIComponent(CryptoUtils.encrypt(c,j));var n={number:c,randomCode:e,code1:encodeURIComponent(h),code2:encodeURIComponent(f),encoder3:l,token:k,coder:j,};
FormUtils.submit(ctx+"/crm/cs/csEntity/query.htm",n,function(p){console.log(p.phone);var o=CryptoUtils.decrypt(JTDecoder.decode(p.phone),j);g(o);});});
}};var CallerHelper={call:function(e,h){var c=new Date().getTime()+"";var b="";var f=JTEncoder.encode(e);var d=JTEncoder.encode(e+b+c);var a=encodeURIComponent(CryptoUtils.encrypt(f+d,c));
var g={xcode:e,encoder1:encodeURIComponent(f),encoder2:encodeURIComponent(d),checkCode:a,randomCode:c,};FormUtils.submit(ctx+"/crm/cs/csEntity/getCallPhoneNumToken.htm",g,function(l){var j=CryptoUtils.decrypt(l.token,c);
var i=l.coder;var k=encodeURIComponent(CryptoUtils.encrypt(e,i));var m={xcode:e,encoder1:encodeURIComponent(f),encoder2:encodeURIComponent(d),checkCode:a,randomCode:c,token:j,coder:i,encoder3:k,};
FormUtils.submit(ctx+"/crm/cs/csEntity/getCallPhoneNum.htm",m,function(o){console.log(o.phone);var n=CryptoUtils.decrypt(JTDecoder.decode(o.phone),i);h(n);
});});},};(function(b){function a(c){this.grid=c.grid;this.rowList=c.pager.rowList;this.pageSize=c.pager.pageSize;this.total=c.pager.total;this.obj=c.obj;
this.args=c.args;}a.prototype={init:function(){this.initContainer();this.initSelector();this.initMessage();this.fillHtml();this.bindEvent();},initContainer:function(){var c=this;
if(c.obj.find(".jt-grid-pager").length==0){c.obj.append("<div class='jt-grid-pager'></div>");}},fillHtml:function(f,e){var d=this;if(!f){f=d.obj.children(".jt-grid-pager");
}if(!e){e=d.args;}f.empty();if(e.current>1){f.append('<a href="javascript:;" class="prevPage">上一页</a>');}else{f.remove(".prevPage");f.append('<span class="disabled">上一页</span>');
}if(e.current!=1&&e.current>=4&&e.pageCount!=4){f.append('<a href="javascript:;" class="tcdNumber">'+1+"</a>");}if(e.current-2>2&&e.current<=e.pageCount&&e.pageCount>5){f.append("<span>...</span>");
}var g=e.current-2,c=e.current+2;if((g>1&&e.current<4)||e.current==1){c++;}if(e.current>e.pageCount-4&&e.current>=e.pageCount){g--;}for(;g<=c;g++){if(g<=e.pageCount&&g>=1){if(g!=e.current){f.append('<a href="javascript:;" class="tcdNumber">'+g+"</a>");
}else{f.append('<span class="current">'+g+"</span>");}}}if(e.current+2<e.pageCount-1&&e.current>=1&&e.pageCount>5){f.append("<span>...</span>");}if(e.current!=e.pageCount&&e.current<e.pageCount-2&&e.pageCount!=4){f.append('<a href="javascript:;" class="tcdNumber">'+e.pageCount+"</a>");
}if(e.current<e.pageCount){f.append('<a href="javascript:;" class="nextPage">下一页</a>');}else{f.remove(".nextPage");f.append('<span class="disabled">最后一页了</span>');
}},bindEvent:function(){var c=this;var e=c.obj.children(".jt-grid-pager"),d=c.args;e.on("click","a.tcdNumber",function(){var f=parseInt(b(this).text());
c.fillHtml(e,{"current":f,"pageCount":d.pageCount});c.grid.setGridParam({"page":f}).trigger("reloadGrid");if(typeof(d.backFn)=="function"){d.backFn(f);
}});e.on("click","a.prevPage",function(){var f=parseInt(e.children("span.current").text());if(f<=1){return false;}c.fillHtml(e,{"current":f-1,"pageCount":d.pageCount});
c.grid.setGridParam({"page":f-1}).trigger("reloadGrid");if(typeof(d.backFn)=="function"){d.backFn(f-1);}});e.on("click","a.nextPage",function(){var f=parseInt(e.children("span.current").text());
if(f>=d.pageCount){return false;}c.fillHtml(e,{"current":f+1,"pageCount":d.pageCount});c.grid.setGridParam({"page":f+1}).trigger("reloadGrid");if(typeof(d.backFn)=="function"){d.backFn(f+1);
}});},initSelector:function(){var d=this;if(d.obj.find(".jt-pagesize-selector").length==0){d.obj.css({"position":"relative"});d.obj.append("<div class='jt-pagesize-selector'><div class='jt-pagesize-title'>每页显示</div><div class='jt-pagesize-layer'><span class='jt-pagesize-selected'>"+d.pageSize+"</span><i class='fa fa-caret-down'></i></div></div>");
var c="<ul class='jt-pagesize-list'>";for(var e=0;e<d.rowList.length;e++){if(d.rowList[e]){c+="<li class='jt-pagesize-li'>"+d.rowList[e]+"</li>";}}c+="</ul>";
c+="<div class='jt-pager-custom'><span>自定义大小&nbsp;</span><input class='jt-pager-input'></div>";d.obj.find(".jt-pagesize-selector").children(".jt-pagesize-layer").append(c);
d.obj.on("click",".jt-pagesize-layer",function(g){if(d.obj.find(".jt-pager-custom").is(":visible")){return false;}var f=b(this).children(".jt-pagesize-list");
if(f.is(":hidden")&&!b(g.target).is(".jt-pagesize-selected")){f.show("fast");}else{f.hide("fast");}});d.obj.on("click",".jt-pagesize-li",function(){var f=parseInt(b(this).text());
d.grid.setGridParam({"rowNum":f,"page":1}).trigger("reloadGrid");b(this).closest(".jt-pagesize-list").hide("fast");d.pageSize=f;});d.obj.on("click",".jt-pagesize-selected",function(){d.obj.find(".jt-pager-input").val(d.obj.find(".jt-pagesize-selected").text());
d.obj.find(".jt-pager-custom").show("fast",function(){d.obj.find(".jt-pager-custom").children(".jt-pager-input").focus();});});d.obj.on("keypress",".jt-pager-input",function(g){if(g.keyCode=="13"){if(!b(this).val()){return false;
}var f=/^[1-9]\d*$/;if(!f.test(b(this).val())){layer.msg("每页大小必须是大于0的正整数！");return false;}if(parseInt(d.pageSize)==parseInt(b(this).val())){return false;
}d.grid.setGridParam({"rowNum":b(this).val(),"page":1}).trigger("reloadGrid");d.obj.find(".jt-pagesize-selected").empty().text(b(this).val());d.obj.find(".jt-pager-custom").hide("fast");
d.pageSize=b(this).val();return false;}});b(document).on("click",function(h){var f=b(".jt-pagesize-list");if(f.is(":visible")&&!b(h.target).is(".jt-pagesize-layer,.jt-pagesize-layer *")){f.hide("fast");
}if(d.obj.find(".jt-pager-custom").is(":visible")&&!b(h.target).is(".jt-pager-custom,.jt-pager-custom *")){d.obj.find(".jt-pager-custom").hide("fast");
var g=b.Event("keypress");g.keyCode=13;d.obj.find(".jt-pager-input").trigger(g);}});}else{d.obj.find(".jt-pagesize-selected").empty().text(d.pageSize);
}},initMessage:function(){var c=this;if(c.obj.find(".jt-pagesize-message").length==0){c.obj.css({"position":"relative"});c.obj.append("<div class='jt-pagesize-message'>为您查询到&nbsp;[&nbsp;<span class='jt-pagesize-records'>"+c.total+"</span>&nbsp;]&nbsp;条记录</div>");
}else{c.obj.find(".jt-pagesize-records").empty().text(c.total);}}};b.fn.JTPager=function(e){var d=b.extend({pageCount:100,current:1,backFn:function(){}},e.args);
var c=new a({"grid":e.grid,"pager":e.pager,"obj":this,"args":d});c.init();};})(jQuery);(function(n,p,u){var w=n([]),s=n.resize=n.extend(n.resize,{}),o,l="setTimeout",m="resize",t=m+"-special-event",v="delay",r="throttleWindow";
s[v]=250;s[r]=true;n.event.special[m]={setup:function(){if(!s[r]&&this[l]){return false;}var a=n(this);w=w.add(a);n.data(this,t,{w:a.width(),h:a.height()});
if(w.length===1){q();}},teardown:function(){if(!s[r]&&this[l]){return false;}var a=n(this);w=w.not(a);a.removeData(t);if(!w.length){clearTimeout(o);}},add:function(b){if(!s[r]&&this[l]){return false;
}var c;function a(d,h,g){var f=n(this),e=n.data(this,t);e.w=h!==u?h:f.width();e.h=g!==u?g:f.height();c.apply(this,arguments);}if(n.isFunction(b)){c=b;return a;
}else{c=b.handler;b.handler=a;}}};function q(){o=p[l](function(){w.each(function(){var d=n(this),a=d.width(),b=d.height(),c=n.data(this,t);if(a!==c.w||b!==c.h){d.trigger(m,[c.w=a,c.h=b]);
}});q();},s[v]);}})(jQuery,this);jQuery.fn.onPositionChanged=function(a,b){if(b==null){b=100;}var e=$(this[0]);if(e.length<1){return e;}var d=null;var c=null;
setInterval(function(){if(e==null||e.length<1){return e;}if(d==null){d=e.position();}if(c==null){c=e.offset();}var g=e.position();var f=e.offset();if(d.top!=g.top||d.left!=g.left){$(this).trigger("onPositionChanged",{lastPos:d,newPos:g});
if(typeof(a)=="function"){a(d,g);}d=e.position();}if(c.top!=f.top||c.left!=f.left){$(this).trigger("onOffsetChanged",{lastOff:c,newOff:f});if(typeof(a)=="function"){a(c,f);
}c=e.offset();}},b);return e;};