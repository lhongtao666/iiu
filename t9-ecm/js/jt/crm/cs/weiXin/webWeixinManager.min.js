$(function(){var a=new WebWeixinManager();a.init();});function WebWeixinManager(){this.hadInit=false;this.webWeiXinNewRecord=new WebWeiXinNewRecord();this.webWeiXinOldRecord=new WebWeiXinOldRecord();
this.weiXinLastRecord=new WeiXinLastRecord();}WebWeixinManager._CONS_={};WebWeixinManager.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;
this._bindEventHander();this.weiXinLastRecord.init();}},_bindEventHander:function(){var a=this;$("#oldWebRecordTabLi").on("click",function(){a.webWeiXinOldRecord.init();
});$("#lastRecordTabLi").on("click",function(){a.weiXinLastRecord.init();});$("#newWebRecordTabLi").on("click",function(){a.webWeiXinNewRecord.init();});
$(document).on("click",".weixinAudio",function(c){if($(c.target).hasClass("download-file")){return;}var d=$(this);if(a.audio&&a.audio!=null){a.audio.pause();
$(".audio_area").removeClass("playing");clearTimeout(a.audioEndTime);}a.audio=d.find(".media")[0];d.find(".audio_area").addClass("playing");var b=a.audio.duration;
a.audio.currentTime=0;a.audio.play();a.audioEndTime=setTimeout(function(){$(".audio_area").removeClass("playing");},b*1000);});$(document).on("click",".jt-video",function(b){b.stopPropagation();
b.preventDefault();var c=$(this).attr("src-data");WeiXinUtil.showPlayVideotLayer(c);return false;});$(document).on("click",".layui-layer-close",function(){var b=$(this).parents(".layui-layer-page").find("#jt-wx-video");
if(b.length>0){$("#jt-wx-video").trigger("pause");}});$("body").on("click",".download-file",function(){var b=$(this).attr("name-value");var c=$(this).attr("url-value");
window.location.href=ctx+"/crm/components/upload/download.htm?dname="+b+"&durl="+c;});$(document).on("click",".jt-lager-img",function(c){c.stopPropagation();
var b=$(this).attr("src");var d="大图";$.fancybox.open([{href:b,title:d}]);});$(document).on("click",".jt-audio",function(){var d=$(this);if(a.audio&&a.audio!=null){a.audio.pause();
$(".jt-audio").find("i").css({"background-position":"-4px center"});clearInterval(a.audioEndTime);clearInterval(a.timer_);}var e=d.find("i").attr("src-value");
if(!d.find("audio").attr("src")){d.find("audio").attr("src",e);d.find("audio")[0].load();}if(!d.find("span").is(".is-ready")){d.find("span").addClass("is-ready").empty().append("加载中...");
}var c=-4,b=0;a.audioEndTime=setInterval(function(){if(d.find("audio")[0].readyState){a.audio=d.find("audio")[0];d.find("span").empty().append(d.find("audio")[0].duration.toFixed(1)+"''");
d.find("audio")[0].play();clearInterval(a.audioEndTime);a.timer_=setInterval(function(){c-=18;d.find("i").css({"background-position":c+"px center"});if(c==-58){c=14;
}if(d.find("audio")[0].ended){clearInterval(a.timer_);d.find("i").css({"background-position":"-4px center"});a.audio=null;}},500);}if(b/(1000*60)>=5){clearInterval(timer);
a.playing=null;}b+=500;},500);});}};