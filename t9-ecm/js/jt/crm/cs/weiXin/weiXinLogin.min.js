function WeiXinLogin(){this.hadInit=false;}WeiXinLogin._CONS_={LOAD_CODE_URL:ctx+"/gl/cs/weiXinFriends/genQrcode.htm",};WeiXinLogin.prototype={init:function(b){if(!this.hadInit){var a=this;
this._hideNotGrantedBtn();this._bindEventHander();}},_hideNotGrantedBtn:function(){if(!ResUtils.canShow("weiXinChat.url")){$(".jt-scan-code-li").remove();
}if(!ResUtils.canShow("weiXinChat.url")&&!ResUtils.canShow("android.url")){$(".jt-weixin-msg-li").remove();}},_bindEventHander:function(){var a=this;$("body").on("click",".jt-scan-code",function(){$("#scan-info-span").empty().append("请扫码登录微信");
var b=WeiXinLogin._CONS_.LOAD_CODE_URL;FormUtils.submit(b,{},function(c){if(c.success){a._showLoginLayer(c.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});});$("body").on("click",".wx-record-toggle",function(){if(weixinUseType=="web"){JTTabUtils.addOrRefreshTab(ctx+"/crm/cs/weiXinChat/list.htm","微信聊天","微信聊天",true);
}else{JTTabUtils.addOrRefreshTab(ctx+"/crm/android/newList.htm","微信聊天","微信聊天",true);}$("#wxMsgCount").empty().append(0);$("#wxMsgCount").removeClass("blink");
});if(weixinUseType=="android"){$("body").on("click","a.J_menuTab[data-id='"+ctx+"/crm/android/newList.htm']",function(){$("#wxMsgCount").empty().append(0);
$("#wxMsgCount").removeClass("blink");});}else{$("body").on("click","a.J_menuTab[data-id='"+ctx+"/crm/cs/weiXinChat/list.htm']",function(){$("#wxMsgCount").empty().append(0);
$("#wxMsgCount").removeClass("blink");});}},_showLoginLayer:function(b){var a=this;a.layerIndex=layer.open({type:1,title:"扫码登录",maxmin:false,move:false,scrollbar:false,shadeClose:false,btn:["确定","取消"],area:["650px","450px"],content:$(".jt-scan-code-pane"),success:function(c,d){$("#scan-code-img").attr("src",ctx+b);
},yes:function(d,c){layer.close(d);},cancel:function(){}});},};