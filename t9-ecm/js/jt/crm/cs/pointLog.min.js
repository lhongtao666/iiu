function PointLog(){this.hadInit=false;}PointLog._CONS_={LIST_DATA_URL:ctx+"/crm/cs/csEntity/findPointLogs.htm",SO_DETAIL_PAGE_URL:ctx+"/ec/salesorder/soEntity/detail.htm",PLACE_PAGE_URL:ctx+"/ec/salesorder/soEntity/place.htm",COMFIRM_PAGE_URL:ctx+"/ec/salesorder/soEntity/comfirm/comfirm.htm",FOLLOW_PAGE:ctx+"/ec/salesorder/soEntity/toFollow.htm",};
PointLog.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;}this._bindEventHander();this.initTable(a);},_bindEventHander:function(){var a=this;
$(document).on("click",".pointLogSoDetail",function(){var d=$("#csEntityForm").find("[name=name]").val();var c=$(this).attr("value");var b=ResUtils.canShow("mySoEntity.button.showScTrackNo")?"can":"cannot";
JTTabUtils.addOrRefreshTab(PointLog._CONS_.SO_DETAIL_PAGE_URL+"?soNo="+c+"&canShowScTrankNo="+b,d+"的订单明细");});},initTable:function(d){var a=this;var e=new StringBuffer();
e.append("<table class='table table-striped table-bordered' id='pointLogTable'>");e.append("<thead><tr>");e.append("<th>序号</th>");e.append("<th>类型</th>");
e.append("<th>订单编号</th>");e.append("<th>订单状态</th>");e.append("<th>订单金额</th>");e.append("<th>数量</th>");e.append("<th>说明</th>");e.append("<th>创建时间</th>");
e.append("</tr></thead>");e.append("</table>");$("#pointLogDiv").empty().append(e.toString());var c=PointLog._CONS_.LIST_DATA_URL;var b=$("#id").val();
c=c+"?csId="+d.csId;$("#pointLogTable").DataTable({ajax:{url:c},columns:[{data:"lineNum",width:"6%"},{data:"type",render:function(h,g,f){if("point_get"==f.type){return"新增";
}else{if("point_use"==f.type){return"消费";}}},width:"8%"},{data:"soNo",width:"8%",render:function(h,g,f){if(h!=null&&h!=""){return"<a href='#' class='pointLogSoDetail' value='"+h+"'>"+h+"</a>";
}return h;}},{data:"soStatus",width:"8%",render:function(f,h,g){return SoEntityUtils.formatStatus(f);}},{data:"soTotal",width:"8%"},{data:"count",width:"8%",render:function(h,g,f){if("point_get"==f.type){return f.count;
}else{if("point_use"==f.type){return f.count*-1;}}},},{data:"comment",width:"40%"},{data:"createTime",width:"14%"},],rowId:"id",lengthMenu:[[20],],paging:true,pagingType:"simple",lengthChange:false,autoWidth:false,ordering:false,});
}};