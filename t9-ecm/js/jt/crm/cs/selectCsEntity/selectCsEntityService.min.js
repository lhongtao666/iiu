$(function(){});function SelectCsEntityService(){}SelectCsEntityService._CONS_={LIST_DATA_URL:ctx+"/crm/cs/csEntity/listData.htm",};SelectCsEntityService.prototype={init:function(c){var b=this;
var e=new StringBuffer();for(var a in c){if(a!="callBack"){e.append("&"+a+"="+c[a]);}else{window.myCallBack=c.callBack;}}var d=e.toString();parent.layer.open({type:2,title:"选择客户",maxmin:false,shadeClose:true,btn:["确定","选择所有客户","当前选择客户","取消"],area:["85%","83%"],scrollbar:false,skin:"my-skin",content:c.baseUrl,success:function(f,g){if(c.useFor&&"csTaskEntity"==c.useFor){f.find(".layui-layer-btn1").hide();
f.find(".layui-layer-btn2").hide();}else{f.find(".layui-layer-btn0").hide();f.find(".layui-layer-btn1").attr("style","border-color: #1E9FFF;background-color: #1E9FFF;color: #fff;");
f.find(".layui-layer-btn2").attr("style","border-color: #1E9FFF;background-color: #1E9FFF;color: #fff;");}},end:function(){},yes:function(k,h){if(c.useFor&&"csTaskEntity"==c.useFor){var f=parent.layer.getChildFrame("body",k);
var j=[];var j=$("#csEntityGrid",f).jqGrid("getGridParam","selarrrow");if(j.length<=0){DialogUtils.error(msgCode.ERROR,"请选择客户",f);return;}if(j.length>1){DialogUtils.error(msgCode.ERROR,"请选择不要多选",f);
return;}var m=[];if(j&&j.length){for(var l=0;l<j.length;l++){var g=$("#csEntityGrid",f).jqGrid("getRowData",j[l]);g.id=j[l];m.push(g);}if(c.callBack){c.callBack(m,"defalut");
}}parent.layer.close(k);}},btn2:function(i,g){var f=parent.layer.getChildFrame("body",i);var k=$("#csEntitySearchForm",f).closest("form").serialize();var j=b._getSearchParam(k);
j.type=c.type;j.rows=1000000;j.isSelectCsEntity="y";var h=SelectCsEntityService._CONS_.LIST_DATA_URL;FormUtils.submit(h,j,function(l){if(l.rows&&l.rows.length>0){if(c.callBack){c.callBack(l.rows,"all");
}}parent.layer.close(i);});},btn3:function(k,h){var f=parent.layer.getChildFrame("body",k);var j=[];var j=$("#csEntityGrid",f).jqGrid("getGridParam","selarrrow");
if(j.length<=0){DialogUtils.error(msgCode.ERROR,"请选择客户",f);return;}var m=[];if(j&&j.length){for(var l=0;l<j.length;l++){var g=$("#csEntityGrid",f).jqGrid("getRowData",j[l]);
g.id=j[l];m.push(g);}if(c.callBack){c.callBack(m,"defalut");}}parent.layer.close(k);},btn4:function(g,f){parent.layer.close(g);},cancel:function(g,f){parent.layer.close(g);
}});},_bindEventHander:function(){},_getSearchParam:function(f){var e={};f=decodeURIComponent(f,true);var a=f.split("&");if(a.length){for(var b=0;b<a.length;
b++){var d=a[b].split("=");if(d.length==2){if(e.hasOwnProperty(d[0])){if(jQuery.type(e[d[0]])=="string"){var c=[];c.push(e[d[0]]);d[1]=d[1].replaceAll("\\+"," ");
c.push(d[1]);e[d[0]]=c;}else{if(jQuery.type(e[d[0]])=="array"){d[1]=d[1].replaceAll("\\+"," ");e[d[0]].push(d[1]);}}}else{d[1]=d[1].replaceAll("\\+"," ");
e[d[0]]=d[1];}}else{if(d.length>2){e[d[0]]=a[b].substring(a[b].indexOf("=")+1).replaceAll("\\+"," ");}}}}return e;},};