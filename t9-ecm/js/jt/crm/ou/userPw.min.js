function UserPw(){this.hadInit=false;this.isEdit=false;this.layerIndex=null;}UserPw._CONS_={FORM_ID:"changeUserPwForm",PAGER:"#rolePager",SAVE_EDIT_URL:ctx+"/crm/ou/user/changePw.htm"};
UserPw.prototype={init:function(){if(!this.hadInit){var a=this;this.hadInit=true;this._bindEventHander();this._bindFormValidation();CapsLockUtils.listen($("#newPassword"));
CapsLockUtils.listen($("#password"));}},_changePassword:function(a){FormUtils.clear(UserPw._CONS_.FORM_ID);$("#passwordModalContainer").modal("show");$("#changeUserPwForm_userId").val(a);
},_bindEventHander:function(){var a=this;$(".changePwIndex").on("click",function(){a._changePassword(currentUserId);});$("body").on("click",".employeePWEdit",function(){a.isEdit=true;
var b=$(this).attr("idVal");if(!b){b=$(Employee._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error("错误","请选择要修改密码的记录");
return;}if(b.length>1){DialogUtils.error("错误","不能同时编辑多条记录");return;}}a._changePassword(b);});$("#savePasswordBtn").on("click",function(){if($("#"+UserPw._CONS_.FORM_ID).valid()){var b=$("#"+UserPw._CONS_.FORM_ID).serialize();
FormUtils.submit(UserPw._CONS_.SAVE_EDIT_URL,b,function(c){if(c.success){DialogUtils.success("提示",c.msg);$("#passwordModalContainer").modal("hide");FormUtils.clear(UserPw._CONS_.FORM_ID);
}else{DialogUtils.error("失败",c.msg);}},function(){DialogUtils.error("错误","后台异常，请稍后重试");});}});$("#passwordModalContainer").on("hidden.bs.modal",function(){FormUtils.clear(UserPw._CONS_.FORM_ID);
});$("#passwordModalContainer").on("shown.bs.modal",function(){$("input[name='oldPassword']").focus();});},_bindFormValidation:function(){var a=this;var b={rules:{oldPassword:{required:true,minlength:["5"],},newPassword:{required:true,minlength:["5"],},rNewPassword:{required:true,equalTo:"#newPassword"}},messages:{rNewPassword:{equalTo:"两次输入的密码不一样"}}};
FormUtils.bindFormValidation(UserPw._CONS_.FORM_ID,b);}};