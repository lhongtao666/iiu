$(function(){var a=new PersonalAuth();a.init();});function PersonalAuth(){this.hadInit=false;this.isEdit=false;}PersonalAuth._CONS_={};PersonalAuth.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;
$("#personal-tab").show();$("#auth-tab").hide();this._bindEventHander();}},_loadPersonalGrantRes:function(){FormUtils.loadData(ctx+"/gl/auth/res/loadPersonalGrantRes.htm",function(a){if(a.length){$("#personalGrantResContainer").empty().append(ResUtils.createResTableStr(a));
}});},_loadPersonalGrantReport:function(){FormUtils.loadData(ctx+"/crm/report/reportEntity/findPersonalReportRes.htm",function(a){if(a){var g=[];for(var e=0;
e<a.length;e++){var c=-1;for(var b=0;b<g.length;b++){if(g[b].cateName==a[e].cateName){c=b;break;}}if(c<0){var d={cateName:a[e].cateName,index:e,reports:[a[e]]};
g.push(d);}else{g[c].reports.push(a[e]);}}var f=$.templates("#personalReportTmpl");var h=f.render(g);$("#personalGrantReportContainer").empty().append(h);
}});},_loadPersonalGrantExportColumns:function(a){var b=new StringBuffer();b.append("&nbsp;&nbsp;&nbsp;&nbsp;");$("#personalGrantExportModuleContainer").empty();
$("#personalGrantExportColumnsContainer").empty();b.append("<div class='checkbox checkbox-success checkbox-inline'>");b.append("<input type='checkbox' disabled='disabled' class='exportModule' name='exportModule' id='csEntity' value='csEntity'><label for='csEntity'>客户模块</label>");
b.append("</div>");this._genExportColPanel("客户模块","csEntity",a);b.append("<div class='checkbox checkbox-success checkbox-inline'>");b.append("<input type='checkbox' disabled='disabled' class='exportModule' name='exportModule' id='soShip' value='soShip'><label for='soShip'>出货订单</label>");
b.append("</div>");this._genExportColPanel("出货订单","soShip",a);b.append("<div class='checkbox checkbox-success checkbox-inline'>");b.append("<input type='checkbox' disabled='disabled' class='exportModule' name='exportModule' id='soEntity' value='soEntity'><label for='soEntity'>订单导出</label>");
b.append("</div>");this._genExportColPanel("订单导出","soEntity",a);$("#personalGrantExportModuleContainer").append(b.toString());},_genExportColPanel:function(d,e,b){var c=this;
var a=$.templates("#personalExportColumnPanelTmpl").render({name:d,value:e});$("#personalGrantExportColumnsContainer").append(a);c._loadExportColumn(e+"Container",e,b);
},_loadExportColumn:function(b,d,a){var e=$.templates("#personalExportColumnTmpl");var c=this;excelUtil.findExportColByModule(d,false,function(g){if(g&&g.length>0){for(var f=0;
f<g.length;f++){if(a&&a.indexOf(g[f].id)!=-1){g[f].checked=true;$("#personalGrantExportModuleContainer").find(".exportModule").each(function(){if($(this).val()==d){$(this).prop("checked",true);
}});$("#"+d+"Panel").show();}}$("#"+b).empty().append(c._createResButtonCheckbox(g).toString());}});},_createResButtonCheckbox:function(b){var c=new StringBuffer();
c.append('<div class="col-sm-12">');for(var a=0;a<b.length;a++){c.append('<div class="checkbox checkbox-success checkbox-inline col-sm-2 column-export-grant"'+(b[a].checked?"":"style='display:none;'")+" >");
c.append('<input type="checkbox" disabled="disabled" '+(b[a].checked?"checked='checked'":"")+' colname="'+b[a].name+'" class="columnCheckBox" name="exportColumn" id="'+b[a].id+'" value="'+b[a].id+'" >');
c.append('<label for="'+b[a].id+'">'+b[a].name+"</label>");c.append("</div>");}c.append("</div>");return c.toString();},_bindEventHander:function(){var a=this;
$(document).on("click","#personal-tab-li",function(){$("#personal-tab").show();$("#auth-tab").hide();});$(document).on("click","#auth-tab-li",function(){$("#auth-tab").show();
$("#personal-tab").hide();a._loadPersonalGrantRes();a._loadPersonalGrantReport();a._loadPersonalGrantExportColumns(personalGrantExportColumns);});},};