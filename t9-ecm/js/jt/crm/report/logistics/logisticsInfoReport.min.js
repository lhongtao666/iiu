$(function(){var a=new LogisticsInfoReport();a.init();});function LogisticsInfoReport(){this.hadInit=false;this.isEdit=false;this.baseUrl=ctx+"/crm/report/logisticsInfoReport/listData.htm";
}LogisticsInfoReport._CONS_={EXPORT_URL:ctx+"/crm/report/logisticsInfoReport/export.htm",GRID:"#logisticsInfoReportGrid",PAGER:"#logisticsInfoReportPager"};
LogisticsInfoReport.prototype={init:function(a){if(!this.hadInit){ShipCompanyUtils.getOptions({container:"scNameSearch",caption:"全部"});this.hadInit=true;
this._bindEventHander();$("#timeTypeSearch").val("month");ReportDateUtil.initDate(".report-content");$("#timeTypeSearch").change();this._initJqgrid(this.toPostParam());
}},_bindEventHander:function(){var a=this;$(".report-content").on("click","#searchBtn",function(){a.reloadJqgrid(a.toPostParam());});$(".report-content").on("click",".exportExcel",function(){ButtonUtils.disableBtn("exportExcel");
FormUtils.submit(LogisticsInfoReport._CONS_.EXPORT_URL,a.toPostParam(),function(b){ButtonUtils.enableBtn("exportExcel");if(b.success){DialogUtils.success(msgCode.INFO,b.msg+"成功");
}else{DialogUtils.error(msgCode.FAIL_MSG,b.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});});},_initJqgrid:function(a){$(LogisticsInfoReport._CONS_.GRID).JTJqgrid({url:this.baseUrl,postData:a,multiselect:false,footerrow:true,colNames:["名称","快递单号","订单编号","订单状态","代收款","实付运费","赔偿金额"],colModel:[{name:"scName",width:85,index:"sc_name_",formatter:function(b,c,d){if(d.scName=="本页合计"){return"<span style='color:red;'>"+d.scName+"</span>";
}return d.scName;}},{name:"scTrackingNo",width:130,index:"sc_tracking_no_"},{name:"soNo",width:130},{name:"status",width:90,index:"status_",formatter:function(b,c,d){if(d.status=="complete"){return"签收";
}else{if(d.status=="close_lost"){return"丢失";}else{if(d.status=="close_reject"){return"拒收";}else{if(d.status=="shipping"){return"已发货";}else{return b;}}}}}},{name:"proxyAmount",width:100,index:"proxy_amount_",formatter:function(b,c,d){if(d.scName=="本页合计"){return"<label style='color:red'>"+d.proxyAmount.toFixed(2)+"元</label>";
}else{return d.proxyAmount.toFixed(2);}}},{name:"actualAmount",width:100,index:"actual_amount_",formatter:function(b,c,d){if(d.scName=="本页合计"){return"<label style='color:red'>"+d.actualAmount.toFixed(2)+"元</label>";
}else{return d.actualAmount.toFixed(2);}}},{name:"breakAmount",width:90,index:"break_amount_",formatter:function(b,c,d){if(d.scName=="本页合计"){return"<label style='color:red'>"+d.breakAmount.toFixed(2)+"元</label>";
}else{return d.breakAmount.toFixed(2);}}}],pager:LogisticsInfoReport._CONS_.PAGER,gridComplete:function(){var c=$(LogisticsInfoReport._CONS_.GRID).jqGrid("getCol","proxyAmount",true,"sum");
var b=$(LogisticsInfoReport._CONS_.GRID).jqGrid("getCol","actualAmount",true,"sum");var d=$(LogisticsInfoReport._CONS_.GRID).jqGrid("getCol","breakAmount",true,"sum");
$(LogisticsInfoReport._CONS_.GRID).jqGrid("footerData","set",{scName:"本页合计",proxyAmount:c,actualAmount:b,breakAmount:d});},});},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(LogisticsInfoReport._CONS_.GRID,a);
},toPostParam:function(){var a=$(".shipInfoSearchFrom").serialize();a=a+"&Q__D__BW__ship.create_time_="+ReportDateUtil.getDateTimeRangeStr();a+="&reportType="+$("input[name=reportKey]").val();
return a;}};