$(function(){var a=new CsSleepList();a.init();});function CsSleepList(){this.hadInit=false;}CsSleepList._CONS_={LIST_URL:ctx+"/crm/report/csSleepList/listData.htm",GRID:"#csSleepListGrid",PAGER:"#csSleepListPager",EXPORT_URL:ctx+"/crm/report/csSleepList/exportExcel.htm",};
CsSleepList.prototype={init:function(b){var a=this;if(!a.hadInit){a.hadInit=true;a._bindEventHander();a._initJqgrid(paramsDetail);}},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(CsSleepList._CONS_.GRID,a);
},_bindEventHander:function(){var a=this;$("#csSleepListSearchForm").on("click",".csSleepSearchBtn",function(){var b=a._handleParams();a.reloadJqgrid(b);
});$("#groupName").on("click",function(){var b={isMultiple:0,selectedGroupId:$("#groupId").val(),container:"groupName",positionType:"dept_manager",fn:function(c){$("#groupId").val(c);
}};GroupUtils.selectGroupTreeBox(b);});$("#csSleepListSearchForm").on("click",".csSleepExportExcel",function(){a._exportExcel(paramsDetail);});$("body").on("click",".csTab",function(){var c=$(this).attr("cs-name");
var b=$(this).attr("value");if(c.length>4){c="*"+c.substring(c.length-3,c.length);}JTTabUtils.addOrRefreshTab(ctx+"/crm/cs/csEntity/detail.htm"+"?csId="+b,"客户["+c+"]明细");
});},_initJqgrid:function(a){$(CsSleepList._CONS_.GRID).JTJqgrid({url:CsSleepList._CONS_.LIST_URL,pager:CsSleepList._CONS_.PAGER,postData:a,multiselect:false,colNames:["部门","员工","客户","沉睡天数","订单数量"],colModel:[{name:"groupName",width:120},{name:"employeeName",width:120,formatter:function(b,c,d){if(d.employeeName){return d.employeeName+":"+d.employeeAid;
}else{return"";}}},{name:"csCode",width:120,formatter:function(b,c,d){if(d.csCode){return"<a href='#' style='font-weight:bold;' class='csTab' cs-name='"+d.csName+"' value='"+d.csId+"' >"+d.csName+":"+d.csCode+"</a>";
}else{return d.csName+":"+d.csCode;}}},{name:"sleepDays",width:120},{name:"soCount",width:120}]});},_exportExcel:function(a){FormUtils.submit(CsSleepList._CONS_.EXPORT_URL,a,function(b){if(b.success){DialogUtils.success(msgCode.INFO,b.msg+"成功");
}else{DialogUtils.error(msgCode.FAIL_MSG,b.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}};