$(function(){var a=new ExpressReject();a.init();});function ExpressReject(){this.hadInit=false;this.isEdit=false;this.beginDate=beginDate;this.endDate=endDate;
}ExpressReject._CONS_={INDEX_URL:ctx+"/ec/rp/reportProfit/listShipData.htm",};ExpressReject.prototype={init:function(b){var a=this;if(!a.hadInit){a.hadInit=true;
a._bindEventHander();a._getData(a.toPostParam());}},_bindEventHander:function(){var a=this;window.onmessage=function(f){var c=JSON.parse(f.data);if(c&&c.messageType=="reloadIframe"){var b=c.beginDate;
var d=c.endDate;a.beginDate=b;a.endDate=d;a._getData(a.toPostParam());}};$(".showMoreInfo").on("click",function(){JTTabUtils.addOrRefreshTab(ctx+"/crm/report/shipRejectReport/list.htm?reportKey=no","快递拒收报表");
});$("#groupName").on("click",function(){var b={isMultiple:0,selectedGroupId:$("#groupId").val(),container:"groupName",nolimit:true,positionType:"statistics,dept_manager",fn:function(c){$("#groupId").val(c);
a._initJqgrid();}};GroupUtils.selectGroupTreeBox(b);});$(document).on("click",".chk",function(){var b=$("#groupId").val();a._getData(a.toPostParam());});
},_getData:function(a){var b=this;$.ajax({type:"GET",url:ExpressReject._CONS_.INDEX_URL,data:a,contentType:"application/json",dataType:"json",success:function(c){b.createReportChartByCount(c);
},error:function(c){DialogUtils.error(msgCode.ERROR,c);}});},createReportChartByCount:function(d){var a=new Report();var e=0;var f=d.rows;for(var c=0;c<f.length;
c++){var b="";e=e+f[c].rejectCount;if(f[c].rejectCount!=0&&e!=0){b=(f[c].rejectCount/e*100).toFixed(0)+"%";}else{b=0+"%";}f[c].scName=f[c].scName+"("+b+")";
}a.data=f;a.setLegend(true,null,"scName");a.initSeries([{type:"pie",colName:"rejectCount",legendName:"数量"}],"scName");a._initChart("shipRejectReportBarChart","拒收数量饼图(拒收件数:"+e+"件)");
},toPostParam:function(){var a={};a.groupId=$("#groupName").val();a["Q__D__BW__ship_time_"]=this.beginDate+","+this.endDate;return a;}};