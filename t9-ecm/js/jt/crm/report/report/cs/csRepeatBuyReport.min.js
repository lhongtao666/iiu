$(function(){var a=new CsRepeatBuy();a.init();});function CsRepeatBuy(){this.hadInit=false;this.isEdit=false;this.soTypeCatePos=null;this.type="pie";this.beginDate=beginDate;
this.endDate=endDate;}CsRepeatBuy._CONS_={LIST_URL:ctx+"/crm/report/repeatBuy/listData.htm",};CsRepeatBuy.prototype={init:function(b){var a=this;if(!a.hadInit){a.hadInit=true;
a._bindEventHander();a._initJqgrid();}},_initJqgrid:function(){var b=$("input[name=groupId]").val();if(b){b=b;}var d=this.beginDate;var c=this.endDate;
var a=CsRepeatBuy._CONS_.LIST_URL+"?Q__D__BW__so.complete_time_="+this.beginDate+","+this.endDate+"&belongOgn="+b;FormUtils.loadData(a,function(f){var j=new StringBuffer();
var e=f.rows;if(e.length<11){for(var g=0;g<e.length;g++){var h=e[g];j.append("<tr style='font-size:15px;'>").append("<td>").append(h.empName);if((h.empName!=null&&h.empName!="")&&(h.empAid!=null&&h.empAid!="")){j.append("&nbsp;&nbsp;&nbsp;"+":"+"&nbsp;&nbsp;&nbsp;");
}j.append(h.empAid).append("</td>").append("<td>").append(h.csCount).append("</td>").append("<td>").append(h.soRepeatCount+"/"+h.soRepeatTotal).append("</td>").append("</tr>");
}}else{for(var g=0;g<11;g++){var h=e[g];j.append("<tr style='font-size:15px;'>");j.append("<td>").append(h.empName);if((h.empName!=null&&h.empName!="")&&(h.empAid!=null&&h.empAid!="")){j.append("&nbsp;&nbsp;&nbsp;"+":"+"&nbsp;&nbsp;&nbsp;");
}j.append(h.empAid).append("</td>").append("<td>").append(h.csCount).append("</td>").append("<td>").append(h.soRepeatCount+"/"+h.soRepeatTotal).append("</td>").append("</tr>");
}}$("#repeatBuyTbody").empty().append(j.toString());});},_bindEventHander:function(){var a=this;window.onmessage=function(f){var c=JSON.parse(f.data);if(c&&c.messageType=="reloadIframe"){var b=c.beginDate;
var d=c.endDate;a.beginDate=b;a.endDate=d;a._initJqgrid();}};$("#groupName").on("click",function(){var b={isMultiple:0,selectedGroupId:$("#groupId").val(),container:"groupName",nolimit:true,positionType:"statistics,dept_manager",fn:function(c){$("#groupId").val(c);
a._initJqgrid();}};GroupUtils.selectGroupTreeBox(b);});$(document).on("click",".chk",function(){var b=$("#groupId").val();a._initJqgrid(b);});$("body").on("click","#searchBtn",function(){a._initJqgrid();
return false;});$(".showMoreInfo").on("click",function(){JTTabUtils.addOrRefreshTab(ctx+"/crm/report/repeatBuy/list.htm?reportKey=no","员工复购客户报表");});},};
