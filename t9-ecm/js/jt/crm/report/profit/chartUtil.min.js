$(function(){var a=new ChartUtil();a.init();});function ChartUtil(){}ChartUtil._CONS_={};ChartUtil.prototype={init:function(){this.initEchart();},initEchart:function(){var a=this;
$(document).on("click",".echartBtn",function(){var b=$(this).attr("data-id");var d=$(this).attr("data-datax");var f=[],e=[];var c={};var g=$(b).jqGrid("getRowData");
$.each(g,function(h,j){c[d]=g[h][d];c["createCount"]=g[h].createCount;c["placeCount"]=g[h].placeCount;c["auditCount"]=g[h].auditCount;c["shipCount"]=g[h].shipCount;
c["rejectCount"]=g[h].rejectCount;c["signCount"]=g[h].signCount;f.push(c);c={};e.push(g[h][d]);});layer.open({type:1,title:"数据图显示",shade:false,btn:"关闭",area:["72%","73%"],content:'<div style = "width:100%; height:100%"><div id="profitChart" style="height:100%"></div></div>',success:function(h,i){a.findProfitLineChart(f,e);
},on:function(i,h){layer.close(a.layerIndex);},cancel:function(){layer.close(a.layerIndex);}});});},findProfitLineChart:function(c,h){var g=this;var a=[],d=[],b=[],e=[],i=[],f=[];
if(c!=null&&c!=""){$.each(c,function(j,k){a.push(c[j].createCount);d.push(c[j].placeCount);b.push(c[j].auditCount);e.push(c[j].shipCount);i.push(c[j].rejectCount);
f.push(c[j].signCount);});g._profitEchart(a,d,b,e,i,f,h);}},_profitEchart:function(h,c,g,b,a,d,f){var e=echarts.init(document.getElementById("profitChart"));
option={tooltip:{trigger:"axis"},grid:{x:80,y:50,y2:30,containLabel:true},legend:{data:["下单","提交","审单","发货","拒丢","签收"],left:"left",textStyle:{fontSize:10}},toolbox:{show:true,feature:{mark:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar","stack","tiled"]},restore:{show:true},saveAsImage:{show:true}}},xAxis:[{type:"category",boundaryGap:false,data:f,axisLabel:{interval:0,formatter:function(q){var o="";
var m=6;var n=q.length;var p=Math.ceil(n/m);if(p>1){for(var l=0;l<p;l++){var r="";var j=l*m;var k=j+m;r=q.substring(j,k)+"\n";o+=r;}return o;}else{return q;
}}}}],yAxis:[{type:"value",axisLabel:{formatter:"{value}"}}],series:[{name:"下单",type:"line",stack:"总量",data:h},{name:"提交",type:"line",stack:"总量",data:c},{name:"审单",type:"line",stack:"总量",data:g},{name:"发货",type:"line",stack:"总量",data:b},{name:"拒丢",type:"line",stack:"总量",data:a},{name:"签收",type:"line",stack:"总量",data:d}]};
e.resize();e.setOption(option);},};