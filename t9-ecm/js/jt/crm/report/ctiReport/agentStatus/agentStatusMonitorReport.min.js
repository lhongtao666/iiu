$(function(){var a=new AgentStatusMonitorReport();a.init();});function AgentStatusMonitorReport(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;
}AgentStatusMonitorReport._CONS_={LIST_DATA_URL:ctx+"/crm/report/AgentStatusMonitorReport/listData.htm",GRID:"#agentStatusMonitorReportGrid",PAGER:"#agentStatusMonitorReportPager",};
AgentStatusMonitorReport.prototype={init:function(b){if(!this.hadInit){this.hadInit=true;this._bindEventHander();this._initJqgrid();var a=this;this.intervalId=setInterval(function(){a._reloadJqgird();
},parseInt(refreshTime)*1000);}},_bindEventHander:function(){var a=this;},_reloadJqgird:function(a){JTJqgridUtils.reloadJqgrid(AgentStatusMonitorReport._CONS_.GRID,a);
},_initJqgrid:function(){var a=this;var b={};$(AgentStatusMonitorReport._CONS_.GRID).JTJqgrid({url:AgentStatusMonitorReport._CONS_.LIST_DATA_URL,postData:b,rowNum:10000,viewrecords:true,footerrow:true,multiselect:false,userDataOnFooter:true,colNames:[" ","工号","分机号","员工名称","当前状态","状态持续时间","当日通话量","满意度","呼入量","评价率","当日呼入平均通话时长","当日首次登陆时间","空闲时长","示忙时长","示忙次数","平均话后处理时长"],colModel:[{name:"id",width:10,index:""},{modelName:"aid",name:"aid",index:"aid",width:80},{modelName:"adn",name:"adn",index:"adn",width:80},{modelName:"empName",name:"empName",index:"empName",width:80},{modelName:"adnCurStatus",name:"adnCurStatus",index:"adnCurStatus",width:80,formatter:function(d,e,f){var c="<b style='color:green'>空闲</b>";
if(d=="1"){c="<b style='color:blue;'>通话中</b>";}else{if(d=="2"){c="<b style='color:green'>请挂机</b>";}else{if(d=="3"){c="<b style='color:red;'>示忙</b>";}else{if(d=="4"){c="<b style='color:green'>振铃</b>";
}else{if(d=="5"){c="<b style='color:red'>话后处理</b>";}}}}}return c;}},{modelName:"maintainTime",name:"maintainTime",index:"maintainTime",width:80,formatter:function(c,d,e){return DateUtils.toChineseTime(c);
}},{modelName:"callTotal",name:"callTotal",index:"callTotal",width:100},{modelName:"statisfactionTotal",name:"statisfactionTotal",index:"statisfactionTotal",width:100,formatter:function(c,d,e){if(!parseInt(e.callTotal)){return 0;
}return parseFloat(parseInt(c)/parseInt(e.callTotal)*100).toFixed(2)+"%";}},{modelName:"callIntotal",name:"callIntotal",index:"callIntotal",width:80},{modelName:"evaluationTotal",name:"evaluationTotal",index:"evaluationTotal",width:80,formatter:function(c,d,e){if(!parseInt(e.callTotal)){return 0;
}return parseFloat(parseInt(c)/parseInt(e.callTotal)*100).toFixed(2)+"%";}},{modelName:"avgCallInLength",name:"avgCallInLength",index:"avgCallInLength",width:120,formatter:function(c,d,e){return DateUtils.toChineseTime(c);
}},{modelName:"firstLoginTime",name:"firstLoginTime",index:"firstLoginTime",width:120,formatter:function(c,d,e){if(!c){return"---";}return c;}},{modelName:"idleTime",name:"idleTime",index:"idleTime",width:120,formatter:function(c,d,e){return DateUtils.toChineseTime(c);
}},{modelName:"leftTime",name:"leftTime",index:"leftTime",width:120,formatter:function(c,d,e){return DateUtils.toChineseTime(c);}},{modelName:"leftTotal",name:"leftTotal",index:"leftTotal",width:80},{modelName:"callEndDealLength",name:"callEndDealLength",index:"callEndDealLength",width:120,formatter:function(c,d,e){if(!e.callTotal){return"0秒";
}return DateUtils.toChineseTime(parseFloat((parseInt(c)/parseInt(e.callTotal))).toFixed(2));}}],beforeProcessing:function(c){a.footData=c.footData;},gridComplete:function(){if(a.footData){var d=a.footData;
var c=echarts.init(document.getElementById("agentStatusMonitorEchart"));option={title:{text:"坐席状态分布",subtext:"",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["通话中","空闲","话后处理","振铃","示忙"]},color:["#5BC0DE","#009688","#f8ac59","#dddddd","#e91e63"],series:[{name:"",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:d.callingCount,name:"通话中"},{value:d.idleCount,name:"空闲"},{value:d.callEndCount,name:"话后处理"},{value:d.ringCount,name:"振铃"},{value:d.leftCount,name:"示忙"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};
c.setOption(option);c.resize();}},});}};