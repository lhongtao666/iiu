$(function(){var a=new CallUtilizationReport();a.init();});function CallUtilizationReport(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;
}CallUtilizationReport._CONS_={LIST_DATA_URL:ctx+"/crm/report/callUtilizationReport/listData.htm",GRID:"#callUtilizationReportGrid",PAGER:"#callUtilizationReportPager",};
CallUtilizationReport.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindEventHander();this._initJqgrid();this._reloadJqgird();}},_bindEventHander:function(){var a=this;
$(document).on("click",".adnRecordSearch",function(){var b={startTime:$("input[name='startTime']").val(),endTime:$("input[name='endTime']").val()};a._reloadJqgird(b);
});},_reloadJqgird:function(a){JTJqgridUtils.reloadJqgrid(CallUtilizationReport._CONS_.GRID,a);},_initJqgrid:function(){var b=this;var c=new Date().currentDate()+" 00:00:00";
var a=new Date().currentDate()+" 23:59:59";$("input[name=startTime]").val(c);$("input[name=endTime]").val(a);var d={startTime:c,endTime:a};$(CallUtilizationReport._CONS_.GRID).JTJqgrid({url:CallUtilizationReport._CONS_.LIST_DATA_URL,postData:d,rowNum:10000,footerrow:true,multiselect:false,userDataOnFooter:true,colNames:[" ","部门","姓名","坐席工号","在线时长","空闲时长","示忙时长","话后处理时长","振铃时长","通话时长","通话利用率"],colModel:[{modelName:"id",name:"id",index:"id",width:80},{modelName:"groupName",name:"groupName",index:"groupName",width:80},{modelName:"empName",name:"empName",index:"empName",width:80},{modelName:"agentId",name:"agentId",index:"agentId",width:80},{modelName:"loginLength",name:"loginLength",index:"loginLength",width:80,formatter:function(e,f,g){return DateUtils.toChineseTime(e);
}},{modelName:"idleLength",name:"idleLength",index:"idleLength",width:100,formatter:function(e,f,g){return DateUtils.toChineseTime(e);}},{modelName:"leftLength",name:"leftLength",index:"leftLength",width:100,formatter:function(e,f,g){return DateUtils.toChineseTime(e);
}},{modelName:"callEndLength",name:"callEndLength",index:"callEndLength",width:80,formatter:function(e,f,g){return DateUtils.toChineseTime(e);}},{modelName:"ringingLength",name:"ringingLength",index:"ringingLength",width:80,formatter:function(e,f,g){return DateUtils.toChineseTime(e);
}},{modelName:"callingLength",name:"callingLength",index:"callingLength",width:120,formatter:function(e,f,g){return DateUtils.toChineseTime(e);}},{modelName:"CallRate",name:"CallRate",index:"CallRate",width:120,formatter:function(e,f,g){if(!parseInt(g.loginLength)){return 0;
}return parseFloat((parseInt(g.callingLength)/parseInt(g.loginLength))*100).toFixed(2)+"%";}}],beforeProcessing:function(e){b.footData=e.footData;},gridComplete:function(){if(b.footData){var e=b.footData;
$(CallUtilizationReport._CONS_.GRID).footerData("set",{groupName:"总计:",loginLength:DateUtils.toChineseTime(e.loginLength),idleLength:DateUtils.toChineseTime(e.idleLength),leftLength:DateUtils.toChineseTime(e.leftLength),callingLength:DateUtils.toChineseTime(e.callingLength),callEndLength:DateUtils.toChineseTime(e.callEndLength),ringingLength:DateUtils.toChineseTime(e.ringingLength),CallRate:parseInt(e.loginLength)>0?parseFloat((parseInt(e.callingLength)/parseInt(e.loginLength))*100).toFixed(2)+"%":0},false);
}},});}};