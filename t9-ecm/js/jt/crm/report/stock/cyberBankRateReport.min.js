$(function(){var a=new CyberBankRateReport();a.init();});function CyberBankRateReport(){this.hadInit=false;}CyberBankRateReport._CONS_={GRID:"#cyberBankRateReportGrid",PAGER:"#cyberBankRateReportPager",URL_LIST_DATA:ctx+"/crm/report/reportEntity/cyberBankRateReport.htm",};
CyberBankRateReport.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindEventHander();this._initJqgrid(a);this._initSelect();}},_initSelect:function(){},_bindEventHander:function(){var a=this;
$("body").on("click","[name=groupName]",function(){GroupUtils.selectGroupTreeBox({selectedGroupId:$('input[name="groupId"]').val(),container:"groupName",fn:function(c,b){$('input[name="groupId"]').val(c);
$('input[name="groupKey"]').val(b);}});});$("body").on("click",".export",function(){if(!$('input[name="startTime"]').val()){var b=new Date();var c=b.currentDate()+"00:00:00";
$('input[name="startTime"]').val(c);}var d=$("#searchForm").closest("form").serialize();FormUtils.submit(ctx+"/crm/report/reportEntity/exportCyberRateReport.htm",d,function(e){if(e.success){DialogUtils.success(msgCode.SUCCESS,e.msg);
}else{DialogUtils.error(msgCode.ERROR,e.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});});$(".list_wrapper").on("click",".saleStockSearch",function(){if(!$('input[name="startTime"]').val()){var b=new Date();
var c=b.currentDate()+" 00:00:00";$('input[name="startTime"]').val(c);}var d=$(this).closest("form").serialize();a.reloadJqgrid(d);});$("#searchForm").on("keypress",function(b){if(b.keyCode=="13"){$(".saleStockSearch").trigger("click");
}});$("body").on("click",".openDetail",function(){var e=$(this).attr("startTime");var c=$(this).attr("endTime");var b=$(this).attr("groupKey");var d=$(this).attr("type");
var g="明细";if("payAllRate"===d){g="全额网银率";}else{if("paySubRate"===d){g="部分网银率";}else{if("payedRate"===d){g="网银率";}else{if("cyberAll"===d){g="订单数明细";}}}}var f="startTime="+e+"&endTime="+c+"&groupKey="+b+"&type="+d;
JTTabUtils.addOrRefreshTab(ctx+"/crm/report/reportEntity/openSaleStockDetail.htm?"+f,g);});},_decorateData:function(c,e,f){var b=e.split("/");var d=b[0];
var a=b[1];return"<a startTime='"+f.startTime+"' groupKey='"+(f.groupKey?f.groupKey:"")+"' href='javascript: void(0);' endTime='"+f.endTime+"' type='"+c+"' class='openDetail'>"+"<span style='color:red;'>"+d+"</span>"+"/<span style='color:blue;'>"+a+"</span>"+"</a>";
},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(CyberBankRateReport._CONS_.GRID,a);},_initJqgrid:function(d){var b=this;if(d==null||typeof d==undefined){d={};
}var a=new Date();var c=a.currentDate()+" 00:00:00";$('input[name="startTime"]').val(c);$(CyberBankRateReport._CONS_.GRID).JTJqgrid({url:CyberBankRateReport._CONS_.URL_LIST_DATA,postData:{startTime:c,},pager:CyberBankRateReport._CONS_.PAGER,multiselect:false,footerrow:true,colNames:["部门","订单数(除待提交/待审核/作废)","全额网银率","部分网银率","网银率",],colModel:[{name:"groupName",width:120,sortable:false,formatter:function(f,e,g){return g.groupName;
}},{name:"allCount",width:120,sortable:false,formatter:function(h,e,g){var f="cyberAll";return"<a startTime='"+g.startTime+"' groupKey='"+(g.groupKey?g.groupKey:"")+"' href='javascript: void(0);' endTime='"+g.endTime+"' type='"+f+"' class='openDetail'>"+h+"</a>";
}},{name:"payAllRate",width:120,sortable:false,formatter:function(g,f,e){return b._decorateData("payAllRate",e.payAllRate,e);}},{name:"paySubRate",width:120,sortable:false,formatter:function(g,f,e){return b._decorateData("paySubRate",e.paySubRate,e);
}},{name:"payedRate",width:120,sortable:false,formatter:function(g,f,e){return b._decorateData("payedRate",e.payedRate,e);}},],beforeProcessing:function(f){if(f.rows&&f.rows.length){var e={groupName:"总计：",allCount:f.footData.allCount,payAllRate:f.footData.payAllRate,paySubRate:f.footData.paySubRate,payedRate:f.footData.payedRate,};
b.footerData=e;}},gridComplete:function(){if(b.footerData){var e=$(CyberBankRateReport._CONS_.GRID).jqGrid("getGridParam","records");b.footerData.groupName="总计：<span style='color:red;'>"+e+"</span>个";
$(CyberBankRateReport._CONS_.GRID).footerData("set",b.footerData);}},});}};