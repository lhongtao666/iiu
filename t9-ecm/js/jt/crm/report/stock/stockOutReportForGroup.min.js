$(function(){var a=new StockOutReportForGroup();a.init();});function StockOutReportForGroup(){this.hadInit=false;}StockOutReportForGroup._CONS_={LIST_DATA_URL:ctx+"/crm/report/stStockReport/listStockOutData.htm",EXPORT_URL:ctx+"/crm/report/stStockReport/exportStockOut.htm",GRID:"#stockOutReportGrid",};
StockOutReportForGroup.prototype={init:function(b){var a=this;if(!a.hadInit){a.hadInit=true;$(".minCreateTime").val(new Date().currentDate());StoreUtils.loadStores("","storeIdSearch");
a._bindEventHander();a._initJqgrid();}},_bindEventHander:function(){var a=this;$("#groupName").on("click",function(){var b={isMultiple:0,selectedGroupId:$("#belongOgn").val(),container:"groupName",nolimit:true,positionType:"statistics,dept_manager",fn:function(c,d){$("#belongOgn").val(d);
}};GroupUtils.selectGroupTreeBox(b);});$("body").on("click","#searchBtn",function(){a.reloadJqgrid(a._getParams());});$("body").on("click","#exportBtn",function(){a._export(a._getParams());
});$("#stockOutSearchForm").on("keypress",function(b){if(b.keyCode=="13"){a.reloadJqgrid(a._getParams());}});},_export:function(a){FormUtils.submit(StockOutReportForGroup._CONS_.EXPORT_URL,a,function(b){if(b.success){DialogUtils.success(msgCode.INFO,b.msg+"成功");
}else{DialogUtils.error(msgCode.FAIL_MSG,b.msg+"失败");}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(StockOutReportForGroup._CONS_.GRID,a);
},_getParams:function(){var a=$("#stockOutSearchForm").serialize();a=decodeURIComponent(a,true);a=encodeURI(encodeURI(a));return a;},_initJqgrid:function(){var a=this;
var b=a._getParams();$(StockOutReportForGroup._CONS_.GRID).JTJqgrid({url:StockOutReportForGroup._CONS_.LIST_DATA_URL,postData:b,multiselect:false,footerrow:true,sortable:true,rowNum:-1,colNames:["部门","款号","品名","仓库","出库数","出库金额"],colModel:[{name:"groupName",width:120,sortable:false},{name:"skuCode",width:120,sortable:false},{name:"prodName",width:120,sortable:false},{name:"storeName",width:120,sortable:false},{name:"outQty",width:120,sortable:false},{name:"totalMoney",width:120,sortable:false}],gridComplete:function(){var e=$(StockOutReportForGroup._CONS_.GRID).jqGrid("getCol","outQty",true,"sum");
var d=$(StockOutReportForGroup._CONS_.GRID).jqGrid("getGridParam","records");var c=$(StockOutReportForGroup._CONS_.GRID).jqGrid("getCol","totalMoney",true,"sum");
$(StockOutReportForGroup._CONS_.GRID).footerData("set",{"skuCode":"总计：<span style='color:red;'>"+d+"</span>条","outQty":"<span style='color:red;'>"+e+"</span>个","totalMoney":"<span style='color:red;'>"+c.toFixed(2)+"</span>元"});
var f=$(StockOutReportForGroup._CONS_.GRID).parents(".jqGrid_wrapper").find(".ui-jqgrid-sdiv").find("tr.footrow");f.find("td").css({"font-weight":400});
},});}};