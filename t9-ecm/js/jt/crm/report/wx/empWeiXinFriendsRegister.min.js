$(function(){var a=new EmpWeiXinFriendsRegister();a.init();});function EmpWeiXinFriendsRegister(){this.hadInit=false;this.hadInitCity=false;}EmpWeiXinFriendsRegister._CONS_={LIST_URL:ctx+"/ou/wxFriend/wxFriendRegister/listData.htm",LURU_DIFEN:ctx+"/ou/wxFriend/wxFriendRegister/luruDiFen.htm",SAVE_URL:ctx+"/ou/wxFriend/wxFriendRegister/saveAdd.htm",GRID:"#empWeiXinFriendsRegisterGrid",PAGER:"#empWeiXinFriendsRegisterPager",EXPORT_URL:ctx+"/crm/report/performanceForEmpReport/exportWxFriendsRegister.htm",EMPLOYEE_LIST_URL:ctx+"/crm/ou/employee/listEmployees.htm",};
EmpWeiXinFriendsRegister.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;ReportDateUtil.initDate(".report-content");$("#daySelect").val(DateUtils.format(new Date(),"yyyy-MM-dd"));
this._initJqgrid({day:DateUtils.format(new Date(),"yyyy-MM-dd")});this._bindEventHander();this._channelSearch();this._buildEmployeeSelect();}},_buildEmployeeSelect:function(a){$.ajax({type:"GET",url:ctx+"/crm/ou/employee/listEmployees.htm"+"?groupId="+(a?a:""),contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(c){if(c&&c.length>0){var d=new StringBuffer();
d.append("<option value=''>请选择</option>");for(var b=0;b<c.length;b++){d.append("<option value='"+c[b].id+"'>"+c[b].aid+":"+c[b].name+"</option>");}$("#belongEmployee").empty().append(d.toString()).select2();
}}});},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(EmpWeiXinFriendsRegister._CONS_.GRID,a);},_channelSearch:function(){ChannelUtils.getOptions({container:"channelQry",caption:"",type:"noChannelId"});
},_bindEventHander:function(){var self=this;$(document).on("keyup",".addWt",function(event){$(".addWt").each(function(i){var adDateStartVal=$(this).val();
if(96<=event.keyCode<=105&&event.keyCode!=8){if(adDateStartVal.length==2&&/^[0-9]*$/.test(adDateStartVal)){$(this).val(adDateStartVal+":");}}});});$(document).on("click","#isLastDay",function(){if($(this).val()=="y"){$(this).removeAttr("checked");
$(this).val("n");}else{$(this).attr("checked","checked");$(this).val("y");}});$(document).on("click","#nextBtn",function(){$("#daySelect").val(DateUtils.getAfterDate(1,$("#daySelect").val()));
if($("#daySelect").val()==new Date().currentDate()){$(".exportDay").hide();}else{$(".exportDay").show();}});$(document).on("click","#prevBtn",function(){$("#daySelect").val(DateUtils.getBeforeDate(1,$("#daySelect").val()));
if($("#daySelect").val()==new Date().currentDate()){$(".exportDay").hide();}else{$(".exportDay").show();}});$(document).on("click","#todayBtn",function(){$("#daySelect").val(DateUtils.format(new Date(),"yyyy-MM-dd"));
$(".exportDay").hide();});$("#groupName").on("click",function(){GroupUtils.selectGroupTreeBox({container:"groupName",isEqWidth:true,isAutoHeight:true,fn:function(groupIds,groupKeys){$("#groupId").val(groupIds);
FormUtils.loadData(EmpWeiXinFriendsRegister._CONS_.EMPLOYEE_LIST_URL+"?groupId="+groupIds+"&type=statistics,dept_manager",function(data){var sb=new StringBuffer();
sb.append('<option value="">请选择</option>');for(var i=0;i<data.length;i++){sb.append("<option value='"+data[i].id+"'>"+data[i].aid+":"+data[i].name+"</option>");
}$("#belongEmployee").empty().append(sb.toString());});}});});$("#searchBtn").on("click",function(){var params="";params+="&day="+$("#daySelect").val();
params+="&belongOgn="+$("#groupId").val();params+="&belongEmployee="+$("#belongEmployee option:selected").val();params+="&alias="+$("#alias").val();var channelLength=$("#channelQry option:selected").length;
if(channelLength!=0){params=self._buildChanelSearch(params,channelLength);}self.reloadJqgrid(params);});$(".exportExcel").on("click",function(){self._exportExcel();
});$(document).on("click",".saveDiFen",function(){var $this=$(this);var url=EmpWeiXinFriendsRegister._CONS_.LURU_DIFEN;var id=$this.parent().prev().attr("idVal");
var difen=$this.parent().prev().find("input").val();if(difen==""){DialogUtils.error("提示","请输入初始底粉数量");return false;}if(!(/(^[1-9]\d*$)/.test(difen))){DialogUtils.error("提示","请输入正整数");
return false;}var params="";params+="&employeeAlias="+$(this).attr("alias");params+="&employeeId="+$(this).attr("employeeId");params+="&channelId="+$(this).attr("channelId");
params+="&groupId="+$(this).attr("groupId");params+="&groupKey="+$(this).attr("groupKey");params+="&wxId="+$(this).attr("wxId");params+="&firstFensi="+difen;
params+="&day="+new Date().currentDate();DialogUtils.confirmWithOptions({title:"提示",text:"初始只能录入一次，录入后不得修改，请谨慎操作，确定要录入吗？",confirmButtonText:"确认",yesFunc:function(){FormUtils.submit(url,params,function(data){if(data.success){DialogUtils.success(msgCode.INFO,data.msg);
$this.hide();$this.parent().prev().find("input").attr("disabled","disabled");$("#searchBtn").trigger("click");}else{DialogUtils.error("提示","后台异常，请稍后再试");
}});}});});$(document).on("click",".imgButton",function(){var $that=$(this);var $imageDiv=$that.parent().prev();var $imgDiv=$that.parent().next().find(".imgDiv");
ImageUtils.selectImage(0,function(images){var divStr=ImageUtils.createImageDivStr(images);$imageDiv.empty().append(divStr);var src=ctx+$imageDiv.find(".file").attr("urlval");
var urlval=$imageDiv.find(".file").attr("urlval");$imgDiv.attr("src",src);$imgDiv.attr("urlval",urlval);$that.parent().next().show();});});$(document).on("click",".fa-plus",function(){var sb=new StringBuffer();
sb.append("<div class='workTimeDiv col-sm-12' style='padding:2px 0px;'>");sb.append("<div class='col-sm-3' style='padding:0px;'>");sb.append("<input type='text' name='workTime'  class='form-control'></div>");
sb.append("<div class='imageDiv' style='display:none;'></div>");sb.append("<div class='col-sm-2' style='padding:4px 0 0 3px;'><span type='button' class=' jt-btn-normal imgButton'>图片</span></div>");
sb.append("<div style='display:none; padding: 0 0 0 3px;' class='col-sm-2 imagesDiv'><img style='height:25px;' class='imgDiv workTimeImg'></div>");sb.append("<div class='col-sm-5' style='padding:0px;'><div class='col-sm-8'  style='padding:0px;'><input type='text' laceholder='时间' name='addWt' class='form-control addWt'></div><div class='col-sm-2' style='padding:3px 0 0 3px;'><i class='fa fa-plus' ></i></div><div class='col-sm-2'  style='padding:3px 0 0 3px;color:red;'><i class='fa fa-minus-circle' ></i></div></div>");
sb.append("</div>");$(this).closest(".workTime").append(sb.toString());});$(document).on("click",".fa-minus-circle",function(){$(this).closest(".workTimeDiv").remove();
});$(document).on("click",".saveBtn",function(){var id=$(this).attr("idVal");if($(this).closest("tr").find(".saveDiFen").is(":visible")){DialogUtils.error("提示","请先录入底粉");
return false;}var firstFensi=$(this).closest("tr").find("input[name=firstFensi]").val();if(!firstFensi){firstFensi=$(this).attr("firstFen");}var preDayWork=0;
if($(this).closest("tr").find("input[name=preDayWork]").val()){preDayWork=$(this).closest("tr").find("input[name=preDayWork]").val();}var preDayWorkImg="";
if($(this).closest("tr").find(".preDayWorkImg").attr("urlval")){preDayWorkImg=$(this).closest("tr").find(".preDayWorkImg").attr("urlval");}var linChenWork=0;
if($(this).closest("tr").find("input[name=linChenWork]").val()){linChenWork=$(this).closest("tr").find("input[name=linChenWork]").val();}var linChenWorkImg="";
if($(this).closest("tr").find(".linChenWorkImg").attr("urlval")){linChenWorkImg=$(this).closest("tr").find(".linChenWorkImg").attr("urlval");}var $workTime=$(this).closest("tr").find(".workTimeDiv");
if(eval(firstFensi)>eval(preDayWork)){DialogUtils.error("录入有误","前一天下班后粉比底粉少");return false;}if(eval(preDayWork)>eval(linChenWork)){DialogUtils.error("录入有误","凌晨到上班前粉比前一天下班后粉少");
return false;}var workTime="";var isT=true;if($workTime.length==0){DialogUtils.error("提示","请输入正常上班时段数据");return false;}$.each($workTime,function(i,e){var wt="";
var wtImg="";var addWt="";wt=$(this).find("input[name=workTime]").val();if(eval(linChenWork)>eval(wt)){DialogUtils.error("录入有误","正常上班时间粉比凌晨到上班前粉底粉少");isT=false;
return false;}if($(this).find(".workTimeImg").attr("urlval")){wtImg=$(this).find(".workTimeImg").attr("urlval");}addWt=$(this).find("input[name=addWt]").val();
var reg=/^(0?[0-9]|1[0-9]|2[0-3])[:](0?[0-9]|[1-5][0-9])$/;if(!reg.test(addWt)){DialogUtils.error("提示","输入的时间有误");isT=false;return false;}if(i>0){var owt=$(this).prev().find("input[name=workTime]").val();
var oaddWt=$(this).prev().find("input[name=addWt]").val();if(eval(owt)>eval(wt)){DialogUtils.error("提示","正常工作时间数据录入有误！");isT=false;return false;}var time=addWt.split(":");
var prevTime=oaddWt.split(":");if(eval(time[0])<eval(prevTime[0])){DialogUtils.error("提示","输入的时间必须依次递增");isT=false;return false;}else{if(eval(time[0])==eval(prevTime[0])){if(eval(time[1])<eval(prevTime[1])){DialogUtils.error("提示","输入的时间必须依次递增");
isT=false;return false;}}}}if(i==$workTime.length-1){workTime=workTime+wt+","+wtImg+","+addWt;}else{workTime=workTime+wt+","+wtImg+","+addWt+"%26";}});
if(!isT){return false;}var params="";params+="&predayWorkAfter="+preDayWork;params+="&predayImg="+preDayWorkImg;params+="&linchenToWorkbefore="+linChenWork;
params+="&linchenImg="+linChenWorkImg;params+="&workTime="+workTime;if(!id){params+="&employeeAlias="+$(this).attr("alias");params+="&employeeId="+$(this).attr("employeeId");
params+="&channelId="+$(this).attr("channelId");params+="&groupId="+$(this).attr("groupId");params+="&groupKey="+$(this).attr("groupKey");params+="&firstFensi="+$(this).attr("firstFen");
params+="&wxId="+$(this).attr("wxId");params+="&day="+new Date().currentDate();}else{params+="&id="+id;}self._save(params);});},_save:function(c){var a=this;
var b=EmpWeiXinFriendsRegister._CONS_.SAVE_URL;DialogUtils.confirmWithOptions({title:"提示",text:"是否保存？",confirmButtonText:"确认",yesFunc:function(){FormUtils.submit(b,c,function(d){if(d.success){DialogUtils.success("提示","保存成功");
$("#searchBtn").trigger("click");}else{DialogUtils.error("提示","后台异常，请稍后再试");}});}});},_buildChanelSearch:function(d,c){var b=this;var e=new StringBuffer();
var a=null;$("#channelQry option:selected").each(function(f){if($(this).val()==""){a="withOut";}e.append("'");e.append($(this).val()).append("'");if(f==c-1){return false;
}else{e.append(",");}});d=d+"&channelId="+e.toString();if(a){d+="&withOut="+"withOut";}return d;},_initJqgrid:function(b){var a=this;$(EmpWeiXinFriendsRegister._CONS_.GRID).JTJqgrid({url:EmpWeiXinFriendsRegister._CONS_.LIST_URL,pager:EmpWeiXinFriendsRegister._CONS_.PAGER,postData:b,multiselect:false,colNames:["部门","员工工号","员工微信号","渠道","初始底粉","前一天下班后|19:00-24:00","凌晨到上班前|00:00-9:30","正常上班时段|9:30-19:00","操作"],colModel:[{name:"groupName",width:30,formatter:function(d,e,g,c,f){return g.groupName;
},},{name:"empName",width:50,formatter:function(d,e,g,c,f){return g.employeeAid+":"+g.employeeName;}},{name:"employeeAlias",indix:"employee_alias_",width:90,formatter:function(c,d,e){return e.employeeAlias+":"+e.nickName;
}},{name:"changeName",width:50,formatter:function(c,d,e){return e.channelName;}},{name:"firstFensi",indix:"first_fensi_",width:100,formatter:function(c,d,e){if(e.firstFensi){var f=new StringBuffer();
f.append("<div class='col-sm-4'>"+e.firstFensi+"</div>");return f.toString();}else{var f=new StringBuffer();f.append("<div class='col-sm-6 ' idVal='"+e.id+"' style='padding:0px;'>");
f.append("<input type='text' name='firstFensi' class='form-control' >");f.append("</div>");f.append("<div class='col-sm-5'><button type='button'  style='min-width:auto;' class='btn btn-sm jt-btn-normal saveDiFen' wxId='"+e.wxId+"' alias='"+e.employeeAlias+"' groupKey='"+e.groupKey+"' groupId='"+e.groupId+"' channelId='"+e.channelId+"' employeeId='"+e.employeeId+"'>确定</button>");
return f.toString();}}},{name:"preDayWork",width:160,formatter:function(c,d,e){if(e.predayWorkAfter){var f=new StringBuffer();if(e.day==new Date().currentDate()){f.append("<div class='col-sm-4' style='padding:0px;'>");
f.append("<input type='text' name='preDayWork' class='form-control' value='"+e.predayWorkAfter+"'></div>");f.append("<div class='imageDiv' style='display:none;'></div>");
f.append("<div class='col-sm-3' style='padding:4px 0 0 3px;'><span type='button' class=' jt-btn-normal imgButton'>图片</span></div>");if(e.predayImg){f.append("<div style='padding: 0 0 0 3px;' class='col-sm-5 imagesDiv'><img style='height:25px;' urlval='"+e.predayImg+"' src='"+ctx+e.predayImg+"'  class='preDayWorkImg imgDiv'></div>");
}else{f.append("<div style='display:none;padding: 0 0 0 3px;' class='col-sm-5 imagesDiv'><img style='height:25px;' urlval='"+e.predayImg+"' src='"+ctx+e.predayImg+"'  class='preDayWorkImg imgDiv'></div>");
}}else{f.append("<div class='col-sm-4' >"+e.predayWorkAfter+"</div>");if(e.predayImg){f.append("<div class='col-sm-4'><img  style='height:25px;'  urlval='"+e.predayImg+"' src='"+ctx+e.predayImg+"'></div>");
}}return f.toString();}else{if(e.day!=new Date().currentDate()){return"<span style='padding-left:15px;'>未录入</span>";}else{var f=new StringBuffer();f.append("<div class='col-sm-4' style='padding:0px;'>");
f.append("<input type='text' name='preDayWork'  class='form-control'></div>");f.append("<div class='imageDiv' style='display:none;'></div>");f.append("<div class='col-sm-3' style='padding:4px 0 0 3px;'><span type='button' class=' jt-btn-normal imgButton'>图片</span></div>");
f.append("<div style='display:none;padding: 0 0 0 3px;' class='col-sm-5 imagesDiv'><img style='height:25px;'  class='preDayWorkImg imgDiv'></div>");return f.toString();
}}}},{name:"linChenWork",width:160,formatter:function(c,d,e){if(e.linchenToWorkbefore){var f=new StringBuffer();if(e.day==new Date().currentDate()){f.append("<div class='col-sm-4' style='padding:0px;'>");
f.append("<input type='text' name='linChenWork'  class='form-control' value='"+e.linchenToWorkbefore+"'></div>");f.append("<div class='imageDiv' style='display:none;'></div>");
f.append("<div class='col-sm-3' style='padding:4px 0 0 3px;'><span type='button' class=' jt-btn-normal imgButton'>图片</span></div>");if(e.linchenImg){f.append("<div style='padding: 0 0 0 3px;' class='col-sm-5 imagesDiv'><img style='height:25px;'  urlval='"+e.linchenImg+"' src='"+ctx+e.linchenImg+"' class='imgDiv linChenWorkImg'></div>");
}else{f.append("<div style='display:none;padding: 0 0 0 3px;' class='col-sm-5 imagesDiv'><img style='height:25px;'  urlval='"+e.linchenImg+"' src='"+ctx+e.linchenImg+"' class='imgDiv linChenWorkImg'></div>");
}}else{f.append("<div class='col-sm-4'>"+e.linchenToWorkbefore+"</div>");if(e.linchenImg){f.append("<div class='col-sm-4'><img  style='height:25px;' urlval='"+e.linchenImg+"' src='"+ctx+e.linchenImg+"'></div>");
}}return f.toString();}else{if(e.day!=new Date().currentDate()){return"<span style='padding-left:15px;'>未录入</span>";}else{var f=new StringBuffer();f.append("<div class='col-sm-4' style='padding:0px;'>");
f.append("<input type='text' name='linChenWork'  class='form-control'></div>");f.append("<div class='imageDiv' style='display:none;'></div>");f.append("<div class='col-sm-3' style='padding:4px 0 0 3px;'><span type='button' class=' jt-btn-normal imgButton'>图片</span></div>");
f.append("<div style='display:none;padding: 0 0 0 3px;' class='col-sm-5 imagesDiv'><img style='height:25px;' class='imgDiv linChenWorkImg'></div>");return f.toString();
}}}},{name:"workTime",width:200,formatter:function(d,f,k){if(k.workTime){var l=new StringBuffer();if(k.day==new Date().currentDate()){if(k.workTime.indexOf("&")>=0){var h=k.workTime;
var e=h.split("&");var c=new Array();l.append("<div class='workTime' style='padding:0px;'>");for(var g=0;g<e.length;g++){var c=e[g].split(",");l.append("<div class='workTimeDiv col-sm-12' style='padding:2px 0px;'>");
l.append("<div class='col-sm-3' style='padding:0px;'><input type='text' value='"+c[0]+"'  name='workTime'  class='form-control'></div>");l.append("<div class='imageDiv' style='display:none;'></div>");
l.append("<div class='col-sm-2' style='padding:4px 0 0 3px;'><span type='button' class=' jt-btn-normal imgButton'>图片</span></div>");if(c[1]&&c[1].length>0){l.append("<div style='padding: 0 0 0 3px;' class='col-sm-2 imagesDiv'><img style='height:25px;' urlval='"+c[1]+"' src='"+ctx+c[1]+"' class='imgDiv workTimeImg'></div>");
}else{l.append("<div style='display:none;padding: 0 0 0 3px;' class='col-sm-2 imagesDiv'><img style='height:25px;' class='imgDiv workTimeImg'></div>");
}l.append("<div class='col-sm-5' style='padding:0px;'><div class='col-sm-8'  style='padding:0px;'><input type='text' value='"+c[2]+"' name='addWt' laceholder='时间' class='form-control addWt'></div><div class='col-sm-2' style='padding:3px 0 0 3px;'><i class='fa fa-plus'></i></div><div class='col-sm-2'  style='padding:3px 0 0 3px;color:red;'><i class='fa fa-minus-circle' ></i></div></div>");
l.append("</div>");}l.append("</div>");}else{var c=k.workTime.split(",");l.append("<div class='workTime' style='padding:0px;'>");l.append("<div class='workTimeDiv col-sm-12' style='padding:2px 0px;'>");
l.append("<div class='col-sm-3' style='padding:0px;'><input type='text' value='"+c[0]+"'  name='workTime'  class='form-control'></div>");l.append("<div class='imageDiv' style='display:none;'></div>");
l.append("<div class='col-sm-2' style='padding:4px 0 0 3px;'><span type='button' class=' jt-btn-normal imgButton'>图片</span></div>");if(c[1]&&c[1].length>0){l.append("<div style='padding: 0 0 0 3px;' class='col-sm-2 imagesDiv'><img style='height:25px;' urlval='"+c[1]+"' src='"+ctx+c[1]+"' class='imgDiv workTimeImg'></div>");
}else{l.append("<div style='display:none;padding: 0 0 0 3px;' class='col-sm-2 imagesDiv'><img style='height:25px;' class='imgDiv workTimeImg'></div>");
}l.append("<div class='col-sm-5' style='padding:0px;'><div class='col-sm-8'  style='padding:0px;'><input type='text' value='"+c[2]+"' name='addWt' laceholder='时间' class='form-control addWt'></div><div class='col-sm-2' style='padding:3px 0 0 3px;'><i class='fa fa-plus'></i></div></div>");
l.append("</div></div>");}}else{if(k.workTime.indexOf("&")>=0){var h=k.workTime;var e=h.split("&");var c=new Array();for(var g=0;g<e.length;g++){if($("#isLastDay").is(":checked")){if(g=e.length-1){var c=e[g].split(",");
l.append("<div class='col-sm-12 style='padding:0;'>");l.append("<div class='col-sm-3'>"+c[0]+"</div>");if(c[1]&&c[1].length>0){l.append("<div class='col-sm-3'><img style='height:25px;' src='"+ctx+c[1]+"' class='imgDiv workTimeImg'></div>");
}l.append("<div class='col-sm-6'>"+c[2]+"</div>");l.append("</div>");}}else{var c=e[g].split(",");l.append("<div class='col-sm-12'  style='padding:0'>");
l.append("<div class='col-sm-3'>"+c[0]+"</div>");if(c[1]&&c[1].length>0){l.append("<div class='col-sm-3'><img style='height:25px;' src='"+ctx+c[1]+"' class='imgDiv workTimeImg'></div>");
}l.append("<div class='col-sm-6'>"+c[2]+"</div>");l.append("</div>");}}}else{var c=k.workTime.split(",");l.append("<div class='col-sm-12' style='padding:0'>");
l.append("<div class='col-sm-3'>"+c[0]+"</div>");if(c[1]&&c[1].length>0){l.append("<div class='col-sm-3'><img style='height:25px;' src='"+ctx+c[1]+"' class='imgDiv workTimeImg'></div>");
}l.append("<div class='col-sm-6'>"+c[2]+"</div>");l.append("</div>");}}return l.toString();}else{if(k.day!=new Date().currentDate()){return"<span style='padding-left:15px;'>未录入</span>";
}else{var l=new StringBuffer();l.append("<div class='workTime' style='padding:0px;'><div class='workTimeDiv col-sm-12' style='padding:2px 0px;'>");l.append("<div class='col-sm-3' style='padding:0px;'>");
l.append("<input type='text'  name='workTime'  class='form-control'></div>");l.append("<div class='imageDiv' style='display:none;'></div>");l.append("<div class='col-sm-2' style='padding:4px 0 0 3px;'><span type='button' class=' jt-btn-normal imgButton'>图片</span></div>");
l.append("<div style='display:none;padding: 0 0 0 3px;' class='col-sm-2 imagesDiv'><img style='height:25px;' class='imgDiv workTimeImg'></div>");l.append("<div class='col-sm-5' style='padding:0px;'><div class='col-sm-8'  style='padding:0px;'><input type='text' name='addWt' laceholder='时间' class='form-control addWt'></div><div class='col-sm-2' style='padding:3px 0 0 3px;'><i class='fa fa-plus'></i></div></div>");
l.append("</div></div>");return l.toString();}}}},{name:"caozuo",indix:"caozuo",width:40,formatter:function(c,d,e){var f=new StringBuffer();f.append("<button type='button' wxId='"+e.wxId+"' alias='"+e.employeeAlias+"' groupKey='"+e.groupKey+"' groupId='"+e.groupId+"' channelId='"+e.channelId+"' employeeId='"+e.employeeId+"' firstFen='"+e.firstFensi+"' idVal='"+e.id+"' class='btn btn-sm jt-btn-normal saveBtn' style='min-width:auto;'>保存</button");
return f.toString();}}],gridComplete:function(){if($("#daySelect").val()==new Date().currentDate()){$("#empWeiXinFriendsRegisterGrid").setGridParam().showCol("caozuo");
}else{$("#empWeiXinFriendsRegisterGrid").setGridParam().hideCol("caozuo");}$(window).resize();},});},MergerRowspan:function(a,h){var d=$("#"+a+"").getDataIDs();
var f=d.length;for(var c=0;c<f;c++){var g=$("#"+a+"").jqGrid("getRowData",d[c]);var e=1;for(j=c+1;j<=f;j++){var b=$("#"+a+"").jqGrid("getRowData",d[j]);
if(g[h]==b[h]){e++;$("#"+a+"").setCell(d[j],h,"",{display:"none"});}else{e=1;break;}$("#"+h+""+d[c]+"").attr("rowspan",e);}}},_exportExcel:function(){var a=this;
ButtonUtils.disableBtn("exportExcel");var c="";c+="&day="+$("#daySelect").val();c+="&belongOgn="+$("#groupId").val();c+="&belongEmployee="+$("#belongEmployee option:selected").val();
c+="&alias="+$("#alias").val();var b=$("#channelQry option:selected").length;if(b!=0){c=a._buildChanelSearch(c,b);}FormUtils.submit(EmpWeiXinFriendsRegister._CONS_.EXPORT_URL,c,function(d){if(d.success){DialogUtils.success(msgCode.INFO,"导出中...");
ButtonUtils.enableBtn("exportExcel");}else{DialogUtils.error(msgCode.FAIL_MSG,d.msg);}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});
},};