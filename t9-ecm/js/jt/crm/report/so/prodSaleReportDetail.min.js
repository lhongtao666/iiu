$(function(){var a=new ProdSaleReportDetail();a.init();});function ProdSaleReportDetail(){this.hadInit=false;this.isEdit=false;this.sortColumn="";this.sortorder="";
}ProdSaleReportDetail._CONS_={LIST_DATA_URL:ctx+"/ec/salesorder/soEntity/findProdSaleSoDetail.htm",SO_DETAIL_PAGE_URL:ctx+"/ec/salesorder/soEntity/detail.htm",DETAIL_CS_PAGE_URL:ctx+"/crm/cs/csEntity/detail.htm",GRID:"#prodSaleDetailGrid",PAGER:"#prodSaleDetailPager"};
ProdSaleReportDetail.prototype={init:function(b){var a=this;if(!a.hadInit){a.hadInit=true;this._bindEventHander();a._initJqgrid();$(".timeRange").text("时间: "+timeStart+" 至 "+timeEnd);
}},_bindEventHander:function(){$("body").on("click",".soTab",function(){var a=$(this).attr("value");var b=$(this).attr("valueCsName");JTTabUtils.addOrRefreshTab(ProdSaleReportDetail._CONS_.SO_DETAIL_PAGE_URL+"?soNo="+a,b+"的订单明细");
});$("body").on("click",".csTab",function(){var a=$(this).attr("value");var c=$(this).attr("valueCsName");var b=$(this).attr("valueCsId");if(c.length>4){c="*"+c.substring(c.length-3,c.length);
}JTTabUtils.addOrRefreshTab(ProdSaleReportDetail._CONS_.DETAIL_CS_PAGE_URL+"?csId="+b,"客户["+c+"]明细");});},_initJqgrid:function(){var b="";if(paramsDetail.timeType=="sign"){b+="Q__D__BW__entity.complete_time_="+timeStart+" 00:00:00,"+timeEnd+" 23:59:59";
}else{b+="Q__D__BW__entity.create_time_="+timeStart+" 00:00:00,"+timeEnd+" 23:59:59";}if(paramsDetail.belongOgn){b+="&belongOgn="+paramsDetail.belongOgn;
}else{b+="&belongOgn=";}if(paramsDetail.Q__S__EQ__cate_id_){b+="&Q__S__EQ__cate_id_="+paramsDetail.Q__S__EQ__cate_id_;}else{b+="&Q__S__EQ__cate_id_=";}b+="&Q__S__EQ__item.sku_key_="+paramsDetail.Q__S__EQ__sku_key_;
var a=this;$(ProdSaleReportDetail._CONS_.GRID).JTJqgrid({url:ProdSaleReportDetail._CONS_.LIST_DATA_URL,postData:b,multiselect:false,footerrow:true,rowNum:-1,colNames:["产品名称","订单编号","客户编号","客户姓名",],colModel:[{name:"prodName",width:70,sortable:false},{name:"soNo",width:60,sortable:false,formatter:function(c,d,e){return"<a href='#' class='soTab' value='"+e.soNo+"' valueCsName= '"+e.csName+"'>"+e.soNo+"</a>";
}},{name:"csNo",width:60,sortable:false,formatter:function(c,d,e){return"<a href='#'  class='csTab' value='"+e.csNo+"' valueCsId = '"+e.csId+"' valueCsName = '"+e.csName+"'>"+e.csCode+"</a>";
}},{name:"csName",width:70,sortable:false}],gridComplete:function(){var c=$(ProdSaleReportDetail._CONS_.GRID).jqGrid("getGridParam","records");$(ProdSaleReportDetail._CONS_.GRID).footerData("set",{"csNo":"共<span style='color:red;'>"+c+"</span>条记录</span>"});
var d=$(ProdSaleReportDetail._CONS_.GRID).parents(".jqGrid_wrapper").find(".ui-jqgrid-sdiv").find("tr.footrow");d.find('td[aria-describedby*="prodName"],td[aria-describedby*="csName"],td[aria-describedby*="soNo"]').hide();
d.find("td").css({"font-weight":400});},});}};