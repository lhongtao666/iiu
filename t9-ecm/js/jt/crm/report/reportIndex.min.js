$(function(){var a=$("input[name=cateKey]").val();var b=new ReportIndex();b.init({cateKey:a});});function ReportIndex(){this.hadInit=false;this.isEdit=false;
this.isFormDataChange=false;this.cateKey=null;}ReportIndex._CONS_={TREE_URL:ctx+"/crm/report/report/treeData.htm",TREE_ID:"reportTree",};ReportIndex.prototype={init:function(b){if(!this.hadInit){this.cateKey=b.cateKey;
this.hadInit=true;this._bindEventHander();this._initReportTree();$(".jqGrid_wrapper").height($(window).height()-$(".jqGrid_wrapper").parent().prev().height()-35);
$(".jqGrid_wrapper").css("overflow","auto");var a=$(window).height()-15;$("iframe[name='reportIframe']").height(a);}},_bindEventHander:function(){var a=this;
$("#reportContainer").on("click","li.list-group-item",function(){$(this).siblings().removeClass("active");$(this).addClass("active");a._selectReport($(this));
});},_initReportTree:function(){var a=this;FormUtils.loadData(ReportIndex._CONS_.TREE_URL+"?cateType=reportAnalysis&cateKey="+a.cateKey,function(c){if(c){var h=[];
for(var f=0;f<c.length;f++){var e=-1;for(var d=0;d<h.length;d++){if(h[d].group==c[f].cateName){e=d;break;}}if(e<0){var b={group:c[f].cateName,index:f,reports:[c[f]]};
h.push(b);}else{h[e].reports.push(c[f]);}}var g=$.templates("#reportCateTmpl");var k=g.render(h);$("#reportContainer").empty().append(k);$("#reportContainer").find("ul li").eq(0).trigger("click");
}if(c==null||c.length<1){$("#reportContainer").append("<p class='text-primary'>暂无报表</p>");}});},_selectReport:function(b){var a=b.attr("urlValue");if(a.indexOf("?")>-1){a=ctx+a+"&reportKey="+b.attr("key");
}else{a=ctx+a+"?reportKey="+b.attr("key");}if($(".showReport_iframe").length>0){$(".showReport_iframe").attr("src",a);}else{$("iframe[name='reportIframe']").attr("src",a);
}}};