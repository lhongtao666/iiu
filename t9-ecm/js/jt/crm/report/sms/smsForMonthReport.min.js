$(function(){var a=new SmsForMonthReport();a.init();});function SmsForMonthReport(){this.hadInit=false;this.isEdit=false;this.baseUrl=ctx+"/crm/report/smsReport/smsForMonthReport/listData.htm";
this.exportUrl=ctx+"/crm/report/smsReport/smsForMonthReport/exportReport.htm";this.forDayUrl=ctx+"/crm/report/smsReport/smsForDayReport/list.htm";}SmsForMonthReport.GRID="#smsForMonthReportGrid";
SmsForMonthReport.prototype={init:function(b){var a=this;if(!a.hadInit){a.hadInit=true;a._bindEventHander();$("#beginDate").val(DateUtils.format(new Date(),"yyyy-MM"));
a._initJqgrid(a._getParam());}},_getParam:function(){var a={};if($("#beginDate").val()!=null&&$("#beginDate").val()!=""){a["beginDate"]=$("#beginDate").val();
}return a;},_bindEventHander:function(){var a=this;$(".layer-date").unbind("click");$(".layer-date").on("click",function(){laydate({istime:false,format:"YYYY-MM"});
});$("#thisMonth").on("click",function(){$("#beginDate").val(DateUtils.format(new Date(),"yyyy-MM"));});$("#preMonth").on("click",function(){var c=new Date();
c.setMonth(c.getMonth()-1);$("#beginDate").val(DateUtils.format(c,"yyyy-MM"));});$("#searchBtn").on("click",function(){var c=a._getParam();a.reloadJqgrid(c);
return false;});$("body").on("click",".forDayDetail",function(){var e=$(this).attr("dateVal");var c=$("#beginDate").val()+"-"+e;var d=a.forDayUrl+"?dateVal="+c;
JTTabUtils.addOrRefreshTab(d,e+"号时段短信发送统计");});$(".exportExcel").on("click",function(){var d=$("#exportType").val();var c=a.exportUrl;var e=a._getParam();
FormUtils.submit(c,e,function(f){if(f.success){DialogUtils.success(msgCode.INFO,f.msg+"成功");}else{DialogUtils.error(msgCode.FAIL_MSG,f.msg+"失败");}},function(){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);
});});function b(h,e){if(e=="first"){return h.getFullYear()+(h.getMonth()+1>9?"-"+(h.getMonth()+1):"-0"+(h.getMonth()+1))+"-01 00:00:00";}else{if(e=="last"){var f=h.getMonth();
var d=++f;var g=new Date(h.getFullYear(),d,1);var c=1000*60*60*24;h=new Date(g.getTime()-c);return h.getFullYear()+(h.getMonth()+1>9?"-"+(h.getMonth()+1):"-0"+(h.getMonth()+1))+(h.getDate()>9?"-"+h.getDate():"-0"+h.getDate())+" 23:59:59";
}else{return h.getFullYear()+(h.getMonth()+1>9?"-"+(h.getMonth()+1):"-0"+(h.getMonth()+1))+(h.getDate()>9?"-"+h.getDate():"-0"+h.getDate())+" 23:59:59";
}}}},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(SmsForMonthReport.GRID,a);},_initJqgrid:function(a){$(SmsForMonthReport.GRID).JTJqgrid({url:this.baseUrl,postData:a,footerrow:true,multiselect:false,width:"100%",autowidth:true,rowNum:-1,colNames:["部门","1号hide","2号hide","3号hide","4号hide","5号hide","6号hide","7号hide","8号hide","9号hide","10号hide","11号hide","12号hide","13号hide","14号hide","15号hide","16号hide","17号hide","18号hide","19号hide","20号hide","21号hide","22号hide","23号hide","24号hide","25号hide","26号hide","27号hide","28号hide","29号hide","30号hide","31号hide","1号","2号","3号","4号","5号","6号","7号","8号","9号","10号","11号","12号","13号","14号","15号","16号","17号","18号","19号","20号","21号","22号","23号","24号","25号","26号","27号","28号","29号","30号","31号","合计"],colModel:[{name:"groupName"},{name:"day01Count",hidden:true},{name:"day02Count",hidden:true},{name:"day03Count",hidden:true},{name:"day04Count",hidden:true},{name:"day05Count",hidden:true},{name:"day06Count",hidden:true},{name:"day07Count",hidden:true},{name:"day08Count",hidden:true},{name:"day09Count",hidden:true},{name:"day10Count",hidden:true},{name:"day11Count",hidden:true},{name:"day12Count",hidden:true},{name:"day13Count",hidden:true},{name:"day14Count",hidden:true},{name:"day15Count",hidden:true},{name:"day16Count",hidden:true},{name:"day17Count",hidden:true},{name:"day18Count",hidden:true},{name:"day19Count",hidden:true},{name:"day20Count",hidden:true},{name:"day21Count",hidden:true},{name:"day22Count",hidden:true},{name:"day23Count",hidden:true},{name:"day24Count",hidden:true},{name:"day25Count",hidden:true},{name:"day26Count",hidden:true},{name:"day27Count",hidden:true},{name:"day28Count",hidden:true},{name:"day29Count",hidden:true},{name:"day30Count",hidden:true},{name:"day31Count",hidden:true},{name:"day01Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day01Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='01'>"+d.day01Count+"</a>";}}},{name:"day02Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day02Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='02'>"+d.day02Count+"</a>";}}},{name:"day03Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day03Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='03'>"+d.day03Count+"</a>";}}},{name:"day04Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day04Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='04'>"+d.day04Count+"</a>";}}},{name:"day05Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day05Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='05'>"+d.day05Count+"</a>";}}},{name:"day06Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day06Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='06'>"+d.day06Count+"</a>";}}},{name:"day07Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day07Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='07'>"+d.day07Count+"</a>";}}},{name:"day08Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day08Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='08'>"+d.day08Count+"</a>";}}},{name:"day09Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day09Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='09'>"+d.day09Count+"</a>";}}},{name:"day10Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day10Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='10'>"+d.day10Count+"</a>";}}},{name:"day11Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day11Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='11'>"+d.day11Count+"</a>";}}},{name:"day12Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day12Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='12'>"+d.day12Count+"</a>";}}},{name:"day13Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day13Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='13'>"+d.day13Count+"</a>";}}},{name:"day14Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day14Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='14'>"+d.day14Count+"</a>";}}},{name:"day15Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day15Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='15'>"+d.day15Count+"</a>";}}},{name:"day16Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day16Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='16'>"+d.day16Count+"</a>";}}},{name:"day17Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day17Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='17'>"+d.day17Count+"</a>";}}},{name:"day18Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day18Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='18'>"+d.day18Count+"</a>";}}},{name:"day19Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day19Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='19'>"+d.day19Count+"</a>";}}},{name:"day20Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day20Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='20'>"+d.day20Count+"</a>";}}},{name:"day21Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day21Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='21'>"+d.day21Count+"</a>";}}},{name:"day22Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day22Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='22'>"+d.day22Count+"</a>";}}},{name:"day23Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day23Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='23'>"+d.day23Count+"</a>";}}},{name:"day24Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day24Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='24'>"+d.day24Count+"</a>";}}},{name:"day25Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day25Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='25'>"+d.day25Count+"</a>";}}},{name:"day26Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day26Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='26'>"+d.day26Count+"</a>";}}},{name:"day27Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day27Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='27'>"+d.day27Count+"</a>";}}},{name:"day28Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day28Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='28'>"+d.day28Count+"</a>";}}},{name:"day29Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day29Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='29'>"+d.day29Count+"</a>";}}},{name:"day30Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day30Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='30'>"+d.day30Count+"</a>";}}},{name:"day31Count",formatter:function(b,c,d){if(d.groupName.indexOf("合计(条)：")>-1){return"<span style='color:red;'>"+d.day31Count+"</span>";
}else{return"<a class='forDayDetail' dateVal='31'>"+d.day31Count+"</a>";}}},{name:"total"}],gridComplete:function(F){var w=$(SmsForMonthReport.GRID).jqGrid("getCol","day01Count",true,"sum");
var u=$(SmsForMonthReport.GRID).jqGrid("getCol","day02Count",true,"sum");var t=$(SmsForMonthReport.GRID).jqGrid("getCol","day03Count",true,"sum");var r=$(SmsForMonthReport.GRID).jqGrid("getCol","day04Count",true,"sum");
var p=$(SmsForMonthReport.GRID).jqGrid("getCol","day05Count",true,"sum");var n=$(SmsForMonthReport.GRID).jqGrid("getCol","day06Count",true,"sum");var l=$(SmsForMonthReport.GRID).jqGrid("getCol","day07Count",true,"sum");
var j=$(SmsForMonthReport.GRID).jqGrid("getCol","day08Count",true,"sum");var h=$(SmsForMonthReport.GRID).jqGrid("getCol","day09Count",true,"sum");var z=$(SmsForMonthReport.GRID).jqGrid("getCol","day10Count",true,"sum");
var y=$(SmsForMonthReport.GRID).jqGrid("getCol","day11Count",true,"sum");var x=$(SmsForMonthReport.GRID).jqGrid("getCol","day12Count",true,"sum");var v=$(SmsForMonthReport.GRID).jqGrid("getCol","day13Count",true,"sum");
var s=$(SmsForMonthReport.GRID).jqGrid("getCol","day14Count",true,"sum");var q=$(SmsForMonthReport.GRID).jqGrid("getCol","day15Count",true,"sum");var o=$(SmsForMonthReport.GRID).jqGrid("getCol","day16Count",true,"sum");
var m=$(SmsForMonthReport.GRID).jqGrid("getCol","day17Count",true,"sum");var k=$(SmsForMonthReport.GRID).jqGrid("getCol","day18Count",true,"sum");var i=$(SmsForMonthReport.GRID).jqGrid("getCol","day19Count",true,"sum");
var e=$(SmsForMonthReport.GRID).jqGrid("getCol","day20Count",true,"sum");var d=$(SmsForMonthReport.GRID).jqGrid("getCol","day21Count",true,"sum");var c=$(SmsForMonthReport.GRID).jqGrid("getCol","day22Count",true,"sum");
var b=$(SmsForMonthReport.GRID).jqGrid("getCol","day23Count",true,"sum");var H=$(SmsForMonthReport.GRID).jqGrid("getCol","day24Count",true,"sum");var E=$(SmsForMonthReport.GRID).jqGrid("getCol","day25Count",true,"sum");
var D=$(SmsForMonthReport.GRID).jqGrid("getCol","day26Count",true,"sum");var C=$(SmsForMonthReport.GRID).jqGrid("getCol","day27Count",true,"sum");var B=$(SmsForMonthReport.GRID).jqGrid("getCol","day28Count",true,"sum");
var A=$(SmsForMonthReport.GRID).jqGrid("getCol","day29Count",true,"sum");var g=$(SmsForMonthReport.GRID).jqGrid("getCol","day30Count",true,"sum");var f=$(SmsForMonthReport.GRID).jqGrid("getCol","day31Count",true,"sum");
var G=$(SmsForMonthReport.GRID).jqGrid("getCol","total",true,"sum");$(SmsForMonthReport.GRID).jqGrid("footerData","set",{"groupName":"合计(条)：<span style='color:red;'></span>","day01Count":"<span style='color:red;'>"+w+"</span>","day02Count":"<span style='color:red;'>"+u+"</span>","day03Count":"<span style='color:red;'>"+t+"</span>","day04Count":"<span style='color:red;'>"+r+"</span>","day05Count":"<span style='color:red;'>"+p+"</span>","day06Count":"<span style='color:red;'>"+n+"</span>","day07Count":"<span style='color:red;'>"+l+"</span>","day08Count":"<span style='color:red;'>"+j+"</span>","day09Count":"<span style='color:red;'>"+h+"</span>","day10Count":"<span style='color:red;'>"+z+"</span>","day11Count":"<span style='color:red;'>"+y+"</span>","day12Count":"<span style='color:red;'>"+x+"</span>","day13Count":"<span style='color:red;'>"+v+"</span>","day14Count":"<span style='color:red;'>"+s+"</span>","day15Count":"<span style='color:red;'>"+q+"</span>","day16Count":"<span style='color:red;'>"+o+"</span>","day17Count":"<span style='color:red;'>"+m+"</span>","day18Count":"<span style='color:red;'>"+k+"</span>","day19Count":"<span style='color:red;'>"+i+"</span>","day20Count":"<span style='color:red;'>"+e+"</span>","day21Count":"<span style='color:red;'>"+d+"</span>","day22Count":"<span style='color:red;'>"+c+"</span>","day23Count":"<span style='color:red;'>"+b+"</span>","day24Count":"<span style='color:red;'>"+H+"</span>","day25Count":"<span style='color:red;'>"+E+"</span>","day26Count":"<span style='color:red;'>"+D+"</span>","day27Count":"<span style='color:red;'>"+C+"</span>","day28Count":"<span style='color:red;'>"+B+"</span>","day29Count":"<span style='color:red;'>"+A+"</span>","day30Count":"<span style='color:red;'>"+g+"</span>","day31Count":"<span style='color:red;'>"+f+"</span>","total":"<span style='color:red;'>"+G+"</span>",});
},});}};