$(function(){var a=new ModuleColumnGenExcel();a.init();});function ModuleColumnGenExcel(){}ModuleColumnGenExcel._CONS_={LOAD_COLUMN_URL:ctx+"/gl/mc/moduleColumn/findByModule.htm",};
ModuleColumnGenExcel.prototype={init:function(b){var a=this;a._bindEventHander();a._loadColumn(module);},_loadColumn:function(b){var a=["客户ID","客户名称","客户编码","意向","渠道来源","产品意向","客户标签","进线方式","客户分类","省份","省市","城市","区域","详细地址","性别","联系电话1","联系电话2","联系电话3","联系电话4","归属工号","创建工号"];
var c=[];var d=LocalStorageUtils.get("CS_EXPORT_COLUMNS_TMPL"+currentUserId);if(d){c=d.split(",");}excelUtil.findExportColByModule(b,true,function(e){var f=true;
ConfigUtils.findByKey("csEntity.limit.wineIndustry",function(m){if(m.success){f=false;}var l=new StringBuffer();if(e&&e.length>0){var j="";var h="";for(var k=0;
k<e.length;k++){var g="<div class='col-sm-2'><div class='checkbox checkbox-success checkbox-inline'>";if($.inArray(e[k].name,a)!=-1){if($.inArray(e[k].devCode,c)!=-1){g+="<input type='checkbox' checked class='form-config-check columnCheckBox' devCode='"+e[k].devCode+"'  name='exportColumn' id="+e[k].id+" value='"+e[k].showCode+"' colName='"+e[k].name+"'><label for='"+e[k].id+"'>"+e[k].name+"</label>";
}else{g+="<input type='checkbox' class='form-config-check columnCheckBox' devCode='"+e[k].devCode+"' name='exportColumn' id="+e[k].id+" value='"+e[k].showCode+"' colName='"+e[k].name+"'><label for='"+e[k].id+"'>"+e[k].name+"</label>";
}g+="</div></div>";h+=g;}else{if(f&&(e[k].name=="口感"||e[k].name=="用途")){}else{if($.inArray(e[k].devCode,c)!=-1){g+="<input type='checkbox' checked class='form-config-check columnCheckBox' devCode='"+e[k].devCode+"'  name='exportColumn' id="+e[k].id+" value='"+e[k].showCode+"' colName='"+e[k].name+"'><label for='"+e[k].id+"'>"+e[k].name+"</label>";
}else{g+="<input type='checkbox' class='form-config-check columnCheckBox' devCode='"+e[k].devCode+"' name='exportColumn' id="+e[k].id+" value='"+e[k].showCode+"' colName='"+e[k].name+"'><label for='"+e[k].id+"'>"+e[k].name+"</label>";
}g+="</div></div>";j+=g;}}}j="<div class='basic-items-title'>常用字段</div>"+h+"<div  class='other-items-title'>其他字段</div>"+j;}$("#columnContainer").empty().append(j);
});});},_bindEventHander:function(){var a=this;$(".genExcel").on("click",function(){var g={};var f=[];var d=$(".colName");var e=$(".colCode");g.module="csEntity";
g.moduleColumnPos=[];var c=$("#columnContainer").find(".columnCheckBox");$(c).each(function(){if($(this).is(":checked")){var h={};h.name=$(this).attr("colName");
h.showCode=$(this).val();g.moduleColumnPos.push(h);f.push($(this).attr("devCode"));}});LocalStorageUtils.set("CS_EXPORT_COLUMNS_TMPL"+currentUserId,f.toString());
var b={columnJson:JSON.stringify(g),moduleText:moduleText};window.location.href=ctx+"/gl/mc/moduleColumn/genExcel.htm?"+$.param(b);});$("body").on("click","#allCheck",function(){var b=true;
if(!$(this).is(":checked")){b=false;}$("#columnContainer").find(".columnCheckBox").each(function(){$(this).prop("checked",b);});});},};