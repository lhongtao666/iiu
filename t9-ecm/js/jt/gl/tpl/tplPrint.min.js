function TplPrint(){this.hadInit=false;}TplPrint._CONS_={EDIT_URL:ctx+"/crm/components/upload/download.htm",ENTITY_INFO_URL:ctx+"/gl/tpl/tplPrint/getTplInfo.htm",ADD_TPL_URL:ctx+"/gl/tpl/tplPrint/addTpl.htm",ENTITY_PRINT_DATA_URL:ctx+"/gl/tpl/tplPrint/getPrintData.htm",};
TplPrint.prototype={init:function(a){},loadTplFuc:function(b,a,d,c){loadTpl(TplPrint._CONS_.EDIT_URL+"?dname="+a+"&durl="+d,b,c);},saveReport:function(c,b){c.Post();
var a=c.Report.SaveToStr();$.ajax({type:"POST",url:TplPrint._CONS_.ADD_TPL_URL+"?id="+b,data:a,contentType:"text/html",dataType:"json",success:function(d){if(d.success){alert(d.msg);
DialogUtils.success(msgCode.INFO,d.msg);}else{DialogUtils.error(msgCode.FAIL_MSG,d.msg);}},error:function(d){console.log(d);}});c.DefaultAction=false;},loadEntityInfo:function(b,c,d){c=c.split(",");
var a=this;$.ajax({type:"GET",url:TplPrint._CONS_.ENTITY_INFO_URL+"?entityId="+c[0]+"&entityType="+d,contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(e){if(e.path){var f=e.path.substr(e.path.lastIndexOf("/")+1,e.path.length);
a.loadTplFuc(b,f,e.path,function(){a.loadPrintData(b,c,d);});}else{alert("找不到模板");}},error:function(e){console.log(e);}});},loadEntityShipInfo:function(c,d,e,a){d=d.split(",");
var b=this;$.ajax({type:"GET",url:TplPrint._CONS_.ENTITY_INFO_URL+"?entityId="+d[0]+"&entityType="+e+"&proxyType="+a,contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(f){if(f.path){var g=f.path.substr(f.path.lastIndexOf("/")+1,f.path.length);
b.loadTplFuc(c,g,f.path,function(){b.loadPrintShipData(c,d,e);});}else{alert("找不到模板");}},error:function(f){console.log(f);}});},loadPrintData:function(b,c,d){var a=this;
b.Stop();$.ajax({type:"GET",url:TplPrint._CONS_.ENTITY_PRINT_DATA_URL+"?entityId="+c+"&entityType="+d,contentType:"application/x-www-form-urlencoded",dataType:"text",success:function(e){b.Report.LoadDataFromXML(e);
b.Start();},error:function(e){console.log(e);}});},loadPrintShipData:function(b,c,d){var a=this;b.Stop();$.ajax({type:"GET",url:TplPrint._CONS_.ENTITY_PRINT_DATA_URL+"?entityId="+c+"&entityType="+d,contentType:"application/x-www-form-urlencoded",dataType:"text",success:function(e){b.Report.LoadDataFromXML(e);
b.Start();},error:function(e){console.log(e);}});},};