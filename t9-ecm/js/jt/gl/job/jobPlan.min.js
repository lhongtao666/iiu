function JobPlan(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;this.params=null;this.defaultSwitchery=null;this.statusSwitchery=null;
this.data=null;this.detail=false;}JobPlan._CONS_={EDIT_URL:ctx+"/gl/job/jobPlan/edit.htm",DETAIL_URL:ctx+"/gl/job/jobPlan/detail.htm",DELETE_URL:ctx+"/gl/job/jobPlan/delete.htm",SAVE_ADD_URL:ctx+"/gl/job/jobPlan/saveAdd.htm",SAVE_EDIT_URL:ctx+"/gl/job/jobPlan/saveEdit.htm",LIST_DATA_URL:ctx+"/gl/job/jobPlan/listData.htm",LOAD_DEF_PARAM_URL:ctx+"/gl/job/jobPlan/findJobParam.htm",RUN_HI_TAB_NAME:"任务日志",EDIT_FORM_ID:"jobPlanForm",GRID:"#jobPlanGrid",PAGER:"#jobPlanPager"};
JobPlan.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindFormValidation();this._bindEventHander();this.params=a;this._initJqgrid(a);
this._hideNotGrantBtn();CateUtils.getOptions({typeKey:"system",pKey:"jobGroupId",container:"groupSelect"});}},_hideNotGrantBtn:function(){},clear:function(c){var a=this;
function b(){a._showListWrapper();a.isFormDataChange=false;a.isEdit=false;a.detail=false;$(".form_wrapper .saveBtn").show();$(".showWhenHasParam").hide();
$(".hiddenWhenNoParam").hide();FormUtils.clear(JobPlan._CONS_.EDIT_FORM_ID);FormUtils.enableForm(JobPlan._CONS_.EDIT_FORM_ID);if(c){a.reloadJqgrid();}a.data=null;
}if(a.isEdit&&a.isFormDataChange){DialogUtils.warning(function(){b();});}else{b();}},_showListWrapper:function(){$(".list_wrapper").show();$(".form_wrapper").hide();
},_showFormWrapper:function(){$(".paramTable tbody").empty();$(".list_wrapper").hide();$(".form_wrapper").show();},_add:function(){var a=this;$(".add-group").show();
$(".detail-group").hide();this._showFormWrapper();$("[name=runType]").trigger("change");$(".default-status").empty().append('<input type="checkbox" value="y" name="isDefault" class="js-switch" />');
$(".status-status").empty().append('<input type="checkbox" value="run" name="status" class="js-switch" checked />');a.defaultSwitchery=new Switchery(document.querySelector(".default-status .js-switch"),{color:"#1AB394"});
a.statusSwitchery=new Switchery(document.querySelector(".status-status .js-switch"),{color:"#1AB394"});a._loadJobParam();},_loadJobParam:function(){var a=this;
var c=Q__S__EQ__job_id_;var b=JobPlan._CONS_.LOAD_DEF_PARAM_URL+"?jobDefId="+c;FormUtils.loadData(b,function(e){var g=new StringBuffer();for(var d=0;d<e.length;
d++){var f=a._createTr(e[d]);g.append(f);}if(e.length>0){$(".hiddenWhenNoParam").show();}$(".paramTable tbody").append(g.toString());});},_createTr:function(e){var b=this;
var c=(e&&e.name)?e.name:"";var d=(e&&e.value)?e.value:"";var a=(e&&e.dataType)?e.dataType:"";var f=new StringBuffer();f.append("<tr>");f.append("<td>");
f.append('<input  readonly="readonly" value="'+c+'" name="paramName"  validateType="default" type="text" class="form-control paramName" >');f.append("</td>");
f.append("<td>");f.append(b._createSelect(a));f.append("</td>");f.append("<td>");f.append(b._createInput(a,d));f.append("</td>");f.append("</tr>");return f.toString();
},_createSelect:function(a){var b=new StringBuffer();b.append('<select class="form-control dataTypeValue" name="dataType" disabled="disabled">');if(a=="string"){b.append('<option value="string" selected="selected" >字符串</option>');
}else{b.append('<option value="string">字符串</option>');}if(a=="boolean"){b.append('<option value="boolean" selected="selected" >布尔</option>');}else{b.append('<option value="boolean">布尔</option>');
}if(a=="integer"){b.append('<option value="integer" selected="selected" >整数</option>');}else{b.append('<option value="integer">整数</option>');}if(a=="decimal"){b.append('<option value="decimal" selected="selected" >浮点数</option>');
}else{b.append('<option value="decimal">浮点数</option>');}if(a=="date"){b.append('<option value="date" selected="selected" >短日期(yyyy-MM-dd)</option>');}else{b.append('<option value="date" >短日期(yyyy-MM-dd)</option>');
}if(a=="datetime"){b.append('<option value="datetime" selected="selected" >长日期(yyyy-MM-dd hh:mm:ss)</option>');}else{b.append('<option value="datetime">长日期(yyyy-MM-dd HH:mm:ss)</option>');
}b.append("</select>");return b.toString();},_createInput:function(a,c){var b="";if(a=="string"){b='<input  value="'+c+'" name="paramValue" validateType="default" type="text" class="form-control paramValue" >';
}else{if(a=="boolean"){if(c==null||c==""){b='<input type="radio" value="true"  name="paramValue" class="paramValue">是<input type="radio" value="false" name="paramValue"class="paramValue">否';
}else{if(c=="true"||c==true){b='<input type="radio" value="true" checked="checked" name="paramValue"class="paramValue">是<input type="radio" value="false" name="paramValue"class="paramValue">否';
}else{if(c=="false"||c==false){b='<input type="radio" value="true"  name="paramValue"class="paramValue">是<input type="radio" value="false" checked="checked" name="paramValue"class="paramValue">否';
}}}}else{if(a=="integer"||a=="decimal"){b='<input  value="'+c+'" name="paramValue" validateType="default" type="number" class="form-control paramValue" >';
}else{if(a=="date"){b='<input value="'+c+'" name="paramValue" class="laydate-icon form-control layer-date date paramValue" validateType="default"  style="cursor:pointer;">';
}else{if(a=="datetime"){b='<input value="'+c+'" name="paramValue" class="laydate-icon form-control layer-date datetime paramValue" validateType="default" style="cursor:pointer;">';
}}}}}return b;},_edit:function(a){$(".add-group").show();$(".detail-group").hide();this._showFormWrapper();this.edit=true;this._loadData(a);},_detail:function(a){$(".add-group").hide();
$(".detail-group").show();this.detail=true;this._showFormWrapper();this._loadData(a,true);$(".form_wrapper .saveBtn").hide();},_loadData:function(d,b){var a=this;
var c=b?JobPlan._CONS_.DETAIL_URL:JobPlan._CONS_.EDIT_URL;FormUtils.loadData(c+"?id="+d,function(f){a.data=f;$("[name=id]").val(f.id);$("[name=jobId]").val(f.jobId);
$("[name=name]").val(f.name);$("[name=group]").val(f.group);$("[name=type]").val(f.type);$("[name=exprSet]").val(f.exprSet);$("[name=expr]").val(f.expr);
$("[name=comment]").val(f.comment);$("[name=lastRunTime]").val(f.lastRunTime);if(f.isDefault=="y"){$(".default-status").empty().append('<input   type="checkbox" value="y" name="isDefault" class="js-switch" checked />');
}else{$(".default-status").empty().append('<input  type="checkbox" value="y" name="isDefault" class="js-switch" />');}$("[name=createBy]").val(f.createBy);
$("[name=createTime]").val(f.createTime);$("[name=updateBy]").val(f.updateBy);$("[name=updateTime]").val(f.updateTime);if(f.status=="run"){$("[name=executeStatus]").val("执行中");
$(".status-status").empty().append('<input  type="checkbox" value="run" name="status" class="js-switch" checked />');}else{$("[name=executeStatus]").val("未执行");
$(".status-status").empty().append('<input  type="checkbox" value="run" name="status" class="js-switch" />');}$("[name=runType]").val(f.runType);$("[name=runType]").trigger("change");
$("[name=intervalTime]").val(f.intervalTime);$("[name=timeMin]").val(f.timeMin>=10?f.timeMin:("0"+f.timeMin));$("[name=timeHour]").val(f.timeHour>=10?f.timeHour:("0"+f.timeHour));
$("[name=weekValues]").val(f.weekValues);$("[name=weekHour]").val(f.weekHour>=10?f.weekHour:("0"+f.weekHour));$("[name=weekMin]").val(f.weekMin>=10?f.weekMin:("0"+f.weekMin));
$("[name=monthValues]").val(f.monthValues);$("[name=monthHour]").val(f.monthHour>=10?f.monthHour:("0"+f.monthHour));$("[name=monthMin]").val(f.monthMin>=10?f.monthMin:("0"+f.monthMin));
$("[name=oneMin]").val(f.oneMin>=10?f.oneMin:("0"+f.oneMin));$("[name=oneHour]").val(f.oneHour>=10?f.oneHour:("0"+f.oneHour));$("[name=runTime]").val(f.runTime);
a.defaultSwitchery=new Switchery(document.querySelector(".default-status .js-switch"),{color:"#1AB394",disabled:b?b:false});a.statusSwitchery=new Switchery(document.querySelector(".status-status .js-switch"),{color:"#1AB394"});
var h=new StringBuffer();for(var e=0;e<f.jobParamList.length;e++){var g=a._createTr(f.jobParamList[e]);h.append(g);}$(".paramTable tbody").append(h.toString());
if(f.hasParam=="y"){$($("input[name='isNeedParam']")[1]).click();$(".hiddenWhenNoParam").show();}else{$(".hiddenWhenNoParam").hide();}if(b){FormUtils.disableForm(JobPlan._CONS_.EDIT_FORM_ID);
}});},_save:function(){var h=this;var a=$("#id").val();var g=null;if(a!=null&&a!=""){g=JobPlan._CONS_.SAVE_EDIT_URL;}else{g=JobPlan._CONS_.SAVE_ADD_URL;
}$("[name=exprSet]").val("view");$("[name=jobId]").val(h.params.Q__S__EQ__job_id_);var c=$("[name=runType]").val();if(c=="one_time"){$("[name=type]").val("one_time");
}else{if(c=="run_on_start"){$("[name=type]").val("run_on_start");}else{if(c=="fix_plan"){$("[name=type]").val("fix_plan");}else{$("[name=type]").val("expr");
if(c=="week"){var e=$("[name=weekValueSelect]").val();if(!e||e.length==0){DialogUtils.error(msgCode.ERROR,"星期没有选择");return;}else{$("[name=weekValues]").val(e.join(","));
}}else{if(c=="month"){var f=$("[name=monthValueSelect]").val();if(!f||f.length==0){DialogUtils.error(msgCode.ERROR,"月份日期没有选择");return;}else{$("[name=monthValues]").val(f.join(","));
}}}}}}var b=$(".paramTable tbody tr");var d=[];var i=$("input[name='isNeedParam']:radio:checked").val();if(i=="y"){b.each(function(j){var k={};k.name=$(this).find(".paramName").val();
k.dataType="string";if(k.dataType=="boolean"){k.value=$(this).find(".paramValue:radio:checked").val();}else{k.value=$(this).find(".paramValue").val();}k.key=$(this).find(".paramName").val();
if(!(k.value==null||k.value=="")){d.push(k);}});}$("[name=jobParamJSON]").val(JSON.stringify(d));if($("#jobPlanForm").valid()){ButtonUtils.disableBtn("saveBtn");
FormUtils.submitByFormId(g,JobPlan._CONS_.EDIT_FORM_ID,function(j){ButtonUtils.enableBtn("saveBtn");if(j.success){if(j.msgCode==actionCode.CREATE){DialogUtils.success(msgCode.INFO,msgCode.CREATE_MSG);
}else{if(j.msgCode==actionCode.UPDATE){DialogUtils.success(msgCode.INFO,msgCode.UPDATE_MSG);}}h.isEdit=false;h.clear(true);}else{DialogUtils.error(msgCode.FAIL_MSG,j.msg);
}},function(){ButtonUtils.enableBtn("saveBtn");DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}},_delete:function(b){var a=this;DialogUtils.confirm(function(){FormUtils.del(JobPlan._CONS_.DELETE_URL,b,function(c){if(c.success){DialogUtils.success(msgCode.INFO,msgCode.DELETE_MSG);
a.reloadJqgrid();}else{DialogUtils.error(msgCode.ERROR,c.msg);}});});},_hideAllOption:function(){$("#time-option").empty();},showOneTimeDiv:function(){var a=new StringBuffer();
a.append('<div class="form-group one_time_div">');a.append('<label class="col-sm-1 control-label">时间设置</label>');a.append('<input class="col-sm-3 laydate-icon form-control layer-date" value="2016-08-24" name="runTime" validateType="default" placeholder="YYYY-MM-DD" onclick="laydate({istime: true, format: \'YYYY-MM-DD\'})">');
a.append('<div class="col-sm-2">');a.append('<select name="oneHour" class="hourOption form-control">');a.append(this._loadHourOption());a.append("</select>");
a.append("</div>");a.append('<div class="col-sm-2">');a.append('<select name="oneMin" class="minuteOption  form-control">');a.append(this._loadMinuteOption());
a.append("</select>");a.append("</div>");a.append("</div>");return a.toString();},showDateIntervalDiv:function(){var b=new StringBuffer();b.append('<div class="form-group date_interval_div">');
b.append('<label class="col-sm-1 control-label">时间设置</label>');b.append('<div class=" col-sm-3">');var a=this.data?this.data.intervalTime:"";b.append('<input value="'+a+'" required digits=true min=1 type="text" name="intervalTime" placeholder="" class="form-control" validateType="default">');
b.append("</div>");b.append("</div>");return b.toString();},showDateTimeDiv:function(){var c=new StringBuffer();c.append('<div class="form-group date_time_div">');
c.append('<label class="col-sm-1 control-label">时间设置</label>');c.append(' <div class="col-sm-2">');c.append('<select name="timeHour" class="hourOption form-control">');
var b=this.data?this.data.oneHour:"";c.append(this._loadHourOption(b));c.append("</select>");c.append("</div>");c.append('<div class="col-sm-2">');c.append('<select name="timeMin" class="minuteOption form-control">');
var a=this.data?this.data.oneMin:"";c.append(this._loadMinuteOption(a));c.append("</select>");c.append("</div>");c.append("</div>");return c.toString();
},showWeekDiv:function(){var f=new StringBuffer();f.append('<div class="form-group week_div">');f.append('<label class="col-sm-1 control-label">时间设置</label>');
f.append('<div class="col-sm-3 ">');f.append('<input type="hidden"  name="weekValues" >');f.append('<select id="weekDay" required name="weekValueSelect" data-placeholder="请选择" multiple class="chosen-select form-control" tabindex="4">');
var a=this.data?this.data.weekValues:"";for(var b=1;b<=7;b++){f.append("<option "+((a&&a.indexOf(b)!=-1)?"selected":"")+'  value="'+b+'">');var c="周日";
switch(b){case 1:c="周日";break;case 2:c="周一";break;case 3:c="周二";break;case 4:c="周三";break;case 5:c="周四";break;case 6:c="周五";break;case 7:c="周六";break;}f.append(c);
f.append("</option>");}f.append("</select>");f.append("</div>");f.append('<div class="col-sm-2">');f.append('<select name="weekHour" class="hourOption  form-control">');
var e=this.data?this.data.oneHour:"";f.append(this._loadHourOption(e));f.append("</select>");f.append("</div>");f.append('<div class="col-sm-2">');f.append('<select name="weekMin" class="minuteOption  form-control">');
var d=this.data?this.data.oneMin:"";f.append(this._loadMinuteOption(d));f.append("</select>");f.append(" </div>");f.append("</div>");return f.toString();
},showMonthDiv:function(){var f=new StringBuffer();f.append('<div class="form-group month_div">');f.append('<label class="col-sm-1 control-label">时间设置</label>');
f.append('<div class="col-sm-3 ">');f.append('<input type="hidden" name="monthValues" /> ');f.append('<select id="monthDay" required name="monthValueSelect" data-placeholder="请选择" multiple class="chosen-select  form-control" tabindex="4">');
f.append('<option value="L">最后一天</option>');var h=this.data?this.data.monthValues:"";var e=h?h.split(","):[];for(var d=1;d<=31;d++){f.append("<option ");
var k="";for(var c=0;c<e.length;c++){var g=e[c];if(g==d){k=" selected ";break;}}f.append(k);f.append(' value="'+d+'">');f.append(d);f.append("</option>");
}f.append("</select>");f.append("</div>");f.append('<div class="col-sm-2">');f.append('<select name="monthHour" class="hourOption form-control ">');var a=this.data?this.data.oneHour:"";
f.append(this._loadHourOption(a));f.append("</select>");f.append("</div>");f.append('<div class="col-sm-2">');f.append('<select name="monthMin" class="minuteOption form-control ">');
var b=this.data?this.data.oneMin:"";f.append(this._loadMinuteOption(b));f.append("</select>");f.append("</div>");f.append("</div>");return f.toString();
},_bindEventHander:function(){var a=this;$("body").on("change","[name=runType]",function(){var c=$(this).val();a._hideAllOption();var b=null;if(c=="one_time"){b=a.showOneTimeDiv();
}else{if(c=="date_interval"){b=a.showDateIntervalDiv();}else{if(c=="date_time"){b=a.showDateTimeDiv();}else{if(c=="week"){b=a.showWeekDiv();}else{if(c=="month"){b=a.showMonthDiv();
}else{b="";}}}}}$("#time-option").show();$("#time-option").empty().append(b);$("[name=monthValueSelect]").chosen("destroy");$("[name=monthValueSelect]").chosen();
$("[name=monthValueSelect]").attr("disabled",a.detail).trigger("chosen:updated");$("[name=weekValueSelect]").chosen("destroy");$("[name=weekValueSelect]").chosen();
$("[name=weekValueSelect]").attr("disabled",a.detail).trigger("chosen:updated");});$("body").on("click",".runPlan",function(){console.log("runPlan");var c=ctx+"/gl/job/jobDef/runPlan.htm";
var f=$(this).attr("idVal");if(!f){f=$(JobPlan._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(f==null||f.length==0){DialogUtils.error(msgCode.error,"请选择要操作的记录");
return;}else{if(f.length>1){DialogUtils.error(msgCode.error,"不能操作多条记录");return;}}}var d=$(JobPlan._CONS_.GRID).jqGrid("getRowData",f);var b=d.jobId;var e={defId:b,planId:f,};
FormUtils.submit(c,e,function(g){if(g.success){DialogUtils.success(msgCode.SUCCESS,g.msg);a.reloadJqgrid();}else{DialogUtils.error(msgCode.ERROR,g.msg);
}});});$("body").on("click",".stopPlan",function(){console.log("stopPlan");var c=ctx+"/gl/job/jobDef/stopPlan.htm";var f=$(this).attr("idVal");if(!f){f=$(JobPlan._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(f==null||f.length==0){DialogUtils.error(msgCode.error,"请选择要操作的记录");return;}else{if(f.length>1){DialogUtils.error(msgCode.error,"不能操作多条记录");return;}}}var d=$(JobPlan._CONS_.GRID).jqGrid("getRowData",f);
var b=d.jobId;var e={defId:b,planId:f,};FormUtils.submit(c,e,function(g){if(g.success){DialogUtils.success(msgCode.SUCCESS,g.msg);a.reloadJqgrid();}else{DialogUtils.error(msgCode.ERROR,g.msg);
}});});$("body").on("click",".jobPlanHist",function(){var e=$(this).attr("idVal");if(!e){e=$(JobPlan._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(e==null||e.length==0){DialogUtils.error(msgCode.error,"请选择要操作的记录");
return;}else{if(e.length>1){DialogUtils.error(msgCode.error,"不能操作多条记录");return;}}}var d=$(JobPlan._CONS_.GRID).jqGrid("getRowData",e);var b=d.jobId;var c=d.name;
c=c.length>5?(c.substring(0,3)+"..."):c;JTTabUtils.addOrRefreshTab(ctx+"/gl/job/jobRunHi/list.htm?Q__S__EQ__key_="+b+"-"+e,c+JobPlan._CONS_.RUN_HI_TAB_NAME);
});$(document).on("click",".prevBtn",function(){a.clear(false);});$(document).on("click",".saveBtn",function(){a._save();});$(document).on("click",".date",function(){laydate({istime:true,format:"YYYY-MM-DD"});
});$(document).on("click",".datetime",function(){laydate({istime:true,format:"YYYY-MM-DD hh:mm:ss"});});$(document).on("click","input[name='isNeedParam']",function(){var b=$(this).val();
if(b=="n"){$(".showWhenHasParam").hide();}else{$(".showWhenHasParam").show();}});$("#"+JobPlan._CONS_.EDIT_FORM_ID).on("change","input",function(){if(a.isEdit){a.isFormDataChange=true;
}});$("#"+JobPlan._CONS_.EDIT_FORM_ID).on("change","select",function(){if(a.isEdit){a.isFormDataChange=true;}});$("#"+JobPlan._CONS_.EDIT_FORM_ID).on("change","textarea",function(){if(a.isEdit){a.isFormDataChange=true;
}});$("#jobPlanSearch").on("click",function(){var b=$(this).closest("form").serialize();a.reloadJqgrid(b);});$("#jobPlanSearch").on("keypress",function(b){if(b.keyCode=="13"){$(".jobPlanSearch").trigger("click");
}});$("body").on("click",".jobPlanAdd",function(){a._add();});$("body").on("click",".jobPlanEdit",function(){var b=$(this).attr("idVal");if(!b){b=$(JobPlan._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);
return;}}}a._edit(b);});$("body").on("click",".jobPlanDel",function(){var b=$(this).attr("idVal");if(!b){b=$(JobPlan._CONS_.GRID).jqGrid("getGridParam","selarrrow");
if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_DELETE);return;}}a._delete(b);});$("body").on("click",".jobPlanDetail",function(){var b=$(this).attr("idVal");
if(!b){b=$(JobPlan._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_DETAIL);
return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.error,msgCode.ERROR_DETAIL_MUL_RECORD);return;}}}a._detail(b);});},_loadHourOption:function(c){var f=new StringBuffer();
for(var d=0;d<24;d++){var a=d;if(a<10){a="0"+d;}var b=(d==c||a==c);var e="<option "+(b?"selected":"")+" value="+a+">"+d+"点</option>";f.append(e);}return f.toString();
},_loadMinuteOption:function(d){var f=new StringBuffer();for(var c=0;c<60;c++){var a=c;if(a<10){a="0"+c;}var b=(c==d||a==d);var e="<option "+(b?"selected":"")+" value="+a+">"+c+"分</option>";
f.append(e);}return f.toString();},_bindFormValidation:function(){var a={rules:{"name":{required:true,maxByteLength:64},"group":{required:true,},"runType":{required:true,},"jobId":{required:true,}},};
FormUtils.bindFormValidation(JobPlan._CONS_.EDIT_FORM_ID,a);},reloadJqgrid:function(b){var a=this;if(!b){b="?1=1";}$.each(a.params,function(c,d){b=b+"&"+c+"="+d;
});JTJqgridUtils.reloadJqgrid(JobPlan._CONS_.GRID,b);},_getManagerBtns:function(){var a=[];a.push({lable:msgCode.DELETE_BTN_TEXT,btnClasses:"btn btn-danger jobPlanEdit",iconClasses:"fa fa-remove"});
a.push({lable:msgCode.DETAIL_BTN_TEXT,btnClasses:"btn btn-primary jobPlanDetail",iconClasses:"fa fa-list"});a.push({switchCol:{colName:"status",colVals:["stop"],colLables:["运行"],btnClasses:["btn btn-primary runPlan"],iconClasses:["fa fa-edit"]}});
a.push({switchCol:{colName:"status",colVals:["run"],colLables:["停止"],btnClasses:["btn btn-warning stopPlan"],iconClasses:["fa fa-edit"]}});a.push({lable:"查看日志",btnClasses:"btn btn-primary jobPlanHist",iconClasses:"fa fa-list"});
a.push({lable:msgCode.DELETE_BTN_TEXT,btnClasses:"btn btn-danger jobPlanDel",iconClasses:"fa fa-remove"});return a;},_initJqgrid:function(a){if(a==null||typeof a==undefined){a={};
}$(JobPlan._CONS_.GRID).JTJqgrid({url:JobPlan._CONS_.LIST_DATA_URL,pager:JobPlan._CONS_.PAGER,postData:a,colNames:["所属任务","计划名称","所属组值","类型","调度类型","表达式设置方式","计划表达式","计划说明","状态","上一次","是否默认","创建者","创建时间","更新者","更新时间","操作"],colModel:[{name:"jobId",index:"job_id_",width:120,hidden:true,},{name:"name",index:"name_",width:120},{name:"group",index:"group_",width:120},{name:"type",index:"type_",width:120,hidden:true,},{name:"runType",width:120,formatter:function(c){var b="";
switch(c){case"one_time":b="一次";break;case"date_interval":b="间隔分钟";break;case"week":b="每星期";break;case"month":b="每月";break;case"date_time":b="每天";break;
case"run_on_start":b="跟随系统调度";break;case"fix_plan":b="补偿(手动)调度";break;}return b;}},{name:"exprSet",index:"expr_set_",width:120,hidden:true,},{name:"expr",index:"expr_",width:120},{name:"comment",index:"comment_",width:100,hidden:true,},{name:"status",index:"status_",width:80,formatter:function(b){if(b=="run"){return"运行中";
}else{return"已停止";}}},{name:"lastRunTime",index:"last_run_time_",width:120,hidden:true},{name:"isDefault",index:"is_default_",width:100,formatter:function(b){if("y"==b||"Y"==b){return"<label class='label label-primary'>是</label>";
}return"<label class='label label-default'>否</label>";}},{name:"createBy",index:"create_by_",width:120,hidden:true,},{name:"createTime",index:"create_time_",width:120,hidden:true,},{name:"updateBy",index:"update_by_",width:120,hidden:true,},{name:"updateTime",index:"update_time_",width:120,hidden:true,},{name:"__manage",width:40,classes:"rowOps",sortable:false,align:"center",formatter:"manage",formatoptions:this._getManagerBtns()}]});
}};