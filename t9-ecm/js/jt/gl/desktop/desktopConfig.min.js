$(function(){var a=new DesktopConfig();a.init();});function DesktopConfig(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;}DesktopConfig._CONS_={EDIT_URL:ctx+"/gl/desktop/desktopConfig/edit.htm",DELETE_URL:ctx+"/gl/desktop/desktopConfig/delete.htm",SAVE_ADD_URL:ctx+"/gl/desktop/desktopConfig/saveAdd.htm",SAVE_EDIT_URL:ctx+"/gl/desktop/desktopConfig/saveEdit.htm",LIST_DATA_URL:ctx+"/gl/desktop/desktopConfig/listData.htm",EDIT_FORM_ID:"desktopConfigForm",GRID:"#desktopConfigGrid",PAGER:"#desktopConfigPager"};
DesktopConfig.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindFormValidation();this._bindEventHander();this._initJqgrid(a);}},clear:function(c){var a=this;
function b(){a._showListWrapper();a.isFormDataChange=false;$(".form_wrapper .saveBtn").show();FormUtils.clear(DesktopConfig._CONS_.EDIT_FORM_ID);FormUtils.enableForm(DesktopConfig._CONS_.EDIT_FORM_ID);
if(c){a.reloadJqgrid();}}if(a.isEdit&&a.isFormDataChange){DialogUtils.warning(function(){b();});}else{b();}},_showListWrapper:function(){$(".list_wrapper").show();
$(".form_wrapper").hide();},_showFormWrapper:function(){$(".list_wrapper").hide();$(".form_wrapper").show();},_add:function(){this._edit();},_edit:function(a){window.location.href=ctx+"/gl/desktop/desktopConfig/edit.htm?id="+a;
},_loadData:function(b){var a=this;FormUtils.loadData(DesktopConfig._CONS_.EDIT_URL+"?id="+b,function(c){$("input[name=id]").val(c.id);$("input[name=name]").val(c.name);
$("input[name=desc]").val(c.desc);$("input[name=belongType]").val(c.belongType);$("input[name=partyId]").val(c.partyId);$("input[name=editCode]").val(c.editCode);
$("input[name=viewCode]").val(c.viewCode);$("input[name=isDefault]").val(c.isDefault);$("input[name=createBy]").val(c.createBy);$("input[name=createTime]").val(c.createTime);
$("input[name=updateBy]").val(c.updateBy);$("input[name=updateTime]").val(c.updateTime);});},_delete:function(b){var a=this;DialogUtils.confirm(function(){FormUtils.del(DesktopConfig._CONS_.DELETE_URL,b,function(c){if(c.success){if(c.msgCode==actionCode.DETELE){DialogUtils.success(msgCode.INFO,msgCode.DELETE_MSG);
}a.reloadJqgrid();}else{DialogUtils.error(msgCode.ERROR,c.msg);}});});},_bindEventHander:function(){var a=this;$(document).on("click",".collapse-link",function(){var d=$(this).closest("div.ibox");
var b=$(this).find("i");var c=d.find("div.ibox-content");c.slideToggle(200);b.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down");d.toggleClass("").toggleClass("border-bottom");
setTimeout(function(){d.resize();d.find("[id^=map-]").resize();},50);});$(document).on("click","#saveBtn",function(){a._save();});$(DesktopConfig._CONS_.EDIT_FORM_ID).on("change",".form_wrapper input",function(){if(a.isEdit){a.isFormDataChange=true;
}});$(DesktopConfig._CONS_.EDIT_FORM_ID).on("change",".form_wrapper select",function(){if(a.isEdit){a.isFormDataChange=true;}});$(DesktopConfig._CONS_.EDIT_FORM_ID).on("change",".form_wrapper textarea",function(){if(a.isEdit){a.isFormDataChange=true;
}});$(".list_wrapper").on("click",".desktopConfigSearch",function(){var b=$(this).closest("form").serialize();a.reloadJqgrid(b);});$("#desktopConfigSearchForm").on("keypress",function(b){if(b.keyCode=="13"){$(".desktopConfigSearch").trigger("click");
}});$(".list_wrapper").on("click",".desktopConfigAdd",function(){a._add();});$("body").on("click",".desktopConfigEdit",function(){a.isEdit=true;var b=$(this).attr("idVal");
if(!b){b=$(DesktopConfig._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_EDIT);
return;}else{if(b&&b.length>1){DialogUtils.error(msgCode.ERROR,msgCode.ERROR_EDIT_MUL_RECORD);return;}}}a._edit(b);});$("body").on("click",".desktopConfigDel",function(){var b=$(this).attr("idVal");
if(!b){b=$(DesktopConfig._CONS_.GRID).jqGrid("getGridParam","selarrrow");if(b==null||b.length==0){DialogUtils.error(msgCode.error,msgCode.ERROR_NO_SELECT_DELETE);
return;}}a._delete(b);});},_bindFormValidation:function(){var a={rules:{},messages:{}};FormUtils.bindFormValidation(DesktopConfig._CONS_.EDIT_FORM_ID,a);
},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(DesktopConfig._CONS_.GRID,a);},_getManagerBtns:function(){var a=[];a.push({lable:msgCode.DELETE_BTN_TEXT,btnClasses:"btn btn-danger desktopConfigDel",iconClasses:"fa fa-remove"});
a.push({lable:msgCode.EDIT_BTN_TEXT,btnClasses:"btn btn-primary desktopConfigEdit",iconClasses:"fa fa-edit"});return a;},_initJqgrid:function(a){if(a==null||typeof a==undefined){a={};
}$(DesktopConfig._CONS_.GRID).JTJqgrid({url:DesktopConfig._CONS_.LIST_DATA_URL,pager:DesktopConfig._CONS_.PAGER,postData:a,colNames:["名称","描述","是否默认","创建时间","更新时间","操作"],colModel:[{name:"name",width:120,index:"name_"},{name:"desc",width:200,sortable:false},{name:"isDefault",width:40,sortable:false,index:"is_default_",formatter:function(b){if(b=="y"){return"<label class='label label-primary'>是</label>";
}else{return"<label class='label label-info'>否</label>";}}},{name:"createTime",width:160,index:"create_time_"},{name:"updateTime",width:160,index:"update_time_"},{name:"__manage",width:40,classes:"rowOps",sortable:false,align:"center",formatter:"manage",formatoptions:this._getManagerBtns()}]});
}};