$(function(){var a=new GroupTargetDetail();a.init();});function GroupTargetDetail(){this.hadInit=false;this.targetType=(targetIsAudit=="y"?"audit":"complete");
}GroupTargetDetail._CONS_={DETAIL_URL:ctx+"/gl/ou/groupTarget/detail.htm",};GroupTargetDetail.prototype={init:function(){if(!this.hadInit){this.hadInit=true;
if(targetIsAudit=="y"){$("[name='type'][value='audit']").attr("checked","checked");}this._bindEventHander();this._loadData(targetId);}},_loadData:function(c){var a=this;
var b=GroupTargetDetail._CONS_.DETAIL_URL;FormUtils.loadData(b+"?id="+c+"&targetType="+a.targetType,function(g){var e=g;$(".group-name").empty().append(e.groupName);
$(".group-target").empty().append(e.total);var f=a.targetType=="complete"?e.completeTotal:e.auditTotal;var j=(e.total==0?0:(f*100/e.total).toFixed(0));
if(j>100){j=100;}$(".complete-rate").empty().append(j);$(".complete-amount").empty().append(f);if(j>10){$(".div-line1").css({width:"calc("+j+"% - 20px)"});
$(".div-line2").css({width:(100-j)+"%"});}else{$(".div-line1").css({width:j+"%"});$(".div-line2").css({width:"calc("+(100-j)+"% - 20px)"});}$(".employee-complete").empty().append(e.employeeCompleteCount);
$(".employee-total").empty().append(e.employeeCount);$(".employee-not-complete").empty().append(e.employeeCount-e.employeeCompleteCount);$(".target-period").empty().append(e.period);
var d=e.period.split("-");var i=new Date(d[0],d[1],0);var h=DateUtils.getDateDiff(new Date(),i,"day");if(h<0){h=0;}$(".left-time").empty().append(h);a._loadEmploteeTarget(e.employeeTargetVos);
});},_loadEmploteeTarget:function(b){var j=this;var f=new StringBuffer();for(var d=0;d<b.length;d++){var h=b[d];var a=j.targetType=="complete"?h.completeTotal:h.auditTotal;
var g=(h.total==0?0:(a*100/h.total).toFixed(0));var c=g/100*360;var e=c>180?180:c;var k=c>180?(c-180):0;k=k>180?180:k;f.append('<div class="float-left">').append('<div class="float-left">').append('<div class="con">').append('<div class="percent-circle percent-circle-left">').append('<div class="left-content" style="transform: rotate('+e+'deg);"></div></div>').append('<div class="percent-circle percent-circle-right">').append('<div class="right-content" style="transform: rotate('+k+'deg);"></div></div>').append('<div class="text-circle">'+g+"%</div>").append("</div></div>").append('<div class="float-left employee-info" >').append("<div>").append('<img class="jt-employee-img" onerror="onImageError()" src="'+ctx+h.profile+'">').append("<span>"+h.aid+":"+h.name+"</span>").append("</div>").append('<div class="employee-sort" >第'+(d+1)+"名</div>").append('<div class="employee-complete">￥<span class="num">'+a+'</span>/￥<span class="num">'+h.total+"</span></div>").append("</div></div>");
}$("#target-employee-list-li").empty().append(f.toString());},_bindEventHander:function(){var a=this;$("#show-more-btn").on("click",function(){if($("#target-employee-list").hasClass("more")){$("#target-employee-list").removeClass("more");
$(this).attr("title","显示更多");}else{$("#target-employee-list").addClass("more");$(this).attr("title","隐藏更多");}});$(".prevBtn").on("click",function(){JTTabUtils.closeTab($(window.top.document).find(".page-tabs-content").find(".active").attr("data-id"));
});$("input[name='type']").on("change",function(){a.targetType=$(this).val();a._loadData(targetId);});},};