function EmployeeInterstRadar(){this.hadInit=false;this.radarChart=null;this.params=null;}EmployeeInterstRadar._CONS_={LIST_GROUP_EMPLOYEE:ctx+"/crm/ou/employee/listData.htm?rows=99999",LIST_MGR_SUB_EMPLOYEE:ctx+"/crm/ou/employee/findSubEmployee.htm",EDIT_URL:ctx+"/gl/ou/employeeInterst/edit.htm",DETAIL_URL:ctx+"/gl/ou/employeeInterst/detail.htm",DELETE_URL:ctx+"/gl/ou/employeeInterst/delete.htm",SAVE_ADD_URL:ctx+"/gl/ou/employeeInterst/saveAdd.htm",SAVE_EDIT_URL:ctx+"/gl/ou/employeeInterst/saveEdit.htm",LIST_DATA_URL:ctx+"/gl/ou/employeeInterst/listData.htm",EDIT_FORM_ID:"employeeInterstForm",LOAD_RADAR_DATA:ctx+"/gl/ou/employeeInterst/loadRadarData.htm",GRID:"#employeeInterstGrid",PAGER:"#employeeInterstPager"};
EmployeeInterstRadar.prototype={init:function(a){this._dealPanelTitle(a);if(!this.hadInit){this.hadInit=true;this._bindEventHander();this._initTimeSelect();
}this.params=a;if(a.radarType&&a.radarType=="manager_type"){$("#chooseEmployeeDiv").show();this._initEmployeeSelect();}this._initRadar();},_dealPanelTitle:function(a){if(a&&a.isHidePanelTitle){$("#panelTitle").hide();
$("#panelTitle").remove();}},_initTimeSelect:function(){var a=this;var c=new Date();var b=a._getTimeOptions({type:"year",selectedOption:c.getFullYear()});
$("#yearSelect").empty().append(b.toString()).trigger("change");},_getOpt:function(c,a,b){var d="<option value='"+c+"' "+(b?"selected='selected'":"")+" >"+a+"</option>";
return d;},_getTimeOptions:function(f){var k=f.type;var d=f.selectedOption;var m=this;var l=new StringBuffer();if(k=="year"){var a=new Date();var g=DateUtils.format(a,"yyyy");
if(d){if(d/1<=g/1&&d>g/1-10){for(var e=0;e<10;e++){var j=g/1-e;var h=m._getOpt(j,j+"年",j==d/1);l.append(h);}}else{for(var e=g/1;e>=d/1;e--){var h=m._getOpt(e,e+"年",e==d/1);
l.append(h);}}}else{for(var e=0;e<10;e++){var j=g/1-e;var h=m._getOpt(j,j+"年");l.append(h);}}}else{var c=13;c=(f&&f.limit)?f.limit:13;for(var e=1;e<=c;
e++){var b=(e<10)?("0"+e):e;l.append('<option value="'+b);l.append('"');if(b==d){l.append(' selected="selected" ');}l.append(" >");l.append(e+"月");l.append("</option>");
}}return l.toString();},_bindEventHander:function(){var a=this;$("body").on("blur","#employeeSelect",function(){console.log("select-blur");});$("body").on("click","#generateModel",function(){var b=$("#employeeSelect").val();
if(b&&b.length>0){a._loadRadarData(b.join(","));}else{a._loadRadarData("");}});$("body").on("change","#yearSelect",function(){var b=$(this).val();var c=new Date();
var d=null;if(b==c.getFullYear()){d=a._getTimeOptions({type:"month",limit:c.getMonth()+1});}else{d=a._getTimeOptions({type:"month"});}d='<option value="">请选择月份</option>'+d;
$("#monthSelect").empty().append(d);});},_refreshRadarData:function(b){if(!this.radarChart){console.log("雷达图没有初始化，无法刷新");}var a=this.radarChart.getOption();
a.series[0].data=b;this.radarChart.setOption(a);},_loadRadarData:function(d){var c=this;if(c.params.radarType&&c.params.radarType=="manager_type"){if(!d){DialogUtils.error(msgCode.error,"没有选择员工!");
return;}}else{d=c.params.employeeIds;}var e=d.split(",");var f=$("#yearSelect").val()+""+$("#monthSelect").val();var a="year";var b=$("[name=radarMaxChoose]").val();
if(f.length>4){a="month";}var b=$("[name=radarMaxChoose]").val();FormUtils.loadData(EmployeeInterstRadar._CONS_.LOAD_RADAR_DATA+"?radarMaxChoose="+b+"&period="+f+"&periodType="+a+"&employeeIds="+d,function(x){console.log(x);
var o=x.interstMax;var m=x.employeePartyPo;var n=x.employeeValues;var h=[];var w=[];var j=[];for(var k=0;k<e.length;k++){var s=e[k];h.push(m[s].name);}for(var v in o){var l=$("[name=radarMaxChoose]").val();
if(l){w.push({name:v,max:o[v]?o[v]:500,min:0});}else{w.push({name:v,min:0});}}for(var k=0;k<e.length;k++){var s=e[k];var r=n[s];var q={name:m[s].name,value:[],};
for(var v in o){var u=r[v];q.value.push(u.performance);}j.push(q);}var p=echarts.init(document.getElementById("echarts-radar-chart"));console.log("radarChart: ==>"+p);
var g={title:{},tooltip:{},legend:{data:h,orient:"vertical",x:"left",y:"top",},radar:{indicator:w,},series:[{name:"雷达图",type:"radar",data:j,}]};p.setOption(g);
c.radarChart=p;},function(){DialogUtils.error(msgCode.error,"请求出错");});},_initEmployeeSelect:function(){var a=this;FormUtils.loadData(EmployeeInterstRadar._CONS_.LIST_MGR_SUB_EMPLOYEE,function(c){console.log(c);
var b=c;var f=new StringBuffer();if(b.length>0){for(var d=0;d<b.length;d++){var e=b[d];f.append("<option value='");f.append(e.id);f.append("'>");f.append(e.name);
f.append("</option>");}}$("#employeeSelect").append(f.toString());$("#employeeSelect").chosen("destroy");$("#employeeSelect").chosen({no_results_text:"没有找到"});
});},_initRadar:function(){var a=this;var b=a.params.employeeIds;this._loadRadarData(b);},};