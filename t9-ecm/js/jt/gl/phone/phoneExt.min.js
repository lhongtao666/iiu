$(function(){var a=new PhoneExt();a.init();});function PhoneExt(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;}PhoneExt._CONS_={EDIT_URL:ctx+"/gl/phone/phoneExt/edit.htm",DETAIL_URL:ctx+"/gl/phone/phoneExt/detail.htm",DELETE_URL:ctx+"/gl/phone/phoneExt/delete.htm",SAVE_ADD_URL:ctx+"/gl/phone/phoneExt/saveAdd.htm",SAVE_EDIT_URL:ctx+"/gl/phone/phoneExt/saveEdit.htm",LIST_DATA_URL:ctx+"/gl/phone/phoneExt/listData.htm",FIND_NOT_URL:ctx+"/gl/phone/phone/findNotInvalid.htm",FIND_CTI_DATA:ctx+"/gl/phone/phoneExt/findCTIData.htm",FIND_PHONE_DATA:ctx+"/gl/phone/phoneExt/findPhoneData.htm",EDIT_FORM_ID:"phoneExtForm",GRID:"#phoneExtGrid",PAGER:"#phoneExtPager"};
PhoneExt.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindEventHander();this._hideNotGrantBtn();this._findNotInvalid();this._loadNotAssiginData();
this._loadAssiginData();}},_hideNotGrantBtn:function(){if(!ResUtils.canShow("phoneExt.button.detail")){$(".phoneExtDetail").hide();}if(!ResUtils.canShow("phoneExt.button.add")){$(".phoneExtAdd").hide();
}if(!ResUtils.canShow("phoneExt.button.edit")){$(".phoneExtEdit").hide();}if(!ResUtils.canShow("phoneExt.button.delete")){$(".phoneExtDel").hide();}},clear:function(c){var a=this;
function b(){a._showListWrapper();a.isFormDataChange=false;a.isEdit=false;$(".form_wrapper .saveBtn").show();FormUtils.clear(PhoneExt._CONS_.EDIT_FORM_ID);
FormUtils.enableForm(PhoneExt._CONS_.EDIT_FORM_ID);if(c){a.reloadJqgrid();}}if(a.isEdit&&a.isFormDataChange){DialogUtils.warning(function(){b();});}else{b();
}},_showListWrapper:function(){$(".list_wrapper").show();$(".form_wrapper").hide();},_showFormWrapper:function(){$(".list_wrapper").hide();$(".form_wrapper").show();
},_add:function(){this._showFormWrapper();},_edit:function(a){this._showFormWrapper();this.edit=true;this._loadData(a);},_detail:function(a){this._showFormWrapper();
this._loadData(a);$(".form_wrapper .saveBtn").hide();FormUtils.disableForm(PhoneExt._CONS_.EDIT_FORM_ID);},_loadData:function(b){var a=this;FormUtils.loadData(PhoneExt._CONS_.EDIT_URL+"?id="+b,function(c){$("input[name=id]").val(c.id);
$("input[name=ext]").val(c.ext);$("input[name=phoneId]").val(c.phoneId);$("input[name=employeeId]").val(c.employeeId);$("input[name=createTime]").val(c.createTime);
$("input[name=updateTime]").val(c.updateTime);});},_loadNotAssiginData:function(){},_loadAssiginData:function(){},_save:function(){var b=this;var c=$("#id").val();
var a=null;if(c!=null&&c!=""){a=PhoneExt._CONS_.SAVE_EDIT_URL;}else{a=PhoneExt._CONS_.SAVE_ADD_URL;}if($("#phoneExtForm").valid()){ButtonUtils.disableBtn("saveBtn");
FormUtils.submitByFormId(a,PhoneExt._CONS_.EDIT_FORM_ID,function(d){ButtonUtils.enableBtn("saveBtn");if(d.success){if(d.msgCode==actionCode.CREATE){DialogUtils.success(msgCode.INFO,msgCode.CREATE_MSG);
}else{if(d.msgCode==actionCode.UPDATE){DialogUtils.success(msgCode.INFO,msgCode.UPDATE_MSG);}}b.isEdit=false;b.clear(true);}else{DialogUtils.error(msgCode.FAIL_MSG,d.msg);
}},function(){ButtonUtils.enableBtn("saveBtn");DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}},_bindEventHander:function(){var a=this;$(document).on("click",".prevBtn",function(){a.clear(false);
});$(document).on("click",".saveBtn",function(){a._save();});},_findNotInvalid:function(){var a=this;FormUtils.loadData(PhoneExt._CONS_.FIND_NOT_URL,function(c){var d=new StringBuffer();
d.append("<option value=''>请选择</option>");for(var b=0;b<c.length;b++){d.append("<option value='"+c[b].id+"'>"+c[b].phone+"</option>");}$("#addToPhone").empty().append(d.toString());
});},};