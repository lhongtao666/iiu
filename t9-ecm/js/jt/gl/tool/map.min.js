$(function(){var a=new MapAPI();a.init();});function MapAPI(){this.hadInit=false;this.map=new BMap.Map("l-map");this.map.enableScrollWheelZoom();this.map.centerAndZoom(new BMap.Point(116.404,39.915),11);
this.map.addControl(new BMap.NavigationControl());}MapAPI.prototype={init:function(){var a=this;if(!a.hadInit){a.hadInit=true;a._bindEventHander();a.initData();
}},initData:function(){var a=this;DialogUtils.confirmWithOptions({title:"要共享位置信息吗?",text:"",confirmButtonText:"确认",yesFunc:function(){var b=new BMap.Geolocation();
b.getCurrentPosition(function(d){if(this.getStatus()==BMAP_STATUS_SUCCESS){var c=new BMap.Marker(d.point);a.map.addOverlay(c);a.map.panTo(d.point);a.map.centerAndZoom(new BMap.Point(d.point.lng,d.point.lat),12);
$("#cityName").text(d.address.city);}else{DialogUtils.error(msgCode.ERROR,"获取失败："+this.getStatus());}},{enableHighAccuracy:true});},});},_bindEventHander:function(){var a=this;
$(document).on("click",".searchMap",function(){var b=$("#selectFun").val();if(b==1){a.searchMapByKeyWord();}else{if(b==2){a.searchMapByBus();}else{if(b==3){a.searchMapByDriving();
}else{if(b==4){a.searchMapByWalking();}}}}});$(document).on("change","#selectFun",function(){$("#keyWordSpan").addClass("hide");$("#roadSpan").addClass("hide");
if($(this).val()==1){$("#keyWordSpan").removeClass("hide");a.searchMapByKeyWord();}else{if($(this).val()==2||$(this).val()==3||$(this).val()==4){$("#roadSpan").removeClass("hide");
}else{if($(this).val()==5){a.setPoint();}}}});},searchMapByKeyWord:function(){var a=this;var b=new BMap.LocalSearch(a.map,{renderOptions:{map:a.map,panel:"r-result"}});
var c=$("#keyWord").val();b.search(c);},searchMapByBus:function(){var d=this;var c=new BMap.TransitRoute(d.map,{renderOptions:{map:d.map,panel:"r-result"}});
var a=$("#beginWord").val();var b=$("#endWord").val();c.search(a,b);},searchMapByDriving:function(){var c=this;var d=new BMap.DrivingRoute(c.map,{renderOptions:{map:c.map,panel:"r-result",autoViewport:true}});
var a=$("#beginWord").val();var b=$("#endWord").val();d.search(a,b);},searchMapByWalking:function(){var d=this;var b=new BMap.WalkingRoute(d.map,{renderOptions:{map:d.map,panel:"r-result",autoViewport:true}});
var a=$("#beginWord").val();var c=$("#endWord").val();b.search(a,c);},setPoint:function(){var d=new BMap.Map("l-map");var a=new BMap.Point(113.3416024517,23.1021164041);
d.centerAndZoom(a,13);var b=new BMap.Marker(a);d.addOverlay(b);var c=new BMap.Label("广州九天软件有限公司",{offset:new BMap.Size(20,-10)});b.setLabel(c);}};