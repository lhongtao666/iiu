$(function(){var a=new BaiduMap();a.init();});function BaiduMap(){this.hadInit=false;this.map=new BMap.Map("l-map");this.map.enableScrollWheelZoom();this.map.addControl(new BMap.NavigationControl());
this.positionName="麦当劳";this.points=[];}BaiduMap.prototype={init:function(){var a=this;if(!a.hadInit){a.hadInit=true;a._bindEventHander();a.initData();
}},initData:function(){var b=this;var a=new BMap.Geolocation();a.getCurrentPosition(function(d){if(this.getStatus()==BMAP_STATUS_SUCCESS){var f=new BMap.Point(d.point.lng,d.point.lat);
b.map.centerAndZoom(f,15);var e=new BMap.Circle(f,1000,{fillColor:"blue",strokeWeight:1,fillOpacity:0.3,strokeOpacity:0.3});b.map.addOverlay(e);var c=new BMap.LocalSearch(b.map,{renderOptions:{map:b.map,autoViewport:false}});
c.searchNearby(this.positionName,f,1000);$("#cityName").text(d.address.city);}else{var f=new BMap.Point(116.404,39.915);b.map.centerAndZoom(f,15);var e=new BMap.Circle(f,1000,{fillColor:"blue",strokeWeight:1,fillOpacity:0.3,strokeOpacity:0.3});
b.map.addOverlay(e);var c=new BMap.LocalSearch(b.map,{renderOptions:{map:b.map,autoViewport:false}});c.searchNearby(this.positionName,f,1000);}$("#l-map").height($("body").height());
},{enableHighAccuracy:true});},_bindEventHander:function(){var a=this;$(".btn-area-rang").on("click",function(){$(".btn-area-rang").removeClass("on");$(this).addClass("on");
});$(document).on("click",".searchMap",function(){a.map.clearOverlays();var b=new BMap.LocalSearch(a.map,{renderOptions:{map:a.map,panel:"r-result"}});
var c=$("#keyWord").val();b.setSearchCompleteCallback(function(d){a.points=[];for(var e=0;e<d.wr.length;e++){a.points.push(d.getPoi(e).point);}});b.search(c);
});$(document).on("click","ol li",function(){a.map.clearOverlays();var d=$(this).index();var b=a.points[d];var c=$(".btn-area-rang.on").val();var g=new BMap.Point(b.lng,b.lat);
a.map.centerAndZoom(g,15);var f=new BMap.Circle(g,c,{fillColor:"blue",strokeWeight:1,fillOpacity:0.3,strokeOpacity:0.3});a.map.addOverlay(f);var e=new BMap.LocalSearch(a.map,{renderOptions:{map:a.map,autoViewport:false}});
e.setSearchCompleteCallback(function(h){$("#cityName").text(h.city);});e.searchNearby(a.positionName,g,c);});},};