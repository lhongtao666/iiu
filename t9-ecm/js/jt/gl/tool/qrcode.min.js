$(function(){var a=new QrCode();a.init();});function QrCode(){this.hadInit=false;}QrCode._CONS_={UPLOAD_PARAMS:{"acceptTypes":"jpg,png","mimeTypes":"image/*","fileSingleSizeLimit":1*1024*1024*6,"fileNumLimit":1,"uploadUrl":ctx+"/crm/components/upload/ajax.htm?categoryDir=temp"}};
QrCode.prototype={init:function(){var a=this;if(!a.hadInit){a.hadInit=true;a._bindEventHander();a._bindFormValidation();a._initUpload();}},_bindEventHander:function(){var a=this;
$(document).on("click",".createQRCode",function(){var c=$("#encoderContent").val();if($("#createQrcodeForm").valid()){var b=a.toUtf8(c);$("#code").empty();
$("#code").qrcode({render:"table",width:235,height:235,text:b});}});},_initUpload:function(){var f=null;var b=$("#uploadQrcodeForm").serialize();if($("#uploadQrcodeForm").valid()){function c(h,g){if(g.flag){f=g.localPath;
}}function a(g,h){alert("上传"+g.name+"失败，原因是"+h);}function d(){FormUtils.submit(ctx+"/gl/tool/qrCode/upload2Code.htm",{codeFile:f},function(g){if(g.success){DialogUtils.success(msgCode.SUCCESS,"解析成功");
$("#analyzeContent").val(g.msg);}});}var e=new JTWebUploader({config:QrCode._CONS_.UPLOAD_PARAMS,container:"uploader",success:c,error:a,caption:"",finish:d});
e.init();$(".info").hide();$("#filePicker2").hide();}},_bindFormValidation:function(){var a={rules:{encoderContent:{required:true},},};FormUtils.bindFormValidation("createQrcodeForm",a);
var b={rules:{codeFile:{required:true},},};FormUtils.bindFormValidation("uploadQrcodeForm",b);},toUtf8:function(e){var b,d,a,f;b="";a=e.length;for(d=0;
d<a;d++){f=e.charCodeAt(d);if((f>=1)&&(f<=127)){b+=e.charAt(d);}else{if(f>2047){b+=String.fromCharCode(224|((f>>12)&15));b+=String.fromCharCode(128|((f>>6)&63));
b+=String.fromCharCode(128|((f>>0)&63));}else{b+=String.fromCharCode(192|((f>>6)&31));b+=String.fromCharCode(128|((f>>0)&63));}}}return b;}};