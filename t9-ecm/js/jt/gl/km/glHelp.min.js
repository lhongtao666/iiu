function GlHelp(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;this.seniorSearch=new SeniorSearch();}GlHelp._CONS_={EDIT_URL:ctx+"/gl/km/glHelp/edit.htm",SAVE_ADD_URL:ctx+"/gl/km/glHelp/saveAdd.htm",SAVE_EDIT_URL:ctx+"/gl/km/glHelp/saveEdit.htm",LIST_DATA_URL:ctx+"/gl/km/glHelp/listData.htm",DELETECATE_URL:ctx+"/gl/km/glHelp/deleteCate.htm",LOAD_IFRAME_DATA:ctx+"/gl/km/glHelp/loadIframeData.htm",EDIT_FORM_ID:"glHelpForm",};
GlHelp.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindFormValidation();this._bindEventHander();this._hideNotGrantBtn();this._initGlHelpCateTree(a);
this.seniorSearch.init();}},_initGlHelpCateTree:function(){var a=this;var b={treeId:"glHelpCateTree",cateTypeKey:"knowledge_type",rootKey:"glHelp",userId:"",dragAble:false,canLeafShowAddBtn:false,onClick:function(d){var c="glHelpCateTree";
current_Node=d;a._loadIframeData(d,c);a.clear(false);},onRightClick:function(c){ZtreeUtils._showRightMenu(null,false,false,false,false);}};ZtreeUtils.init(b);
},_loadIframeData:function(c,a){var b=this;b.seniorSearch.initCrumbs(c,a);FormUtils.loadData(GlHelp._CONS_.LOAD_IFRAME_DATA+"?cateId="+c.id,function(d){b._showOrHideBtn(d,c);
b._showOrHideDiv(d);b._buildIframeDivAttr(d,c);});},_setHeightAndWidth:function(){var a=document.getElementById("glHelpIframe");var b=document.frames?document.frames["glHelpIframe"].document:a.contentDocument;
if(a!=null&&b!=null){a.height=b.body.scrollHeight;a.width=b.body.scrollWidth;}},_buildIframeDivAttr:function(b,a){if(b.cateId){$("#glHelpIframeDiv").attr("glHelpPo_id",b.id);
$("iframe[name='glHelpIframe']").attr("cate_id",b.cateId);$("iframe[name='glHelpIframe']").attr("cate_key",b.cateKey);$("iframe[name='glHelpIframe']").attr("cate_name",a.name);
$("iframe[name='glHelpIframe']").attr("doc_name",b.name);$("iframe[name='glHelpIframe']").attr("doc_code",b.code);$("iframe[name='glHelpIframe']").attr("src",b.url);
$("iframe[name='glHelpIframe']").attr("sort",b.sort);$("iframe[name='glHelpIframe']").attr("create_time",b.createTime);$("iframe[name='glHelpIframe']").css("height",$(window).height()+"px");
$("#docTitle").val(b.name);$("#docCode").val(b.code);}else{$("#docTitle").val("");$("#docCode").val("");}},_showOrHideBtn:function(c,b){var d=b.getPreNode();
var a=b.getNextNode();if(b.children){$(".glHelpEdit").hide();$(".preGlHelp").attr("disabled",true);$(".nextGlHelp").attr("disabled",true);}else{if(c.cateId){$(".glHelpEdit").show();
}if(d&&!d.children){$(".preGlHelp").attr("disabled",false);}else{$(".preGlHelp").attr("disabled",true);}if(a&&!a.children){$(".nextGlHelp").attr("disabled",false);
}else{$(".nextGlHelp").attr("disabled",true);}}},_showOrHideDiv:function(a){if(a.cateId){$("#noDataDiv").hide();$("#glHelpIframeDiv").show();}else{$("#noDataDiv").show();
$("#glHelpIframeDiv").hide();}},_hideNotGrantBtn:function(){if(!ResUtils.canShow("glHelp.button.add")){}if(!ResUtils.canShow("glHelp.button.edit")){$(".glHelpEdit").hide();
}},clear:function(c){var a=this;function b(){a._showListWrapper();a.isFormDataChange=false;a.isEdit=false;$(".form_wrapper .saveBtn").show();$("#glHelpIframeDiv").show();
FormUtils.clear(GlHelp._CONS_.EDIT_FORM_ID);FormUtils.enableForm(GlHelp._CONS_.EDIT_FORM_ID);}if(a.isEdit&&a.isFormDataChange){DialogUtils.warning(function(){b();
});}else{b();}},_showListWrapper:function(){$(".list_wrapper").show();$(".form_wrapper").hide();},_showFormWrapper:function(){$(".list_wrapper").hide();
$(".form_wrapper").show();},_add:function(){this._showFormWrapper();$("#glHelpIframeDiv").attr("glHelpPo_id","");$("#glHelpIframeDiv").hide();$("#noDataDiv").hide();
},_edit:function(){this._showFormWrapper();this.edit=true;var a={id:$("#glHelpIframeDiv").attr("glHelpPo_id"),cateId:$("iframe[name='glHelpIframe']").attr("cate_id"),cateKey:$("iframe[name='glHelpIframe']").attr("cate_key"),cateName:$("iframe[name='glHelpIframe']").attr("cate_name"),name:$("iframe[name='glHelpIframe']").attr("doc_name"),code:$("iframe[name='glHelpIframe']").attr("doc_code"),docUrl:$("iframe[name='glHelpIframe']").attr("src"),sort:$("iframe[name='glHelpIframe']").attr("sort"),createTime:$("iframe[name='glHelpIframe']").attr("create_time"),};
this._loadData(a);$("#glHelpIframeDiv").hide();$("#noDataDiv").hide();},_loadData:function(a){$("input[name=id]").val(a.id);$("input[name=cateId]").val(a.cateId);
$("input[name=cateKey]").val(a.cateKey);$("input[name=name]").val(a.name);$("input[name=cateName]").val(a.cateName);$("input[name=code]").val(a.code);$("input[name=url]").val(a.docUrl);
$("input[name=sort]").val(a.sort);$("input[name=createTime]").val(a.createTime);},_save:function(){var b=this;var a=null;var c=$("#glHelpIframeDiv").attr("glHelpPo_id");
if(c!=null&&c!=""){a=GlHelp._CONS_.SAVE_EDIT_URL;}else{a=GlHelp._CONS_.SAVE_ADD_URL;}if($("#glHelpForm").valid()){ButtonUtils.disableBtn("saveBtn");FormUtils.submitByFormId(a,GlHelp._CONS_.EDIT_FORM_ID,function(e){ButtonUtils.enableBtn("saveBtn");
if(e.success){if(e.msgCode==actionCode.CREATE){DialogUtils.success(msgCode.INFO,msgCode.CREATE_MSG);}else{if(e.msgCode==actionCode.UPDATE){DialogUtils.success(msgCode.INFO,msgCode.UPDATE_MSG);
}}b.isEdit=false;b.clear(true);var d=current_Node;b._loadIframeData(d);}else{DialogUtils.error(msgCode.FAIL_MSG,e.msg);}},function(){ButtonUtils.enableBtn("saveBtn");
DialogUtils.error(msgCode.ERROR,msgCode.ERROR_MSG);});}},_bindEventHander:function(){var a=this;$("#cateName").on("click",function(){var b={isMultiple:0,typeKey:"knowledge_type",pKey:"glHelp",selectedCateIds:$("input[name='cateId']").val(),container:"cateName",fn:function(d,c){$('input[name="cateId"]').val(d);
$('input[name="cateKey"]').val(c);}};CateUtils.selectCateTreeBox(b);});$(document).on("click",".prevBtn",function(){a.clear(false);});$(document).on("click",".saveBtn",function(){a._save();
});$("#"+GlHelp._CONS_.EDIT_FORM_ID).on("change","input",function(){if(a.isEdit){a.isFormDataChange=true;}});$("#"+GlHelp._CONS_.EDIT_FORM_ID).on("change","select",function(){if(a.isEdit){a.isFormDataChange=true;
}});$("#"+GlHelp._CONS_.EDIT_FORM_ID).on("change","textarea",function(){if(a.isEdit){a.isFormDataChange=true;}});$("body").on("click",".glHelpAdd",function(){a._add();
});$("body").on("click",".glHelpEdit",function(){a.isEdit=true;a._edit();});$(document).on("click",".preGlHelp",function(){var b=current_Node.getPreNode();
a._loadIframeData(b);current_Node=b;});$(document).on("click",".nextGlHelp",function(){var b=current_Node.getNextNode();a._loadIframeData(b);current_Node=b;
});},_bindFormValidation:function(){var a={rules:{},messages:{}};FormUtils.bindFormValidation(GlHelp._CONS_.EDIT_FORM_ID,a);},_getManagerBtns:function(){var a=[];
if(ResUtils.canShow("glHelp.button.edit")){a.push({lable:msgCode.EDIT_BTN_TEXT,btnClasses:"glHelpEdit",iconClasses:"fa fa-edit"});}return a;},};