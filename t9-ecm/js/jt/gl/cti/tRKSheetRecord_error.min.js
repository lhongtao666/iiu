$(function(){var a=new TRKSheetRecord();a.init();});function TRKSheetRecord(){this.hadInit=false;this.isEdit=false;this.isFormDataChange=false;}TRKSheetRecord._CONS_={LIST_DATA_URL:ctx+"/gl/cti/tRKSheetRecord/listDataForError.htm",GRID:"#tRKSheetRecordGrid",PAGER:"#tRKSheetRecordPager"};
TRKSheetRecord.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindEventHander();this._initJqgrid(a);this._locateToGlHelp();}},_locateToGlHelp:function(){var a="glHelp.dataAudit.tRKSheetRecordError";
glHelpUtil.init(a);},_bindEventHander:function(){var a=this;$(".chooseDateBtn").on("click",function(){$(".chooseDateBtn").each(function(){if($(this).hasClass("btn-danger")){$(this).removeClass("btn-danger").addClass("btn-primary");
return false;}});$(this).removeClass("btn-primary").addClass("btn-danger");var m=$(this).attr("actionVal");var k="";var e="";switch(m){case"day":var q=new Date();
var i=q.getFullYear();var s=q.getMonth()+1;if(s<10){s="0"+s;}var o=q.getDate();if(o<10){o="0"+o;}k=i+"-"+s+"-"+o+" 00:00:00";e=i+"-"+s+"-"+o+" 23:59:59";
$('button.chooseDateBtn[actionVal="prev"]').text("前一天");$('button.chooseDateBtn[actionVal="next"]').text("后一天");break;case"yesterday":var f=DateUtils.getBeforeDate(1);
k=f+" 00:00:00";e=f+" 23:59:59";$('button.chooseDateBtn[actionVal="prev"]').text("前一天");$('button.chooseDateBtn[actionVal="next"]').text("后一天");break;case"lastWeek":var q=new Date();
var i=q.getFullYear();var s=q.getMonth()+1;if(s<10){s="0"+s;}var o=q.getDate();if(o<10){o="0"+o;}var r=DateUtils.getBeforeDate(7);k=r+" 00:00:00";e=i+"-"+s+"-"+o+" 23:59:59";
$('button.chooseDateBtn[actionVal="prev"]').text("前7天");$('button.chooseDateBtn[actionVal="next"]').text("后7天");break;case"month":var k=DateUtils.getCurrentMonthFirst().currentDate()+" 00:00:00";
var e=new Date().current();$('button.chooseDateBtn[actionVal="prev"]').text("前一月");$('button.chooseDateBtn[actionVal="next"]').text("后一月");break;case"last30":k=DateUtils.getBeforeDate(30)+" 00:00:00";
e=new Date().current();$('button.chooseDateBtn[actionVal="prev"]').text("前30天");$('button.chooseDateBtn[actionVal="next"]').text("后30天");break;case"prev":var d=$('input[name="startTime"]').val();
var j=$(this).text();if(j=="前一天"){k=DateUtils.getBeforeDate(1,d.substring(0,10))+" 00:00:00";e=DateUtils.getBeforeDate(1,d.substring(0,10))+" 23:59:59";
}else{if(j=="前一月"){var t=d.substring(0,4);var l=d.substring(5,7);var b=new Date(t,l-1,1);var h=new Date(b-1000*60*60*24);e=h.currentDate().substring(0,10)+" 23:59:59";
k=e.substring(0,7)+"-01 00:00:00";}else{if(j=="前30天"){k=DateUtils.getBeforeDate(30,d.substring(0,10))+" 00:00:00";e=DateUtils.getBeforeDate(30,d.substring(0,10))+" 23:59:59";
}else{if(j=="前7天"){k=DateUtils.getBeforeDate(7,d.substring(0,10))+" 00:00:00";e=DateUtils.getBeforeDate(7,d.substring(0,10))+" 23:59:59";}}}}break;case"next":var d=$('input[name="startTime"]').val();
var j=$(this).text();if(j=="后一天"){k=DateUtils.getAfterDate(1,d.substring(0,10))+" 00:00:00";e=DateUtils.getAfterDate(1,d.substring(0,10))+" 23:59:59";}else{if(j=="后一月"){var t=d.substring(0,4);
var l=d.substring(5,7);var n=new Date(t,l,1);var c=parseInt(l)+1;var g=new Date(t,c,1);var u=new Date(g-1000*60*60*24);k=n.currentDate()+" 00:00:00";e=u.currentDate()+" 23:59:59";
}else{if(j=="后30天"){k=DateUtils.getAfterDate(30,d.substring(0,10))+" 00:00:00";e=DateUtils.getAfterDate(30,d.substring(0,10))+" 23:59:59";}else{if(j=="后7天"){k=DateUtils.getAfterDate(7,d.substring(0,10))+" 00:00:00";
e=DateUtils.getAfterDate(7,d.substring(0,10))+" 23:59:59";}}}}break;}var p={startTime:k,endTime:e};$('input[name="startTime"]').val(k);$('input[name="endTime"]').val(e);
a.reloadJqgrid(p);});$(".list_wrapper").on("click",".tRKSheetRecordSearch",function(){var c=$("input[name='startTime']").val();var b=$("input[name='endTime']").val();
if(c||b){$(".chooseDateBtn").each(function(){if($(this).hasClass("btn-danger")){$(this).removeClass("btn-danger").addClass("btn-primary");return false;
}});var d={startTime:$("input[name='startTime']").val(),endTime:$("input[name='endTime']").val(),orgId:$("select[name='orgId']").val()};JTJqgridUtils.reloadJqgrid(TRKSheetRecord._CONS_.GRID,d);
}else{$(".chooseDateBtn").each(function(){if($(this).hasClass("btn-danger")){$(this).trigger("click");return false;}});}});$("#tRKSheetRecordSearchForm").on("keypress",function(b){if(b.keyCode=="13"){$(".tRKSheetRecordSearch").trigger("click");
}});},reloadJqgrid:function(a){JTJqgridUtils.reloadJqgrid(TRKSheetRecord._CONS_.GRID,a);},_initJqgrid:function(c){if(c==null||typeof c==undefined){c={};
}var b=new Date().currentDate()+" 00:00:00";var a=new Date().current();$('button[actionVal="day"]').removeClass("btn-primary").addClass("btn-danger");$('input[name="startTime"]').val(b);
$('input[name="endTime"]').val(a);$(TRKSheetRecord._CONS_.GRID).JTJqgrid({url:TRKSheetRecord._CONS_.LIST_DATA_URL,pager:TRKSheetRecord._CONS_.PAGER,postData:{startTime:b,endTime:a},rowNum:-1,colNames:["400号码","实际号码","呼入总计","1类呼损/占比","2类呼损/占比","3类呼损/占比","4类呼损/占比","5类呼损/占比","呼损总计/占比"],colModel:[{name:"adNum",width:120,sortable:true},{name:"phone",width:120,sortable:true},{name:"totalCount",width:120,sortable:true},{name:"error1",width:120,sortable:true},{name:"error2",width:120,sortable:true},{name:"error3",width:120,sortable:true},{name:"error4",width:120,sortable:true},{name:"error5",width:120,sortable:true},{name:"total",width:120,sortable:true}]});
}};