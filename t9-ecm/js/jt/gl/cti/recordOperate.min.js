var callRecordOperate={init:function(){if(!this._hadInit){var a=this;$(document).on("click",".listenBtn",function(f){f.stopPropagation();if(!$("#audioContainer").length){if($("#insideLineSheetRecordPager .jt-pagesize-message").length){$("#insideLineSheetRecordPager .jt-pagesize-message").append("<audio id='audioContainer' style='width:500px;' preload='metadata'  autoplay='autoplay' controls='controls'></audio>");
}if($("#csCallRecordContainer_info").length){$("#csCallRecordContainer_info").append("<audio id='audioContainer' style='position: absolute;width:500px;' autoplay='autoplay' preload='metadata'  controls='controls'></audio>");
}}var h=$(this).attr("recfileVal");var c=$(this).attr("uniqueCode");var d=$(this).attr("id-value");var g="recordId="+d+"&uniqueCode="+c+"&url="+encodeURIComponent(h);
FormUtils.submit(ctx+"/gl/cti/trkSheetRecordHi/addListenRecordHi.htm",g,null,null,true);var b=$("#audioContainer");if("y"==listenVoiceOutNet){FormUtils.submit(ctx+"/gl/cti/downloadWav/getListenVoiceUrl.htm",g,function(e){var i=e.msg;
a.audio=b[0];b.attr("src",i);},function(){var e=ctx+"/gl/cti/downloadWav/listenVoice.htm?recordId="+d+"&uniqueCode="+c+"&url="+encodeURIComponent(h);a.audio=b[0];
b.attr("src",e);},true);}else{url=h;a.audio=b[0];b.attr("src",url);}});$(document).on("click",".operateRecordHiBtn",function(f){f.stopPropagation();var c=$(this).attr("id-value");
var b=$(this).attr("uniqueCode");var d=ctx+"/gl/cti/trkSheetRecordHi/toRecordHi.htm?recordId="+c+"&uniqueCode="+b;layer.open({type:2,title:'<font style="color:red;">【'+"录音操作记录"+"】</font>",maxmin:false,shadeClose:true,area:["70%","65%"],scrollbar:false,content:d,yes:function(g,e){e.close(g);
}});});$(document).on("click",".operateRecordMarkBtn",function(f){f.stopPropagation();var c=$(this).attr("id-value");var b=$(this).attr("uniqueCode");var d=ctx+"/gl/cti/trksheetRecordMark/toRecordMark.htm?recordId="+c+"&uniqueCode="+b;
layer.open({type:2,title:'<font style="color:red;">【'+"通话记录标识"+"】</font>",maxmin:false,shadeClose:true,btn:["确定"],area:["70%","65%"],scrollbar:false,content:d,yes:function(g,e){layer.close(g);
}});});$(document).on("click",".operateRecordTrans2WordBtn",function(f){f.stopPropagation();var c=$(this).attr("id-value");var b=$(this).attr("uniqueCode");
var d=ctx+"/gl/cti/tRKSheetRecord/toRecordTranslate.htm?recordId="+c+"&uniqueCode="+b;layer.open({type:2,title:'<font style="color:red;">【'+"翻译"+"】</font>",maxmin:false,shadeClose:true,area:["900px","500px"],scrollbar:false,content:d,});
});$(document).on("click",".operateRecordShareBtn",function(f){f.stopPropagation();var c=$(this).attr("id-value");var b=$(this).attr("uniqueCode");var d=ctx+"/gl/cti/trksheetrecordRecomm/toRecordRecomm.htm?recordId="+c+"&uniqueCode="+b;
layer.open({type:2,title:'<font style="color:red;">【'+"录音推荐"+"】</font>",maxmin:false,shadeClose:true,btn:["确定"],area:["50%","400px"],scrollbar:false,content:d,yes:function(i,g){var e=layer.getChildFrame("body",i);
var h=$('[name="groupIds"]',e).val();var j=$("[name='AgentId']",e).val();var k=$("[name=recommReason]",e).val();if(!h&&!j){DialogUtils.error(msgCode.ERROR,"请选择要推荐部门或员工!");
return;}var l={recordId:c,groupIds:h,employeeIds:j,recommReason:k,};if(true){FormUtils.submit(ctx+"/gl/cti/trksheetrecordRecomm/shareRecord.htm",l,function(m){if(m.success){DialogUtils.success(msgCode.SUCCESS,"推荐成功!");
layer.close(i);}else{DialogUtils.error(msgCode.ERROR,m.msg);}},false);}}});});$("body").on("keyup",function(c){if(a.audio){if(c.keyCode==39){var b=a.audio.currentTime+5;
if(b>a.audio.duraction){a.audio.pause();}else{a.audio.currentTime=b;}}else{if(c.keyCode==37){var b=a.audio.currentTime-5;if(b<0){b=0;}a.audio.currentTime=a.audio.currentTime-5;
}else{if(c.keyCode==32){if(a.audio.paused){a.audio.play();}else{a.audio.pause();}}}}}});$(document).on("click",".downloadBtn",function(g){g.stopPropagation();
var f=$(this).attr("recfileVal");var d=$(this).attr("id-value");var c=$(this).attr("uniqueCode");var h="recordId="+d+"&uniqueCode="+c+"&url="+encodeURIComponent(f);
FormUtils.submit(ctx+"/gl/cti/trkSheetRecordHi/addDownloadRecordHi.htm",h,null,null,true);var b=ctx+"/gl/cti/downloadWav/download.htm?recordId="+d+"&uniqueCode="+c+"&url="+encodeURIComponent(f);
window.location.href=b;});$(document).on("click",".deleteBtn",function(b){var c=$(this).attr("id-value");a._deleteRecord(c);});$(document).on("click",".recordBtn",function(b){b.stopPropagation();
});$(document).on("click",".evaluateBtn",function(b){b.stopPropagation();$("#evaluateModalContainer").modal("show");});}},_deleteRecord:function(c){var b=this;
var a=ctx+"/gl/cti/tRKSheetRecord/deleteRecord.htm";DialogUtils.confirm(function(){FormUtils.del(a,c,function(d){if(d.success){DialogUtils.success(msgCode.INFO,"删除录音成功");
$(".insideLineSheetRecordSearch").trigger("click");}else{DialogUtils.error(msgCode.ERROR,d.msg);}});});}};