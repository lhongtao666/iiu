function TrkSheetRecordTranslateDialog(){this.hadInit=false;}TrkSheetRecordTranslateDialog._CONS_={};TrkSheetRecordTranslateDialog.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;
this._bindEventHander(a);this._initAudio(a);}},_bindEventHander:function(b){var a=this;$(document).on("click",".putText2Area",function(){var c=$("#translateText").text();
if(c&&c.trim()!="无"){$("[name=audioResult]").val(c);}});$(document).on("change","[name=platform]",function(){var c=$(this).val();var d=a.platforms[c];if(d){if(d.success&&d.success=="y"){$("#lastTranslateResult").show().css("color","blue").text("结果:成功; ");
$("#translateText").text(d.result);}else{$("#lastTranslateResult").show().css("color","red").text("结果:失败; ");$("#translateText").text(d.result);}}else{$("#lastTranslateResult").hide();
$("#translateText").text("无");}});$(document).on("click","#translateBtn",function(d){d.stopPropagation();console.log("点击翻译");var c=$("[name=platform]").val();
var f={recordId:b.recordId,uniqueCode:b.uniqueCode,listenUrl:b.listenUrl,platform:c,};FormUtils.submit(ctx+"/gl/cti/tRKSheetRecord/recordTranslate2Word.htm",f,function(e){if(e.success){DialogUtils.success(msgCode.INFO,e.msg);
if(e.msg!="已提交到后台任务"){a._reloadPlatformResult(b);$("#lastTranslateResult").show().css("color","blue").text("结果:成功");$("#translateText").text(e.msg);}}else{DialogUtils.error(msgCode.FAIL_MSG,e.msg);
}},null,true);return false;});$(document).on("click","#saveAudioResult",function(d){console.log("点击保存");ButtonUtils.disableBtn("saveAudioResult");var c=$("[name=audioResult]").val();
if(!c){DialogUtils.error(msgCode.FAIL_MSG,"不能为空！");return;}var f={recordId:b.recordId,uniqueCode:b.uniqueCode,wordResult:c,};FormUtils.submit(ctx+"/gl/cti/tRKSheetRecord/saveWordResult.htm",f,function(e){ButtonUtils.enableBtn("translateBtn");
if(e.success){DialogUtils.success(msgCode.INFO,e.msg);}else{DialogUtils.error(msgCode.FAIL_MSG,e.msg);}},null,true);});},_initAudio:function(f){var a=this;
var c=f.recordId;var e=f.listenUrl;var b=f.uniqueCode;var d=f.recordWordResult;if("y"==listenVoiceOutNet){FormUtils.submit(ctx+"/gl/cti/downloadWav/getListenVoiceUrl.htm",f,function(g){var h=g.msg;
$("#audioContainer").attr("src",h);},function(){var g=ctx+"/gl/cti/downloadWav/listenVoice.htm?recordId="+c+"&uniqueCode="+b+"&url="+encodeURIComponent(e);
$("#audioContainer").attr("src",g);},true);}else{url=e;$("#audioContainer").attr("src",url);}a._reloadPlatformResult(f);},_reloadPlatformResult:function(b){var a=this;
a.platforms=[];FormUtils.loadData(ctx+"/gl/translate/translate/listData.htm?Q__S__EQ__unique_mark_="+b.recordId,function(c){if(c){var f=c.rows;if(f&&f.length){for(var d=0;
d<f.length;d++){var e=f[d];a.platforms[e.platform]=e;}$("[name=platform]").trigger("change");}}},null,true);},callback:function(a){var b=$(document).find("#currentUniqueMark");
var c=b.size();if(c&&b.val()==a.uniqueMark){$(document).find("#lastTranslateResult").show().css("color","blue").text("结果:成功");$(document).find("#translateText").text(a.result);
}else{DialogUtils.success(msg.ERROR,"您提交的翻译任务成功:"+a.result);}},};