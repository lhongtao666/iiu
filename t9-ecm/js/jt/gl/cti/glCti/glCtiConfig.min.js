$(function(){var a=new GlCtiConfig();a.init();});function GlCtiConfig(){this.hadInit=false;}GlCtiConfig._CONS_={SAVE_URL:ctx+"/gl/cti/glCti/save.htm",SAVE_IMPORT_URL:ctx+"/gl/cti/glCti/saveImport.htm",APPLY_CONFIG_IMPORT_URL:ctx+"/gl/cti/glCti/applyConfig.htm",IMPORT_URL:ctx+"/gl/mc/moduleColumn/importExcel.htm",HALF_ASYN_EXPORT_DATA_URL:ctx+"/gl/cti/tRKSheetRecord/halfAsynExportRecord.htm",GRID:"#GlCtiConfigGrid",PAGER:"#GlCtiConfigPager"};
GlCtiConfig.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;this._bindEventHander();}},_bindEventHander:function(){var a=this;$("body").on("click","#editBtn",function(){$(this).addClass("hidden");
$("#saveBtn").removeClass("hidden");$("#cancelBtn").removeClass("hidden");$('textarea[name="config"]').removeAttr("readonly");});$("body").on("click","#saveBtn",function(){$(this).addClass("hidden");
$("#cancelBtn").addClass("hidden");$("#editBtn").removeClass("hidden");var b=$('textarea[name="config"]').val();FormUtils.submit(GlCtiConfig._CONS_.SAVE_URL,{config:b},function(c){if(c.success){DialogUtils.success(msgCode.SUCCESS,"更新成功");
$("#cancelBtn").trigger("click");}else{$("textarea[name='config']").val(b);$("#editBtn").trigger("click");DialogUtils.error(msgCode.ERROR,c.msg);}});$('textarea[name="config"]').attr("readonly","readonly");
});$("body").on("click","#cancelBtn",function(){$(this).addClass("hidden");$("#saveBtn").addClass("hidden");$("#editBtn").removeClass("hidden");$('textarea[name="config"]').attr("readonly","readonly");
});$("body").on("click","#editBtnImport",function(){$(this).addClass("hidden");$("#applyConfig").addClass("hidden");$("#importOrderExcel").addClass("hidden");
$("#saveBtnImport").removeClass("hidden");$("#cancelBtnImport").removeClass("hidden");$('textarea[name="importConfig"]').removeAttr("readonly");});$("body").on("click","#saveBtnImport",function(){$(this).addClass("hidden");
$("#cancelBtnImport").addClass("hidden");$("#applyConfig").removeClass("hidden");$("#importOrderExcel").removeClass("hidden");$("#editBtnImport").removeClass("hidden");
var b=$('textarea[name="importConfig"]').val();FormUtils.submit(GlCtiConfig._CONS_.SAVE_IMPORT_URL,{config:b},function(c){if(c.success){DialogUtils.success(msgCode.SUCCESS,"更新成功");
$("#cancelBtnImport").trigger("click");}else{$("textarea[name='importConfig']").val(b);$("#editBtnImport").trigger("click");DialogUtils.error(msgCode.ERROR,c.msg);
}});$('textarea[name="importConfig"]').attr("readonly","readonly");});$("body").on("click","#applyConfig",function(){var b=$('textarea[name="importConfig"]').val();
if(!b.trim()){DialogUtils.error(msgCode.ERROR,"导入配置为空不能应用");return;}FormUtils.submit(GlCtiConfig._CONS_.APPLY_CONFIG_IMPORT_URL,null,function(c){if(c.success){window.location.reload();
}});});$("body").on("click","#cancelBtnImport",function(){$(this).addClass("hidden");$("#saveBtnImport").addClass("hidden");$("#applyConfig").removeClass("hidden");
$("#editBtnImport").removeClass("hidden");$('textarea[name="importConfig"]').attr("readonly","readonly");});$("body").on("click","#importOrderExcel",function(){var b={"importUrl":ctx+"/gl/cti/glCti/importExcel.htm","tabTitle":"导入cti配置excel数据"};
JTTabUtils.addOrRefreshTab(GlCtiConfig._CONS_.IMPORT_URL+"?importUrl="+b.importUrl+"&importType=ctiConfigImport",b.tabTitle);});}};