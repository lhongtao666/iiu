$(function(){var a=new AdnManage();a.init();});function AdnManage(){this.hadInit=false;this.intervalMethod=null;this.intervalId=null;this.isHasMonitor=false;
}AdnManage._CONS_={LIST_DATA_URL:ctx+"/gl/cti/adnManage/listData.htm",UPDATE_ADN_STATUS_URL:ctx+"/crm/ou/employee/updateAdnStatusById.htm",};AdnManage.prototype={init:function(a){if(!this.hadInit){this.hadInit=true;
this._bindEventHander();this._initListData();if(!ResUtils.canShow("adnManage.button.forcebusy")){$(".forcebusy").hide();}if(!ResUtils.canShow("adnManage.button.forceidle")){$(".forceidle").hide();
}}},_bindEventHander:function(){var a=this;$(document).on("click",".refreshList",function(){a._initListData();});$(document).on("click",".forcebusy",function(){if($("input[name=adnCheckbox]:checked").length<1){DialogUtils.error(msgCode.FAIL_MSG,"请勾选需要示忙分机！");
return;}$("input[name=adnCheckbox]:checked").each(function(){window.top.jtCtiService.forcebusy($(this).val());FormUtils.submit(AdnManage._CONS_.UPDATE_ADN_STATUS_URL+"?status=3&aid="+$(this).val(),null,function(b){});
});window.location.reload();});$(document).on("click",".forceidle",function(){if($("input[name=adnCheckbox]:checked").length<1){DialogUtils.error(msgCode.FAIL_MSG,"请勾选需要示闲分机！");
return;}$("input[name=adnCheckbox]:checked").each(function(){window.top.jtCtiService.forceidle($(this).val());FormUtils.submit(AdnManage._CONS_.UPDATE_ADN_STATUS_URL+"?status=0&aid="+$(this).val(),null,function(b){});
});window.location.reload();});$(document).on("change","#checkAll",function(){if($("#checkAll").is(":checked")){$("input[name=adnCheckbox]").prop("checked",true);
}else{$("input[name=adnCheckbox]").prop("checked",false);}});},_initListData:function(a){FormUtils.submit(AdnManage._CONS_.LIST_DATA_URL,a,function(c){var b="";
if(c&&c.groupMap){console.log(c);$.each(c.groupMap,function(f,e){b+='<div class="panel">'+'<div class="panel-heading">'+'<h4 class="panel-title">'+'<a data-toggle="collapse" data-parent="#" href="#'+e.id+'" aria-expanded="true">'+e.name+"</a>"+"</h4>"+"</div>"+'<div id="'+e.id+'" class="panel-collapse collapse in">'+'<div class="panel-body">';
for(var d=0;d<c.empMap[f].length;d++){b+='<div class="cardBox col-sm-1">'+'<div class="headerBox" >'+'<div class="checkbox checkbox-success checkbox-inline ">'+'<input type="checkbox" name="adnCheckbox" value="'+c.empMap[f][d].aid+'">'+'<label for="adnCheckbox">'+c.empMap[f][d].loginedAdn+"</label>"+"</div>"+"</div>"+'<div class="bodyBox">';
if("0"==c.empMap[f][d].adnStatus){b+='<img src="'+ctx+'/img/jt/cti/idle48.png">';}else{if("1"==c.empMap[f][d].adnStatus){b+='<img src="'+ctx+'/img/jt/cti/calling48.png">';
}else{if("3"==c.empMap[f][d].adnStatus){b+='<img src="'+ctx+'/img/jt/cti/busy48.png">';}else{if("5"==c.empMap[f][d].adnStatus){b+='<img src="'+ctx+'/img/jt/cti/newdeal48.png">';
}else{b+='<img src="'+ctx+'/img/jt/cti/nologin48.png">';}}}}b+="</div>"+'<div class="bottomBox">'+"<span>"+c.empMap[f][d].aid+":"+c.empMap[f][d].name+"</span>"+"</div>"+"</div>";
}b+="</div>"+"</div>"+"</div>";});$("#bs-collapse").empty().append(b);}});}};