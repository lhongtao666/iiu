<!DOCTYPE html>
<html>
<head>
	<title>销售订单详情</title>
	<#include "/common/common.html">
	<#include "/ec/salesorder/soEntity/soEntityCommJs.html">
	<script type="text/javascript">
		var csId = "";
		var canShowScTrankNo ="cannot";
		<#if csId??>
			csId = "${csId}";
		</#if>
		<#if canShowScTrankNo??>
			canShowScTrankNo = "${canShowScTrankNo}";
		</#if>
		var soStatus = "${soInfoVo.status}";
		var isSelectStoreInShip = "n";
	    <#if isSelectStoreInShip??>
	        isSelectStoreInShip = "${isSelectStoreInShip}";
        </#if>
         var currentIsSendSmsStr ="n"
        <#if currentIsSendSmsStr??>
	        currentIsSendSmsStr = "${currentIsSendSmsStr}";
        </#if>
        var soEntityShipModel = "${soEntityShipModel}";
	</script>
	<#include "/ec/salesorder/soEntity/soEntityRenderTmpl.html">
<script src='${ctx}/js/jt/ec/salesorder/stock/soEntityDeliverEdit-site${deploy_min!""}.js?v=${jsVersion}' ></script>
</head>
<body>
	<div class="wrapper animated ">
		<div class="row form_wrapper">
			<div class='col-sm-12'>
				<div class="panel panel-default">
					<div class="panel-heading " style="position: fixed;z-index: 99999;width: 100%;top: 0px;">
						<button type='button'  class="jt-btn jt-dd-normal savePackBtn remove-deliver-btn"><i class='fa fa-floppy-o'></i>&nbsp;保存</button>
						<button type='button'  class='jt-btn jt-dd-normal scHotPrintBtn remove-deliver-btn'><i class='fa fa-clipboard'></i>&nbsp;打印热敏纸</button>
						<button type='button'  class='jt-btn jt-dd-normal printShipBtn remove-deliver-btn'><i class='fa fa-clipboard'></i>&nbsp;打印快递单</button>
			            <button type='button'  class='jt-btn jt-dd-normal printDeliverBtn remove-deliver-btn'><i class='fa fa-clipboard'></i>&nbsp;打印发货单</button>
			            <button type='button'  class="jt-btn jt-dd-normal deliverBtn remove-deliver-btn"><i class='fa fa-truck'></i>&nbsp;发货</button>
			            <button type="button" class="jt-btn jt-dd-normal remove-deliver-btn addFollow" id="addFollowBtn"> <i class='fa fa-plus'></i>&nbsp;添加跟进</button>
						<button type='button'  class='jt-btn jt-dd-normal preSoBtn' style="display: none;"><i class='fa fa-hand-o-left'></i>&nbsp;上一张</button>
						<button type='button'  class='jt-btn jt-dd-normal nextSoBtn'style="display: none;"><i class='fa fa-hand-o-right'></i>&nbsp;下一张</button>
						丨						
						<button type='button' class='jt-btn jt-btn-red remove-deliver-btn soEntityTrunDown'>驳回</button>
			            <button type='button'  class="jt-btn jt-btn-red deliverBackBtn " disabled="disabled">撤销发货</button>
			            <button type="button" class="jt-btn jt-dd-normal soEntityWrap" style="display:none;">包装</button>
			            <button type='button' class='jt-btn jt-dd-normal splitOrderBtn'>订单拆分</button>
			            <button type="button" class="jt-btn jt-dd-normal soAddLock">订单冻结</button>
			            <button type="button" class="jt-btn jt-dd-normal soUnLock">订单解冻</button>
						<button type="button" class="jt-btn jt-btn-red prevBtn"><i class='fa fa-times'></i>&nbsp;返回列表</button>
						<#include "/ec/salesorder/common/soEntityBaseTypeFlag.html" />
					</div>
					<div class="panel-body" id="waitDeliverBody" style="margin-top: 44px;">
			            <form id="soEntityPackForm" method="get" class="form-horizontal">	
						   <div class='form-group'>
						       <div class='col-sm-4'>
								<label class="col-sm-5 control-label">快递公司</label>
								<div class="col-sm-7">
									<select name="scCodeShow" class="form-control" validateType="default">
										<#if shipCompanyPos?? && shipCompanyPos?size gt 0>
										<#list shipCompanyPos as shipCompany>
										<option value="${shipCompany.id}" hotvar="${shipCompany.isHot}" <#if soInfoVo.soShipPo.scCode == shipCompany.id>selected</#if>>${shipCompany.name}</option>
										</#list>
										</#if>
									</select>
									<input type="hidden" name="scName">
									<input type="hidden" name="scCode">
								</div>
						       </div>
						       <div class='col-sm-4'>
								  <div class="col-sm-5 control-label">快递单号</div>
								  <div class="col-sm-7">
										<input type="text"  name="scTrackingNo"  id="scTrackingNo"   class="form-control" validateType="default"  required="required"  value="${soInfoVo.soShipPo.scTrackingNo}">
								  </div>
							   </div>
							   <div class='col-sm-4 hotPrintDiv' style="display:none;">
								  	<div class="col-sm-8">
										<div class="checkbox checkbox-success checkbox-inline">
											<input type="checkbox" value="y" name="isHotPrint"> <label>热敏纸打印 </label>
										</div>
									</div>
							   </div>
						   </div>
						   <div class='form-group'>
						       <div class='col-sm-4'>
								  <div class="col-sm-5 control-label">重量(g)</div>
								  <div class="col-sm-7">
										<input type="text" name="weight" class="form-control" value="${soInfoVo.soShipPo.weight}" validateType="default">
								  </div>
							   </div>
							   <div class='col-sm-4'>
								  <div class="col-sm-5 control-label">快递运费(元)</div>
								  <div class="col-sm-7">
										<input type="text" name="actualAmount" class="form-control" validateType="default" value="${soInfoVo.soShipPo.actualAmount}">
								  </div>
							   </div>
						   </div>
						   <div class='form-group'>
						   	 <div class='col-sm-4 sendSmsWhenDeliver'>
								  <div class="col-sm-6 control-label">发货同时发短信</div>
								  <div class="col-sm-6" style="padding-top:4px;">
										<input type="checkbox" value="y" class="sendSms" name="sendSms" <#if soInfoVo.soShipPo.sendSms == 'y'> checked</#if> >是
								  </div>
							  </div>
							  <div class="col-sm-2 sendSmsWhenDeliver" style="padding-top:4px;">
									<a  class="setSmsTpl">设置短信模板</a>
							  </div>
						   </div>
						   <input type="hidden"  name="id" id="id" value="${soInfoVo.soShipPo.id}">
						   <input type="hidden"  name="soId" value="${soInfoVo.id}">
						   <input type="hidden"  name="csName" value="${soInfoVo.csName}">
						   <input type="hidden"  name="soNo" value="${soInfoVo.soNo}" >
						   <input type="hidden"  name="isPrintHot" >
						   <input type="hidden"  name="smsTpl" <#if soInfoVo.soShipPo.smsTpl == '' || soInfoVo.soShipPo.smsTpl == null> value="尊敬的客户，您购买的产品已发出。快递公司：{sms.scName}，单号：{sms.scTrackingNo}，收货务必核对，谨防受骗！" <#else> value="${soInfoVo.soShipPo.smsTpl} </#if>">
						</form>
						<#include "/ec/salesorder/soEntity/soEntityForm.html">
					</div>
				</div>	
			</div>
		</div>  
	</div>
	<div style="display: none;" class="setSmsTplPane">
		<div class="panel-body">
			<form id="setSmsTplForm" method="get" class="form-horizontal">
				<div class='form-group'>
					<label class='col-sm-2 control-label'>提示<span style='color: red;'>*</span></label>
					<div class='col-sm-9' style="padding-top:4px;color: red;">
						<span >按模板填写,如无必要,无需修改。</span>
					</div>
				</div>
				<div class='form-group'>
					<label class='col-sm-2 control-label'>模板内容<span style='color: red;'>*</span></label>
					<div class='col-sm-9'>
						<textarea rows='6' id='setSmsTpl' placeholder='请输入关模板内容'  class='form-control'   validateType='default' ></textarea>
					</div>
				</div>
			</form>
		</div>
	</div>
	<#include "/crm/cs/csEntity/csFollowEdit.html" >
	<div style="display:none"  class="soEntityTurnDownPane" >
	   	<#include "/ec/salesorder/soEntity/soEntityTurnDown.html" >
	</div>
	<#include "/crm/cs/csEntity/sendMessagePane.html" >
	<#include "/ec/salesorder/soEntity/soEntityWrapSo.html" >
	<#include "/ec/salesorder/soEntity/soEntitySplitSo.html" >
	<div class="modal fade" id="selectStoreModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	    <div class="modal-dialog" role="document">
	    	<div class="modal-content">
	      		<div class="modal-header">
	        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
	        		<h4 class="modal-title" id="myModalLabel">选择仓库</h4>
	      		</div>
		
		        <div class="modal-body">
			        <form id="selectStoreForm" method="get" class="form-horizontal">
			        	<div class='form-group'>
							<label class="col-sm-1 control-label">仓库</label>
							<div class="col-sm-4">
								<select class="form-control" name="storeId" id="storeId" validatetype="default">
								</select>
							</div>
						</div>
			        </form>
		        </div>
		        <div class="modal-footer">
		        	<button type="button" class="btn btn-sm   btn-default" data-dismiss="modal">关闭</button>
		        	<button type="button" class="btn btn-sm   btn-primary" id='selectStoreBtn'>保存</button>
		        </div>
	        </div>
        </div>
    </div>
</body>
</html>
