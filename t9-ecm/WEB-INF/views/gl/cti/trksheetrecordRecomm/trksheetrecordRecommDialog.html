<!DOCTYPE html>
<html>

<head>
    <title>录音推荐</title>
    <#include "/common/common.html" />
    <#include "/common/ztree.html" />
    <link href="${ctx}/css/plugins/select2/select2.min.css?v=${jsVersion}" rel="stylesheet">
    <script src="${ctx}/js/plugins/select2/select2.min.js?v=${jsVersion}"></script>
    <script src="${ctx}/js/plugins/suggest/bootstrap-suggest.js?v=${jsVersion}"></script>
    <script src="${ctx}/js/jt/common/utils/groupUtils${deploy_min!''}.js?v=${jsVersion}"></script>
    <script type="text/javascript">
    function TrksheetrecordRecommDialog() {
        this.hadInit = false;
    }
    TrksheetrecordRecommDialog.prototype = {
        init: function(params) {
            if (!this.hadInit) {
                this.hadInit = true;
                this._bindEventHander();
                this._initEmployeeSelect('');
            }
        },
        _initEmployeeSelect: function(groupIds) {
            FormUtils.loadData(ctx + "/crm/ou/employee/listEmployees.htm?groupId=" + groupIds + '&type=dept_manager', function(employeePos) {
                $('#agentId').empty();
                var sb = new StringBuffer();
                if (employeePos && employeePos.length) {
                    for (var i = 0; i < employeePos.length; i++) {
                        sb.append("<option value='" + employeePos[i].id + "'>" + employeePos[i].aid + ":" + employeePos[i].name + "</option>");
                    }
                }
                $('#agentId').append(sb.toString()).select2();
            }, null, true);
        },
        _bindEventHander: function() {
            var self = this;
            $(document).on("click", "#orgName", function() {
                GroupUtils.selectGroupTreeBox({
                    selectedGroupId: $('#orgId').val(),
                    container: "orgName",
                    fn: function(groupIds) {
                        self._initEmployeeSelect(groupIds);
                        $('#orgId').val(groupIds);
                    }
                });
            });
            $(document).on("click", "#groupNames", function() {
                var options = {
                    isMultiple: 1,
                    selectedGroupId: $("#groupIds").val(),
                    container: "groupNames",
                    fn: function(groupIds) {
                        $("[name=groupIds]").val(groupIds);
                    }
                };
                GroupUtils.selectGroupTreeBox(options);
            });
        },
    }
    $(function() {
        var trksheetrecordRecommDialog = new TrksheetrecordRecommDialog();
        trksheetrecordRecommDialog.init();
    });
    </script>
</head>

<body>
    <div class="panel-body" style="padding:5px;">
        <form id='trksheetrecordRecommForm' class='form-horizontal'>
            <div class="form-group">
                <label class="col-sm-1 control-label">特定部门</label>
                <div class="col-sm-10">
                    <input id='groupNames' class='form-control' placeholder="请选择" readonly="readonly">
                    <input id='groupIds' type="hidden" name="groupIds" class='form-control' placeholder="请选择" readonly="readonly">
                </div>
            </div>
            <div class="form-group">
                <div class='col-sm-3'>
                    <label class='control-label col-sm-4'>特定员工</label>
                    <div class='col-sm-8'>
                        <input id='orgName' class='form-control' placeholder="请选择" readonly="readonly">
                        <input id='orgId' name='orgId' type='hidden'>
                    </div>
                </div>
                <div class="col-sm-8">
                    <div class='col-sm-12'>
                        <select name='AgentId' id='agentId' multiple="multiple" class='form-control'></select>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class='control-label col-sm-1'>推荐理由</label>
                <div class="col-sm-10">
                    <input type="hidden" name="recordId" />
                    <textarea name="recommReason" placeholder="" class="form-control" validateType="default" rows="5"></textarea>
                </div>
            </div>
        </form>
    </div>
</body>

</html>